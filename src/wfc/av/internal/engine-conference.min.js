import*as e from"../../../config.js";import*as s from"../../../platform.js";import*as t from"../../messages/messageContentType";import*as o from"../../model/conversation";import*as r from"../../model/conversationType";import*as i from"../../model/nullUserInfo";import*as n from"../../util/longUtil.js";import*as a from"../engine/avenginekit";import*as l from"../engine/avenginekitproxy";import*as d from"../engine/callEndReason";import*as c from"../engine/callSession";import*as u from"../engine/callState";import*as m from"../engine/participantProfile";import*as h from"../engine/rcEndReason";import*as f from"../engine/rcState";import*as _ from"../engine/subscriber";import*as p from"../engine/videoProfile";import*as S from"../engine/videoType";import*as b from"../messages/addParticipantsMessageContent";import*as g from"../messages/callAnswerMessageContent";import*as j from"../messages/callByeMessageContent";import*as v from"../messages/callModifyMessageContent";import*as y from"../messages/callStartMessageContent";import*as C from"../messages/conferenceChangeModeContent";import*as T from"../messages/muteVideoMessageContent";import*as I from"../messages/rcAcceptInviteMessageContent";import*as E from"../messages/rcEndMessageContent";import*as M from"../messages/rcInviteMessageContent";import*as O from"../messages/rcRequestMessageContent";var R={"./av/internal/avenginekitImpl.js":(e,s,t)=>{t.r(s),t.d(s,{WfcAVEngineKitImpl:()=>C,default:()=>I});var o=t("./node_modules/babel-runtime/core-js/json/stringify.js"),r=t.n(o),i=t("./node_modules/babel-runtime/helpers/extends.js"),n=t("./node_modules/babel-runtime/core-js/map.js"),a=t.n(n),l=t("../../messages/messageContentType"),d=t("../messages/callByeMessageContent"),c=t("../messages/callAnswerMessageContent"),u=t("../messages/callStartMessageContent"),m=t("../messages/callModifyMessageContent"),h=t("../../model/conversationType"),f=t("../engine/callEndReason"),_=t("../engine/avenginekitproxy"),p=t("../engine/callState"),S=t("./av/internal/callSessionImpl.js"),b=t("../messages/addParticipantsMessageContent"),g=t("../engine/avenginekit"),j=t("../../../config.js"),v=t("../messages/rcRequestMessageContent"),y=t("../engine/rcState");class C extends g.default{constructor(){super(),this.sendMessageId=0,this.sendConferenceRequestId=0,this._fixLongSerializedIssue=e=>("string"!=typeof e||"string"==typeof(e=JSON.parse(e))&&(e=JSON.parse(e)),e),this.onSendMessageResult=(e,s)=>{s=this._fixLongSerializedIssue(s);let t=this.sendMessageCallbackMap.get(s.sendMessageId);t&&t(s.error,s.messageUid,s.timestamp),this.sendMessageCallbackMap.delete(s.sendMessageId)},this.onSendConferenceRequestResult=(e,s)=>{console.log("av-c","sendConferenceRequestResult",e,s),s=this._fixLongSerializedIssue(s);let t=this.sendConferenceRequestCallbackMap.get(s.sendConferenceRequestId);t&&(t(s.error,s.response),this.sendConferenceRequestCallbackMap.delete(s.sendConferenceRequestId))},this.onConferenceEvent=(e,s)=>{s=this._fixLongSerializedIssue(s),this.currentSession&&this.currentSession.onConferenceEvent(s)},this.onReceiveMessage=(e,s)=>{if(s=this._fixLongSerializedIssue(s),console.log("av-c","receive voip message ",s),!(s.conversation.type!==h.default.Single&&s.conversation.type!==h.default.Group||1!==s.direction&&s.messageContent.type!==l.default.VOIP_CONTENT_TYPE_ACCEPT&&s.messageContent.type!==l.default.VOIP_CONTENT_TYPE_END)){let e=s.messageContent;if(s.messageContent.type===l.default.VOIP_REMOTE_CONTROL_INPUT_EVENT){if(!T.currentSession||T.currentSession.status===p.default.STATUS_IDLE)return;if(T.currentSession.conversation.type!=s.conversation.type||T.currentSession.conversation.targetId!=s.conversation.targetId)return;let e=s.messageContent;!T.currentSession||T.currentSession.status!==p.default.STATUS_CONNECTING&&T.currentSession.status!==p.default.STATUS_CONNECTED&&T.currentSession.status!==p.default.STATUS_OUTGOING||T.onReceiveRCData(e.data)}else if(s.messageContent.type===l.default.VOIP_CONTENT_TYPE_SIGNAL){if(!T.currentSession||T.currentSession.status===p.default.STATUS_IDLE)return;let t=s.messageContent;t.callId!==T.currentSession.callId?T.rejectOtherCall(s.conversation,e.callId,null,s.messageUid):!T.currentSession||T.currentSession.status!==p.default.STATUS_CONNECTING&&T.currentSession.status!==p.default.STATUS_CONNECTED&&T.currentSession.status!==p.default.STATUS_OUTGOING||T.onReceiveData(s.from,t.payload)}else if(s.messageContent.type===l.default.VOIP_CONTENT_TYPE_START||s.messageContent.type===l.default.VOIP_REMOTE_CONTROL_REQUEST){console.log("av-c","callstart",s);let t=s.messageContent.targetIds;if(t.findIndex(e=>e===s.selfUserInfo.uid)<0)return;t=t.filter(e=>e!==s.selfUserInfo.uid),t.push(s.from),T.currentSession&&T.currentSession.status!==p.default.STATUS_IDLE?T.rejectOtherCall(s.conversation,e.callId,t,s.messageUid):(T.currentSession=S.default.newSession(s.conversation,s.from,e.callId,e.audioOnly,T.sessionCallback),T.currentSession.startMsgUid=s.messageUid,T.currentSession.pin=e.pin,T.currentSession.joinTime=s.timestamp,T.currentSession.callExtra=e.extra,s.messageContent.type===l.default.VOIP_REMOTE_CONTROL_REQUEST&&(T.currentSession.rcStatus=y.default.STATUS_INCOMING_REQUEST,T.currentSession.videoMuted=!0),T.currentSession.initSession(!1,s.selfUserInfo,s.participantUserInfos,s.groupMemberUserInfos),T.currentSession.setUserJoinTime(s.from,s.timestamp),s.participantUserInfos.forEach(e=>{T.currentSession.setUserJoinTime(e.uid,s.timestamp)}),T.currentSession.setUserAcceptTime(s.from,s.timestamp),T.currentSession.setState(p.default.STATUS_INCOMING))}else if(s.messageContent.type===l.default.VOIP_CONTENT_TYPE_ACCEPT||s.messageContent.type===l.default.VOIP_CONTENT_TYPE_ACCEPT_T){if(T.currentSession&&T.currentSession.status!==p.default.STATUS_IDLE){if(e.callId!==T.currentSession.callId)return void(1===s.direction&&T.rejectOtherCall(s.conversation,e.callId,[s.selfUserInfo.uid]));if(0===s.direction&&T.currentSession.status===p.default.STATUS_INCOMING)return void T.currentSession.endCall(f.default.REASON_AcceptByOtherClient);T.currentSession.status===p.default.STATUS_OUTGOING&&T.currentSession.setState(p.default.STATUS_CONNECTING),!T.currentSession.audioOnly&&e.audioOnly&&T.currentSession.setAudioOnly(!0),T.currentSession.setUserAcceptTime(s.from,s.timestamp);let t=T.queueOfferMessageMap.get(s.from);t&&t.forEach(e=>{T.processSignalingMessage(s.from,e)}),T.queueOfferMessageMap.delete(s.from)}}else if(s.messageContent.type===l.default.VOIP_CONTENT_TYPE_END)if(T.currentSession&&T.currentSession.status!==p.default.STATUS_IDLE&&T.currentSession.callId===e.callId){let t=e.reason;if(1===s.direction){switch(e.reason){case f.default.REASON_Unknown:t=f.default.REASON_Unknown;break;case f.default.REASON_Busy:t=f.default.RemoteBusy;break;case f.default.REASON_SignalError:t=f.default.RemoteNetworkError;break;case f.default.REASON_Hangup:t=f.default.REASON_RemoteHangup;break;case f.default.REASON_MediaError:t=f.default.RemoteNetworkError;break;case f.default.REASON_RemoteHangup:t=f.default.REASON_Hangup;break;case f.default.REASON_OpenCameraFailure:t=f.default.RemoteNetworkError;break;case f.default.REASON_Timeout:t=f.default.RemoteTimeout;break;case f.default.REASON_AcceptByOtherClient:t=f.default.REASON_AcceptByOtherClient;break;case f.default.REASON_AllLeft:t=f.default.REASON_AllLeft;break;case f.default.RemoteBusy:t=f.default.REASON_Busy;break;case f.default.RemoteTimeout:t=f.default.REASON_Timeout;break;case f.default.RemoteNetworkError:t=f.default.REASON_SignalError;break;case f.default.RoomDestroyed:t=f.default.RoomDestroyed;break;case f.default.RoomNotExist:t=f.default.RoomNotExist;break;case f.default.RoomParticipantsFull:t=f.default.RoomParticipantsFull;break;case f.default.Interrupted:t=f.default.RemoteInterrupted;break;default:t=f.default.RemoteNetworkError}T.currentSession.endUserCall(s.from,t)}}else console.log("av-c","invalid bye message, ignore it",T.currentSession,e);else if(s.messageContent.type===l.default.VOIP_CONTENT_TYPE_MODIFY)T.currentSession&&T.currentSession.status===p.default.STATUS_CONNECTED&&T.currentSession.callId===e.callId&&(e.audioOnly?(T.currentSession.audioOnly=!0,T.currentSession.downgrade2Voice(!0)):console.log("av-c","cannot modify voice call to video call"));else if(s.messageContent.type===l.default.VOIP_Join_Call_Request)T.currentSession&&T.currentSession.status===p.default.STATUS_CONNECTED&&s.messageContent.callId===T.currentSession.callId&&T.currentSession.initiatorId===T.currentSession.selfUserInfo.uid&&T.currentSession.inviteNewParticipants([s.from],s.messageContent.clientId,!0);else if(s.messageContent.type===l.default.VOIP_CONTENT_TYPE_ADD_PARTICIPANT)if(e.participants.indexOf(s.selfUserInfo.uid)>-1){if(T.currentSession&&T.currentSession.status!==p.default.STATUS_IDLE){if(T.currentSession.callId===s.messageContent.callId)return;let t=[];return t.push(...s.messageContent.participants),s.messageContent.existParticipants&&t.push(...s.messageContent.existParticipants),t.push(s.from),t=t.filter(e=>e!==s.selfUserInfo.uid),void T.rejectOtherCall(s.conversation,e.callId,t)}T.currentSession=S.default.newSession(s.conversation,s.from,e.callId,e.audioOnly,T.sessionCallback),T.currentSession.pin=e.pin,T.currentSession.startMsgUid=s.messageUid;let t=s.participantUserInfos.filter(e=>e.uid!==s.selfUserInfo.uid);T.currentSession.joinTime=s.timestamp,T.currentSession.callExtra=s.messageContent.extra,T.currentSession.initSession(!1,s.selfUserInfo,t,s.groupMemberUserInfos),t.forEach(e=>{T.currentSession.setUserJoinTime(e.uid,s.timestamp)}),T.currentSession.updateExistParticipant(e.existParticipants,s.timestamp),T.currentSession.setState(p.default.STATUS_INCOMING),j.default.ENABLE_MULTI_CALL_AUTO_JOIN&&e.autoAnswer&&T.currentSession.answer(e.audioOnly)}else if(T.currentSession&&T.currentSession.status!==p.default.STATUS_IDLE&&T.currentSession.callId===e.callId){let t=s.participantUserInfos.filter(s=>e.participants.indexOf(s.uid)>-1);T.currentSession.didAddNewParticipants(e.participants,t),t.forEach(e=>{T.currentSession.setUserJoinTime(e.uid,s.timestamp)})}else{let t=[];t.push(...s.messageContent.participants),s.messageContent.existParticipants&&t.push(...s.messageContent.existParticipants),t.push(s.from),t=t.filter(e=>e!==s.selfUserInfo.uid),T.rejectOtherCall(s.conversation,e.callId,t)}else if(s.messageContent.type===l.default.VOIP_CONTENT_TYPE_MUTE_VIDEO){let e=s.messageContent;T.currentSession&&T.currentSession.callId===e.callId&&T.currentSession.status!==p.default.STATUS_IDLE&&T.currentSession.updateVideoMute(s.from,e.videoMuted)}else if(s.messageContent.type===l.default.CONFERENCE_CONTENT_TYPE_CHANGE_MODE){let e=s.messageContent;T.currentSession&&T.currentSession.callId===e.callId&&T.currentSession.onRequestChangeMode(e.audience)}else if(s.messageContent.type===l.default.CONFERENCE_CONTENT_TYPE_KICKOFF_MEMBER){let e=s.messageContent;T.currentSession&&T.currentSession.callId===e.callId&&T.currentSession.onKickoff()}else if(s.messageContent.type===l.default.VOIP_REMOTE_CONTROL_INVITE){let e=s.messageContent;T.currentSession&&T.currentSession.callId===e.callId&&T.currentSession._onReceiveRemoteControlInvite()}else if(s.messageContent.type===l.default.VOIP_REMOTE_CONTROL_ACCEPT_INVITE){let e=s.messageContent;T.currentSession&&T.currentSession.callId===e.callId&&T.currentSession._didAcceptRemoteControlInvite()}else if(s.messageContent.type===l.default.VOIP_REMOTE_CONTROL_END){let e=s.messageContent;T.currentSession&&T.currentSession.callId===e.callId&&T.currentSession._didRemoteControlEnd(e.reason)}}},this.startCall=(e,s)=>{let t,o=(s=this._fixLongSerializedIssue(s)).conversation,r=s.audioOnly;if(!this.currentSession){this.currentSession=S.default.newSession(o,s.selfUserInfo.uid,s.callId,r,T.sessionCallback),this.currentSession.pin="";for(let e=0;e<6;e++)this.currentSession.pin+=Math.floor(10*Math.random());this.currentSession.callExtra=s.callExtra,this.currentSession.initSession(!0,s.selfUserInfo,s.participantUserInfos,s.groupMemberUserInfos),this.currentSession.setState(p.default.STATUS_OUTGOING),s.remoteControl?(t=new v.default,this.currentSession.videoMuted=!0,this.currentSession.rcStatus=y.default.STATUS_OUTGOING_REQUEST):(t=new u.default,t.audioOnly=r,t.extra=s.callExtra,t.sdkType=2),t.targetIds=this.currentSession.getParticipantIds(),t.callId=s.callId,t.pin=this.currentSession.pin,this.currentSession.createRoom(e=>{0===e?this.sendSignalMessage(t,this.currentSession.getParticipantIds(),!0,!1,(e,s,o)=>{T.currentSession&&(0!==e?this.currentSession.endCall(f.default.REASON_SignalError):(this.currentSession.startMsgUid=s,console.log("av-c","startMsgUid",this.currentSession.startMsgUid,s),this.currentSession.joinTime=o,this.currentSession.setAcceptTime(o),t.targetIds.forEach(e=>{this.currentSession.setUserJoinTime(e,o)},this)))}):this.currentSession.endCall(f.default.REASON_SignalError)})}},this.startConference=(e,s)=>{let t=(s=this._fixLongSerializedIssue(s)).audioOnly;this.currentSession||(this.currentSession=S.default.newSession(null,s.selfUserInfo.uid,s.callId,t,T.sessionCallback),this.currentSession.pin=s.pin,this.currentSession.host=s.host,this.currentSession.title=s.title,this.currentSession.desc=s.desc,this.currentSession.conference=!0,this.currentSession.defaultAudience=s.audience,this.currentSession.advance=s.advance,this.currentSession.record=s.record,this.currentSession.extra=s.extra,this.currentSession.callExtra=s.callExtra,this.currentSession.videoMuted=s.muteVideo,this.currentSession.audioMuted=s.muteAudio,this.currentSession.initSession(!0,s.selfUserInfo,null,null,!0),this.currentSession.setState(p.default.STATUS_OUTGOING),this.currentSession.createRoom(e=>{0!==e&&this.currentSession.endCall(f.default.REASON_SignalError)}))},this._joinConference=(e,s)=>{this.joinConference(s)},this.joinConference=e=>{e=this._fixLongSerializedIssue(e),this.currentSession||(console.log("av-c","joinConference",e),this.currentSession=S.default.newSession(null,e.selfUserInfo.uid,e.callId,e.audioOnly,T.sessionCallback),this.currentSession.pin=e.pin,this.currentSession.host=e.host,this.currentSession.title=e.title,this.currentSession.desc=e.desc,this.currentSession.defaultAudience=e.audience,this.currentSession.audience=e.audience,this.currentSession.conference=!0,this.currentSession.advance=e.advance,this.currentSession.audioMuted=e.muteAudio,this.currentSession.videoMuted=e.muteVideo,this.currentSession.extra=e.extra,this.currentSession.callExtra=e.callExtra,this.currentSession.initSession(!1,e.selfUserInfo,null,null,!0),this.currentSession.setState(p.default.STATUS_CONNECTING))},this.onConnectionStatusChange=(e,s)=>{T.currentSession&&T.currentSession.onIMConnectionStatusChange(Number(s))}}setup(e){window&&!window._log&&localStorage.getItem("enable_voip_log_with_date")&&(window._log=console.log,console.log=(e,...s)=>{window._log((new Date).toLocaleString(),e,...s)}),this.sendMessageCallbackMap&&console.log("av-c","wfc avengine-conference, setup multi times"),console.log("av-c","wfc avengine-conference"),_.default.listenVoipEvent("message",this.onReceiveMessage),_.default.listenVoipEvent("conferenceEvent",this.onConferenceEvent),_.default.listenVoipEvent("sendMessageResult",this.onSendMessageResult),_.default.listenVoipEvent("sendConferenceRequestResult",this.onSendConferenceRequestResult),_.default.listenVoipEvent("startCall",this.startCall),_.default.listenVoipEvent("startConference",this.startConference),_.default.listenVoipEvent("joinConference",this._joinConference),_.default.listenVoipEvent("connectionStatus",this.onConnectionStatusChange),this.sendMessageCallbackMap=new(a()),this.sendConferenceRequestCallbackMap=new(a()),this.queueOfferMessageMap=new(a()),this.sessionCallback=e}getCurrentSession(){return T.currentSession}inviteNewParticipants(e,s,t,o){let r=T.currentSession;if(!r)return;let i=new b.default;i.callId=r.callId,i.initiator=r.selfUserInfo.uid,console.log("av-c","inviteNewParticipants","initiator "+r.selfUserInfo),i.audioOnly=r.audioOnly,i.pin=s,i.participants=e,i.existParticipants=r.getExistParticipantsStatus(),i.autoAnswer=o,i.clientId=t;let n=[...r.getParticipantIds()];n.push(...e),this.sendSignalMessage(i,n,!0,!1,(s,t,o)=>{if(console.log("av-c","send invite message success"),0!==s)return void console.log("av-c","send invite message error",s);let i=r.groupMemberUserInfos.filter(s=>e.findIndex(e=>e===s.uid)>-1);console.log("av-c","didAddNewParticipants av",e,i),r.didAddNewParticipants(e,i),e.forEach(e=>{r.setUserJoinTime(e,o)})})}updateCallStartMessageContent(e,s){let t={messageUid:(0,i.default)({},e),content:s};_.default.emitToMain("update-call-start-message",t)}clearInviteUnreadStatus(e){}sendSignalMessage(e,s,t,o,r){T.currentSession.conversation&&this.sendSignalMessageEx(T.currentSession.conversation,e,s,t,o,r)}sendSignalMessageEx(e,s,t,o,i,n){t&&i&&t.push(this.currentSession.selfUserInfo.uid);let a={conversation:JSON.parse(r()(e)),content:s.encode(),toUsers:t};console.log("av-c","send signal message",s),n&&(this.sendMessageId++,a.sendMessageId=this.sendMessageId,this.sendMessageCallbackMap.set(this.sendMessageId,n)),_.default.emitToMain("voip-message",a)}sendConferenceRequest(e,s,t,o,r){this.sendConferenceRequestEx(e,s,t,o,this.currentSession.advance,r)}sendConferenceRequestEx(e,s,t,o,r,i){let n={sessionId:e,roomId:s,request:t,data:o,advance:r};i&&(this.sendConferenceRequestId++,n.sendConferenceRequestId=this.sendConferenceRequestId,this.sendConferenceRequestCallbackMap.set(this.sendConferenceRequestId,i)),console.log("av-c","sendConferenceRequest",n),_.default.emitToMain("conference-request",n)}rejectOtherCall(e,s,t,o){let r=new d.default;r.callId=s,r.inviteMsgUid=o,r.reason=f.default.REASON_Busy,console.log("av-c","reject other call",r,t),this.sendSignalMessageEx(e,r,t,!1,!0)}onReceiveRCData(e){console.log("av-c","receive remote control:",e),_.default.emitToMain("rc_receive_input_event",e)}onReceiveData(e,s){let t=JSON.parse(s);if(T.currentSession.getPeerConnection(e))T.processSignalingMessage(e,t);else{console.log("av-c","queue signal",e,t);let s=this.queueOfferMessageMap.get(e);s||(s=[],this.queueOfferMessageMap.set(e,s)),"answer"===t.type||"offer"===t.type?s.unshift(t):s.push(t)}}processSignalingMessage(e,s){console.log("av-c","process remote signal:"+s)}answerCurrentCall(){let e=new c.default;e.audioOnly=T.currentSession.audioOnly,e.callId=T.currentSession.callId,e.inviteMessageUid=T.currentSession.startMsgUid,this.sendSignalMessage(e,this.currentSession.getParticipantIds(),!0,!0,(e,s,t)=>{0===e?this.currentSession.setAcceptTime(t):this.currentSession.endCall(f.default.REASON_SignalError)})}downgrade2VoiceCall(){let e=new m.default;T.currentSession.audioOnly=!0,e.audioOnly=T.currentSession.audioOnly,e.callId=T.currentSession.callId,this.sendSignalMessage(e,this.currentSession.getParticipantIds(),!0,!1)}}const T=new C,I=T},"./av/internal/callSessionImpl.js":(e,s,t)=>{t.r(s),t.d(s,{default:()=>D});var o=t("./node_modules/babel-runtime/core-js/object/keys.js"),r=t.n(o),i=t("./node_modules/babel-runtime/helpers/extends.js"),n=t("./node_modules/babel-runtime/helpers/asyncToGenerator.js"),a=t("./node_modules/babel-runtime/core-js/json/stringify.js"),l=t.n(a),d=t("./node_modules/babel-runtime/core-js/map.js"),c=t.n(d),u=t("../../../config.js"),m=t("../engine/callState"),h=t("./av/internal/avenginekitImpl.js"),f=t("../engine/callEndReason"),_=t("../messages/callByeMessageContent"),p=t("./av/internal/subscriberImpl.js"),S=t("../../../platform.js"),b=t("../engine/callSession"),g=t("../../util/longUtil.js"),j=t("../engine/avenginekit"),v=t("../../model/conversationType"),y=t("../messages/conferenceChangeModeContent"),C=t("../../model/conversation"),T=t("./av/internal/roomErrorCode.js"),I=t("./av/internal/soundMeter.js"),E=t("../engine/avenginekitproxy"),M=t("../messages/muteVideoMessageContent"),O=t("../engine/videoProfile"),R=t("./av/internal/publisherImpl.js"),A=t("./av/internal/screenSharingPublisherImpl.js"),k=t("../../model/nullUserInfo"),V=t("../engine/participantProfile"),N=t("../messages/rcInviteMessageContent"),P=t("../messages/rcAcceptInviteMessageContent"),x=t("../messages/rcEndMessageContent"),w=t("../engine/rcEndReason"),U=t("../engine/rcState");class D extends b.default{constructor(...e){var s;return s=super(...e),this.audience=!1,this.lastActiveTime=0,this.joinTime=0,this.acceptTime=0,this.status=0,this.isAllBusy=!0,this.videoCamera="user",this.rotateAng=0,this._isMuting=!1,this._isSwitchAudience=!1,this.clipboardInterval=0,this._lastRCInputError=0,this.unusedMuteDict=new(c()),this.onVoipWindowClose=e=>{this.endCall(f.default.RemoteNetworkError),window.removeEventListener("beforeunload",this.onVoipWindowClose)},this.callTimeout=()=>{let e=(new Date).valueOf();this.callTimer||(this.callTimer=setInterval(this.callTimeout,1e3));let s=(0,g.numberValue)(this.joinTime);if(0!==s){if(this.status===m.default.STATUS_INCOMING){if(e-s>6e4)return void this.endCall(f.default.REASON_Timeout)}else if(this.status!==m.default.STATUS_CONNECTED&&e-s>6e4)return void this.endCall(f.default.RemoteTimeout);this.subscriberMap.forEach((s,t)=>{let o=(0,g.gt)(s.acceptTime,s.joinTime)?s.acceptTime:s.joinTime;s.status!==m.default.STATUS_CONNECTED&&(0,g.gt)(o,0)&&e-(0,g.numberValue)(o)>6e4&&(console.log("av-c","subscriber timeout",e,(0,g.numberValue)(s.acceptTime),(0,g.numberValue)(s.joinTime)),this.endUserCall(t,f.default.RemoteTimeout))})}},this.gotRemoteStream=(e,s)=>{if(this.sessionCallback){let t=this.getScreenSharingUserId(e);this.sessionCallback.didReceiveRemoteVideoTrack(t||e,s.streams[0],null!==t)}let t=s.streams[0];t.onremovetrack=s=>{console.log("av-c","pc remove remote stream",s),this.sessionCallback&&this.sessionCallback.didRemoveRemoteVideoTrack(e)};let o=this.getSubscriber(e);if(t.getAudioTracks().length>0){let e=new I.SoundMeter(window.audioContext);e.connectToSource(t,e=>{console.log("av-c","connect to soundMeter",e)}),o.soundMeter=e}o.stream=s.streams[0],console.log("av-c","pc received remote stream",e,s.streams[0],s.streams[0].getVideoTracks().length,s.streams[0].getAudioTracks().length)},this.onIceCandidate=(e,s,t)=>{if(!t.candidate)return;if(j.default.FORCE_MEDIA_OVER_TCP)return;let o={};if(o.session_id=this.sessionId,e===this.selfUserInfo.uid)o.handle_id=this.handleId;else{let s=this.getSubscriber(e);o.handle_id=s.handleId}let r={};r.candidate=t.candidate.candidate,r.sdpMLineIndex=t.candidate.sdpMLineIndex,r.sdpMid=t.candidate.sdpMid,r.pin=this.pin,o.candidate=r,h.default.sendConferenceRequest(this.sessionId,this.callId,"trickle",l()(o),(e,s)=>{0!==e&&console.log("av-c","conference request, trickle error",e)})},this.onIceStateChange=(e,s,t)=>{if(s){if(console.log("av-c","ICE state change event: ",e,s.iceConnectionState,t),"connected"===s.iceConnectionState){if(this.selfUserInfo.uid===e)return this.connectedTime||(this.connectedTime=(new Date).getTime()),void this.setState(m.default.STATUS_CONNECTED);{let s=this.getSubscriber(e);if(this.audience&&this.setState(m.default.STATUS_CONNECTED),s.status=m.default.STATUS_CONNECTED,this.sessionCallback){let s=this.getScreenSharingUserId(e);this.sessionCallback.didParticipantConnected(s||e,null!==s)}}}"disconnected"===s.iceConnectionState||"failed"===s.iceConnectionState&&console.log("av-c","iceConnectionState failed, endCall")}},this.bytesPrev=0,this.timestampPrev=0,this.requestArray=[],this._lastLocalClipboardData=[],this._lastRemoteClipboardData=[],this._listenDocumentOnFocus=()=>{S.clipboard||this._lastRemoteClipboardData&&navigator.clipboard.writeText(this._lastRemoteClipboardData).then(e=>{this._lastRemoteClipboardData=""}).catch(e=>{})},s}static newSession(e,s,t,o,r){console.log("av-c","newSession");let i=new D;return i.conversation=e,i.initiatorId=s,i.callId=t,i.audioOnly=o,i.sessionCallback=r,window.__callSession=i,i}getParticipantIds(){let e=[];for(const[s,t]of this.subscriberMap)e.push(s);return e}setAcceptTime(e){this.acceptTime||(this.acceptTime=e),this.updateInitiator()}setUserAcceptTime(e,s){console.log("av-c","setUserAcceptTime",e,s);let t=this.getSubscriber(e);t?t.acceptTime=s:console.error("av-c","setUserAcceptTime undefined",e,this.status,this.subscriberMap)}setUserJoinTime(e,s){this.getSubscriber(e).joinTime=s}getSubscriber(e,s){return s&&(e="screen_sharing_"+e),this.subscriberMap.get(e)}getParticipantProfiles(){let e=[];for(const s of this.subscriberMap.values()){let t=new V.default;t.userId=s.userId,t.status=s.status,t.joinTime=s.joinTime,t.acceptTime=s.acceptTime,t.audioMuted=s.audioMuted,t.videoMuted=s.videoMuted,t.audience=s.audience,e.push(t)}return e}getSelfProfile(){let e=new V.default;return e.userId=this.userId,e.status=this.status,e.joinTime=this.joinTime,e.acceptTime=this.acceptTime,e.audioMuted=this.audioMuted,e.videoMuted=this.videoMuted,e.audience=this.audience,e}getPeerConnection(e){return this.subscriberMap.get(e).peerConnection}answer(e,s){this._answer(e,s)}acceptRemoteControlRequest(){this._answer(!1,"")}_answer(e,s){this.status===m.default.STATUS_INCOMING&&(this.setState(m.default.STATUS_CONNECTING),this.audioOnly&&!e&&(e=!0),this.audioOnly=e,this.callExtra=s,h.default.answerCurrentCall())}setState(e){if(this.status!==e&&(this.status!==m.default.STATUS_CONNECTED||e!==m.default.STATUS_CONNECTING)){if(this.status=e,console.log("av-c","set status",e,this.startMsgUid),e===m.default.STATUS_IDLE||e===m.default.STATUS_CONNECTED){if(this.startMsgUid){let s={audioOnly:this.audioOnly};s.status=this.endReason?this.endReason:0,e===m.default.STATUS_CONNECTED?(s.connectTime=(new Date).getTime(),this.startTime=s.connectTime):s.endTime=(new Date).getTime(),h.default.updateCallStartMessageContent(this.startMsgUid,s)}e===m.default.STATUS_CONNECTED?(this.conference?this.notifyMuteState():!this.audioOnly&&this.videoMuted&&this.sendMuteVideoMessage(),this.rcStatus!==U.default.STATUS_INCOMING_REQUEST&&this.rcStatus!==U.default.STATUS_OUTGOING_REQUEST||(this.rcStatus=U.default.STATUS_CONNECTED,this._readClipboard(),this._listenDocumentOnFocus())):this.rcStatus=U.default.STATUS_IDLE,e===m.default.STATUS_IDLE&&clearInterval(this.clipboardInterval)}else e===m.default.STATUS_CONNECTING&&this.joinAndPublish();this.sessionCallback&&this.sessionCallback.didChangeState(e)}}initSession(e,s,t=[],o=[],r=!1){this.moCall=e,this.selfUserInfo=s,this.participantUserInfos=t,this.singleCall=t&&1===t.length,this.groupMemberUserInfos=o;let i=s;!e&&t&&t.length>0&&(i=t.filter(e=>e.uid===this.initiatorId)[0]),this.sessionCallback.onInitial(this,s,i,t,o);let n=[];t&&t.length>0&&t.forEach(e=>{n.push(e.uid)}),this.initSubscriberMap(n),r||(e?(this.setState(m.default.STATUS_OUTGOING),this.startPreview(this.audioOnly)):(this.setState(m.default.STATUS_INCOMING),this.playIncomingRing())),this.callTimeout(),window.AudioContext=window.AudioContext||window.webkitAudioContext,window.audioContext=new AudioContext,setTimeout(()=>{window.addEventListener("beforeunload",this.onVoipWindowClose)},500),this.soundMeterTimer=setInterval(()=>{if(!this.sessionCallback)return;let e=this.cameraPublisher&&this.cameraPublisher.soundMeter;if(e){let s=e.instant.toFixed(2);e.slow.toFixed(2),e.clip;this.sessionCallback.didReportAudioVolume(this.selfUserInfo.uid,Number(s))}this.subscriberMap.forEach((e,s)=>{if(!e.soundMeter)return;let t=e.soundMeter.instant.toFixed(2);e.soundMeter.slow.toFixed(2),e.soundMeter.clip;this.sessionCallback.didReportAudioVolume(s,Number(t))})},100),localStorage.getItem("enable_voip_debug")&&(this.pcStatsTimer=setInterval(()=>{this.subscriberMap.forEach((e,s)=>{let t=e.peerConnection;t&&t.getStats().then(e=>{this.showRemoteStats(s,e)})})},1e3))}initSubscriberMap(e){console.log("av-c","initParticipantClientMap",e),this.subscriberMap||(this.subscriberMap=new(c())),!e||e.length<1||e.forEach(e=>{let s=new p.default(e,this);s.status=m.default.STATUS_INCOMING,s.videoMuted=!0,s.audioMuted=!0,this.subscriberMap.set(e,s)},this)}inviteNewParticipants(e,s,t){e.length&&(e=e.filter(e=>e!==this.selfUserInfo.uid&&this.participantUserInfos.findIndex(s=>s.uid===e)<0)).length&&(this.singleCall=!1,h.default.inviteNewParticipants(e,this.pin,s,t))}getExistParticipantsStatus(){let e=[];return e.push({userId:this.selfUserInfo.uid,acceptTime:this.acceptTime?(0,g.numberValue)(this.acceptTime):0,joinTime:this.joinTime?(0,g.numberValue)(this.joinTime):0,videoMuted:this.videoMuted}),this.participantUserInfos.forEach(s=>{let t=this.getSubscriber(s.uid);e.push({userId:t.userId,acceptTime:t.acceptTime?(0,g.numberValue)(t.acceptTime):0,joinTime:t.joinTime?(0,g.numberValue)(t.joinTime):0,videoMuted:t.videoMuted})},this),e}didAddNewParticipants(e,s){e.forEach(e=>{-1===s.findIndex(s=>s.uid===e)&&s.push(new k.default(e))}),console.log("av-c","didAddNewParticipants",e,s),e.forEach(e=>{let s=new p.default(e,this);s.status=m.default.STATUS_INCOMING,this.subscriberMap.set(e,s)},this),s.forEach(e=>{this.participantUserInfos.push(e),this.sessionCallback&&this.sessionCallback.didParticipantJoined(e.uid,!1)},this)}updateExistParticipant(e,s){e.forEach(e=>{let t=new p.default(e.userId,this);e.acceptTime>0?t.status=m.default.STATUS_CONNECTED:this.selfUserInfo.uid===e.userId?t.status=m.default.STATUS_OUTGOING:t.status=m.default.STATUS_INCOMING,t.videoMuted=!0,t.audioMuted=!0,t.joinTime=s,t.acceptTime=e.acceptTime;let o=this.getScreenSharingUserId(e.userId);this.sessionCallback&&this.sessionCallback.didParticipantJoined(o||e.userId,!!o)})}updateVideoMute(e,s){let t=this.getSubscriber(e);t&&t.videoMuted!==s&&(t.videoMuted=s,this.sessionCallback&&this.sessionCallback.didVideoMuted(e,s))}defaultVideoConstraints(e){let s;if(e)s={audio:{echoCancellation:!0,noiseSuppression:!0,autoGainControl:!0},video:!1};else{let e=O.default.getVideoProfile(j.default.VIDEO_PROFILE);s={audio:{echoCancellation:!0,noiseSuppression:!0,autoGainControl:!0},video:{width:{ideal:e.width},height:{ideal:e.height},frameRate:{ideal:e.fps}}}}return this.audioInputDeviceId&&(s.audio.deviceId=this.audioInputDeviceId),e||(this.videoInputDeviceId?s.video.deviceId=this.videoInputDeviceId:s.video.facingMode=this.videoCamera),console.log("av-c","camera stream constraints",l()(s)),s}createLocalCameraVideoStream(e,s=!0){var t=this;return(0,n.default)((function*(){try{console.log("av-c","createLocalCameraVideoStream",e);const o=yield navigator.mediaDevices.getUserMedia(t.defaultVideoConstraints(e));console.log("av-c","Received local stream",o,o.getVideoTracks().length,e),s&&t.sessionCallback&&!t.videoMuted&&t.sessionCallback.didCreateLocalVideoTrack(o,!1);const r=o.getVideoTracks();e?r&&r.length>0&&(console.log("av-c","audioOnly, stop video track"),r.forEach((function(e){return e.stop()}))):r&&r.length>0&&console.log("av-c",`Using video device: ${r[0].label}`);const i=o.getAudioTracks();return i.length>0&&console.log("av-c",`Using audio device: ${i[0].label}`),o}catch(e){console.error("av-c","getUserMedia error",e)}return console.log("av-c","createLocalCameraVideoStream failed"),null}))()}startPreview(e){var s=this;return(0,n.default)((function*(){console.log("av-c","start preview"),s.conference&&s.audience||(s.previewStream=yield s.createLocalCameraVideoStream(e),s.previewStream||(s.previewStream=yield s.createDummyVideoStream()),s.previewStream||s.endCall(f.default.REASON_MediaError),s.status===m.default.STATUS_IDLE&&s.endMedia())}))()}getDesktopSources(e){return null}startScreenShare(e){var s=this;return(0,n.default)((function*(){if(!s.isScreenSharing()&&!s.audioOnly){if(console.log("av-c","start screen share",e),S.currentWindow)s.screenShareStream=yield navigator.mediaDevices.getUserMedia({audio:!1,video:{mandatory:(0,i.default)({chromeMediaSource:"desktop"},e)}}),console.log("av-c","screen share stream",s.screenShareStream);else{console.log("av-c","await screenShareStream");let t={};e&&(t={height:{max:e.maxHeight,min:e.minHeight,ideal:e.idealHeight},width:{max:e.maxWidth,min:e.minWidth,ideal:e.idealWidth},frameRate:e.frameRate}),s.screenShareStream=yield navigator.mediaDevices.getDisplayMedia({audio:!1,video:t}),console.log("av-c","screenShareStream",s.screenShareStream)}s.screenSharing=!0,s.sessionCallback&&s.sessionCallback.didCreateLocalVideoTrack(s.screenShareStream,!0),s.screenShareStream.getVideoTracks()[0].addEventListener("ended",(function(){s.stopScreenShare()})),j.default.SCREEN_SHARING_REPLACE_MODE?(console.log("av-c","screen share replace mode"),s.cameraPublisher.videoSender?(s.cameraPublisher.stopVideoTrack(s.cameraPublisher.cameraVideoStream),yield s.cameraPublisher.videoSender.replaceTrack(s.screenShareStream.getVideoTracks()[0]),j.default.DISABLE_DUAL_STREAM||(s.smallScreenShareVideoTrack=s.screenShareStream.getVideoTracks()[0].clone(),yield s.cameraPublisher.smallVideoSender.replaceTrack(s.smallScreenShareVideoTrack),console.log("av-c","screen share replace mode, replace small video track",s.smallScreenShareVideoTrack))):console.error("av-c","screen share error, publisher.videoSender is null"),s.notifyMuteState()):(console.log("av-c","screen share none replace mode"),s.screenSharingPublisher=new A.default(s),s.screenSharingPublisher.attachAndPublishScreenSharing())}}))()}isScreenSharing(){return!!this.screenShareStream}stopScreenShare(){var e=this;console.log("av-c","stopScreenShare"),j.default.SCREEN_SHARING_REPLACE_MODE?(this.cameraPublisher.stopVideoStream(this.screenShareStream),this.smallScreenShareVideoTrack&&(console.log("av-c","stop smallScreenShareVideoTrack"),this.smallScreenShareVideoTrack.stop()),this.screenShareStream=null,this.screenSharing=!1,this.videoMuted?this.notifyMuteState():(0,n.default)((function*(){e.cameraPublisher.cameraVideoStream=null,yield e.cameraPublisher.createMediaSenders(),e.sessionCallback&&e.sessionCallback.didCreateLocalVideoTrack(e.cameraPublisher.cameraVideoStream,!1)}))()):(this.screenSharingPublisher&&(this.screenSharingPublisher.stopVideoStream(this.screenShareStream),this.screenSharingPublisher.unPublishMedia(),this.screenSharingPublisher.deattach(),this.screenSharingPublisher=null,this.sessionCallback&&(this.sessionCallback.didParticipantLeft(this.selfUserInfo.uid,f.default.REASON_Hangup,!0),this.cameraPublisher&&this.cameraPublisher.cameraVideoStream&&!this.videoMuted&&!this.audioMuted&&this.sessionCallback.didCreateLocalVideoTrack(this.cameraPublisher.cameraVideoStream,!1))),this.screenShareStream=null,this.screenSharing=!1),this.sessionCallback&&this.sessionCallback.didScreenShareEnded()}createPeerConnection(e,s){let t=this.getSelectedSdpSemantics();if(console.log("xxxxx av-c","RTCPeerConnection configuration:",e,t),u.default.ICE_SERVERS&&u.default.ICE_SERVERS.length){t.iceServers=[];for(const e of u.default.ICE_SERVERS)t.iceServers.push({credential:e[2],credentialType:"password",urls:e[0],username:e[1]})}let o=j.default.FORCE_RELAY;void 0===o&&(o=j.default.FORCE_REPLAY),o&&(console.log("av-c","force relay",t.iceServers.length),t.iceTransportPolicy="relay");let r=new RTCPeerConnection(t);if(e!==this.selfUserInfo.uid){let t=this.getSubscriber(e);t.peerConnection=r,t.isInitiator=s}return console.log("av-c","Created local peer connection object pc"),r.addEventListener("icecandidate",s=>this.onIceCandidate(e,r,s)),r.addEventListener("iceconnectionstatechange",s=>this.onIceStateChange(e,r,s)),r.addEventListener("track",s=>this.gotRemoteStream(e,s)),r.addEventListener("connectionstatechange",s=>this.onConnectionStateChange(e,r,s)),console.log("av-c","createPeerConnection",e,this.getSubscriber(e)),r}getSelectedSdpSemantics(){return{bundlePolicy:"max-bundle"}}onConnectionStateChange(e,s,t){console.log("av-c","onConnectionStateChange",e,s,t),s.connectionState}hangup(){console.log("av-c","Ending call"),this.endCall(f.default.REASON_Hangup)}setAudioOnly(e){this.audioOnly=e,this.conference||this.sessionCallback&&this.sessionCallback.didChangeMode(e)}downgrade2Voice(e=!1){this.status===m.default.STATUS_CONNECTED&&(this.cameraPublisher.stopVideoTrack(this.cameraPublisher.cameraVideoStream),e||h.default.downgrade2VoiceCall(),this.setAudioOnly(!0))}downToVoice(){if(console.log("av-c","down to voice"),this.stopIncomingRing(),this.status===m.default.STATUS_INCOMING)return this.setAudioOnly(!0),void this.answerCall(!0);this.status===m.default.STATUS_CONNECTED&&(this.audioOnly||(this.setAudioOnly(!0),h.default.downgrade2VoiceCall()))}muteVideo(e){var s=this;return(0,n.default)((function*(){return yield s.setVideoEnabled(!e)}))()}setVideoEnabled(e){var s=this;return(0,n.default)((function*(){return s.status!==m.default.STATUS_CONNECTED?(console.error("av-c","connecting, can not muteVideo"),!1):s.videoMuted===!e?(console.log("av-c","setVideoEnabled error",s.videoMuted,e),!1):s.audioOnly||s.isScreenSharing()&&j.default.SCREEN_SHARING_REPLACE_MODE?(console.log("av-c","setVideoEnabled error audioOnly, or (isScreenSharing and replace mode)"),!1):s._isMuting?(console.log("av-c","mute operation is still in progress"),!1):(s.videoMuted=!e,console.log("av-c",`setVideoEnabled ${e}, audience ${s.audience}`),s.audience||(s._isMuting=!0,e?(s.cameraPublisher||(s.cameraPublisher=new R.default(s),s.cameraPublisher.handleId=s.handleId),s.cameraPublisher.stopVideoStream(s.cameraPublisher.cameraVideoStream),s.cameraPublisher.cameraVideoStream=null,yield s.cameraPublisher.createMediaSenders()):s.cameraPublisher&&s.cameraPublisher.stopVideoTrack(s.cameraPublisher.cameraVideoStream),s.conference?s.notifyMuteState():s.sendMuteVideoMessage(),s.sessionCallback&&s.sessionCallback.didMuteStateChanged([s.selfUserInfo.uid]),console.log("av-c","mute video end"),s._isMuting=!1),!0)}))()}sendMuteVideoMessage(){let e=new M.default;e.callId=this.callId,e.videoMuted=this.videoMuted,e.existParticipants=this.getExistParticipantsStatus(),h.default.sendSignalMessage(e,this.getParticipantIds(),!0,!1)}muteAudio(e){var s=this;return(0,n.default)((function*(){return yield s.setAudioEnabled(!e)}))()}setAudioEnabled(e){var s=this;return(0,n.default)((function*(){return s.status!==m.default.STATUS_CONNECTED?(console.error("av-c","connecting, can not muteAudio"),!1):s.audioMuted!==!e&&(s._isMuting?(console.log("av-c","mute operation is still in progress"),!1):(s.audioMuted=!e,s.audience||(s._isMuting=!0,console.log("av-c","setAudioEnabled",e),e?s.cameraPublisher&&s.cameraPublisher.cameraVideoStream?s.cameraPublisher.cameraVideoStream.getTracks().forEach((function(e){"audio"===e.kind&&(e.enabled=!0)})):(s.cameraPublisher=new R.default(s),s.cameraPublisher.handleId=s.handleId,yield s.cameraPublisher.createMediaSenders()):s.cameraPublisher&&s.cameraPublisher.stopAudioTrack(s.cameraPublisher.cameraVideoStream),s.conference&&s.status===m.default.STATUS_CONNECTED&&(s.notifyMuteState(),s.sessionCallback&&s.sessionCallback.didMuteStateChanged([s.selfUserInfo.uid])),console.log("av-c","mute audio end"),s._isMuting=!1),!0))}))()}forceEndMedia(){this.endMedia()}endMedia(){if(console.log("av-c","Ending media"),this.setState(m.default.STATUS_IDLE),this.stopIncomingRing(),this.cameraPublisher&&this.cameraPublisher.endMedia(),this.screenSharingPublisher&&this.screenSharingPublisher.endMedia(),this.previewStream){console.log("av-c","stop previewStream");const e=this.previewStream;this.previewStream=null,void 0===e.getTracks?e.stop():e.getTracks().forEach(e=>{console.log("av-c","stop preview track",e.kind,e.id),e.stop()})}}endUserCall(e,s){if(console.log("av-c","endUserCall",e,s),e===this.selfUserInfo.uid)return void this.endCall(s);if(!this.conference&&e===this.initiatorId){let t=!1;for(const[s,o]of this.subscriberMap)if(console.log("av-c","endUserCall acceptTime",o.acceptTime),o.acceptTime&&(0,g.gt)(o.acceptTime,0)&&e!==s){t=!0;break}if(t=t||this.acceptTime&&this.acceptTime&&(0,g.gt)(this.acceptTime,0),!t)return void this.endCall(s)}let t=this.getSubscriber(e);if(this.subscriberMap.delete(e),this.participantUserInfos&&(this.participantUserInfos=this.participantUserInfos.filter(s=>s.uid!==e)),t){if(t.peerConnection){t.peerConnection.getSenders().forEach(e=>t.peerConnection.removeTrack(e)),t.peerConnection.close(),t.peerConnection=null}if(e===this.initiatorId&&this.updateInitiator(),this.sessionCallback){let t=this.getScreenSharingUserId(e);this.sessionCallback.didParticipantLeft(t||e,s,null!==t)}}this.isAllBusy=this.isAllBusy&&s===f.default.RemoteBusy,this.conference||0!==this.subscriberMap.size||(0===this.conversation.type||this.singleCall?this.endCall(s):this.endCall(this.isAllBusy?f.default.RemoteBusy:f.default.REASON_AllLeft))}leaveConference(e){this.conference?this.endCall(f.default.REASON_Hangup,e):this.endCall(f.default.REASON_Hangup)}endCall(e,s){if(console.log("av-c","endCall ---- ",e,(new Error).stack),this.endReason=e,this.status===m.default.STATUS_IDLE)return;if(this.setState(m.default.STATUS_IDLE),!this.conference&&e!==f.default.REASON_AcceptByOtherClient&&e!==f.default.REASON_AllLeft&&e!==f.default.REASON_RemoteHangup&&this.getParticipantIds().length>0){let s=new _.default;s.callId=this.callId,s.inviteMsgUid=this.startMsgUid,s.reason=e,h.default.sendSignalMessage(s,this.getParticipantIds(),!1,!0)}if(e!==f.default.REASON_AcceptByOtherClient){let t={};t.handle_id=this.handleId,(s||e===f.default.REASON_AllLeft||this.conversation&&this.conversation.type===v.default.Single&&[f.default.RemoteBusy,f.default.REASON_RemoteHangup,f.default.RemoteTimeout].indexOf(e)>-1)&&(t.destroy=!0),console.log("av-c","leave",l()(t)),h.default.sendConferenceRequest(this.sessionId,this.callId,"leave",l()(t),(e,s)=>{0!==e&&console.log("av-c","conference request, leave error",e)})}this.callId,this.audioOnly,this.pin,this.host,this.title,this.desc,this.audience,this.advance;this.keepAlive(!1),this.endTime=(new Date).valueOf();for(const[e,s]of this.subscriberMap)s.peerConnection&&(s.peerConnection.close(),s.peerConnection=null);h.default.currentSession=null,clearInterval(this.callTimer),clearInterval(this.soundMeterTimer),this.pcStatsTimer&&clearInterval(this.pcStatsTimer),this.endMedia(),this.sessionCallback&&this.sessionCallback.didCallEndWithReason(e)}defaultPublishMediaConstraints(){return{offerToReceiveAudio:!1,offerToReceiveVideo:!1}}defaultSubscribeMediaConstraints(){return{offerToReceiveAudio:!0,offerToReceiveVideo:!0}}restartPublishConstrains(){return{iceRestart:!0,offerToReceiveAudio:!1,offerToReceiveVideo:!1}}createRoom(e){let s={participants:9};s.pin=this.pin,s.publishers=this.audioOnly?j.default.MAX_AUDIO_PARTICIPANT_COUNT:j.default.MAX_VIDEO_PARTICIPANT_COUNT,this.conference||(s.is_private=!0),this.record&&(s.record=!0),console.log("av-c","create room"),h.default.sendConferenceRequest(this.sessionId,this.callId,"create_room",l()(s),(s,t)=>{if(console.log("av-c","create_room res",s,t),0!==s)return void e(s);let o=JSON.parse(t);this.sessionId=o.session_id,this.handleId=o.handle_id;let r=o.data;this.callId,r.room,this.keepAlive(!0),e(0),this.conference&&this.setState(m.default.STATUS_CONNECTING)})}onConferenceEvent(e){let s;if(s="string"==typeof e?JSON.parse(e):e,console.log("av-c","onConferenceEvent",l()(e)),this.sessionId!==s.session_id)return void console.log("av-c","on conference event, unknown sessionId",this.sessionId,s.session_id);let t=s.sender;if(t>0&&this.screenSharingPublisher&&this.screenSharingPublisher.handleId===t)return;let o=s.data,r=o?o.videoroom:null;if("event"===r){let e=o.publishers;this.onPublish(e);let s=o.unpublished;s&&this.onUnpublish(s);let t=o.leaving;t&&("ok"===t&&"kicked"===o.reason?this.onLeave(this.selfUserInfo.uid):this.onLeave(t));let r=o.kicked;r&&this.onLeave(r);let i=o.joining;i&&this.onJoining([i]);let n=o.attendees;this.onJoining(n)}else if("destroyed"===r)this.endCall(f.default.RoomDestroyed);else if("participants"===r){let e=o.attendees;if(e&&e.length>0){let s=e.map(e=>({id:e}));this.onJoining(s)}let s=o.leavings;s&&s.length>0&&s.forEach(e=>{this.onLeave(e)})}else if("mute"===r){let e=o.mute;this.onMute(e)}else if("slowlink"===r){let e=s.handle_id;this.onSlowLink(this.sessionId,e,o)}else{"hangup"===s.janus||console.log("av-c","unknown event")}}keepAlive(e){if(e){if(this.keepAliveTimer)return;this.lastActiveTime=(new Date).getTime(),this.keepAliveTimer=setInterval(()=>{h.default.sendConferenceRequest(this.sessionId,this.callId,"keepalive","",(e,s)=>{let t=(new Date).getTime();if(0===e)this.lastActiveTime=t;else{if(253===e||61===e)return console.error("av-c","keepalive error",e),void this.endCall(f.default.REASON_SignalError);this.lastActiveTime>0&&t-this.lastActiveTime>6e4&&(console.error("av-c","keepalive not response",t-this.lastActiveTime),this.endCall(f.default.REASON_SignalError))}})},2e4)}else this.keepAliveTimer&&(clearInterval(this.keepAliveTimer),this.keepAliveTimer=0)}joinAndPublish(){let e={};e.handle_id=this.handleId,e.user_id=this.selfUserInfo.uid,e.pin=this.pin,this.callExtra&&(e.extra=this.callExtra),h.default.sendConferenceRequest(this.sessionId,this.callId,"join_pub",l()(e),(e,s)=>{if(console.log("av-c","join_pub",e,s),0!==e)return void this.endCall(f.default.REASON_SignalError);let t=JSON.parse(s),o=t.data,r=o.error_code;if(r>0)return console.log("av-c","conference request, join_pub error",r),void(r===T.default.JANUS_VIDEOROOM_ERROR_NO_SUCH_ROOM?this.endCall(f.default.RoomNotExist):r===T.default.JANUS_VIDEOROOM_ERROR_ID_EXISTS&&setTimeout(()=>{this.status!==m.default.STATUS_IDLE&&(console.log("av-c","rejoin"),this.joinAndPublish())},500));this.sessionId=t.session_id,this.handleId=t.handle_id;let i=o.publishers;this.onPublish(i);o.id,o.videoroom;this.privateId=o.private_id;o.description,o.room;let n=o.attendees;this.onJoining(n),this.audience?this.setState(m.default.STATUS_CONNECTED):(this.cameraPublisher=new R.default(this),this.cameraPublisher.handleId=this.handleId,this.cameraPublisher.publishMedia()),this.keepAlive(!0)})}updateInitiator(){let e,s=(new Date).getTime()+864e5;(0,g.gt)(this.acceptTime,0)&&(s=this.acceptTime,e=this.selfUserInfo.uid),this.subscriberMap.forEach(t=>{(0,g.gt)(t.acceptTime,0)&&(0,g.gt)(s,t.acceptTime)&&(s=t.acceptTime,e=t.userId)});let t=this.initiatorId;this.initiatorId=e,this.subscriberMap.forEach(e=>{e.isInitiator=this.initiatorId===e.userId}),t!==e&&e!==this.selfUserInfo.uid&&this.sessionCallback&&this.sessionCallback.didChangeInitiator(this.initiatorId)}onParticipantPublish(e){e.talking;let s=e.id;if(this.isSelfScreenSharing(s))return;let t=e.display,o=!0,r=e.streams;for(const[e,i]of this.subscriberMap)if(e===s){i.streams(r),i.callExtra=t,i.subscribe(),i.audience=!1,o=!1;break}if(o){let e=new p.default(s,this);this.subscriberMap.set(e.userId,e);let o=(new Date).valueOf();this.setUserAcceptTime(e.userId,o),this.setUserJoinTime(e.userId,o);let i=!1,n=!0,a=this.unusedMuteDict[s];if(a&&(i=a.a,n=a.v,this.unusedMuteDict.delete(s)),this.conference&&s.startsWith("screen_sharing_")?e.videoMuted=!1:e.videoMuted=n,e.audioMuted=i,e.status=m.default.STATUS_CONNECTED,e.audience=!1,e.callExtra=t,e.streams(r),e.subscribe(),this.sessionCallback){let s=this.getScreenSharingUserId(e.userId);this.sessionCallback.didParticipantJoined(s||e.userId,null!==s),this.reportAudienceChanged(e.userId,!1)}}else this.reportAudienceChanged(s,!1);let i=this.subscriberMap.get(s);(i.videoMuted||i.audioMuted)&&this.sessionCallback&&this.sessionCallback.didMuteStateChanged([s])}onPublish(e){if(console.log("av-c","onPublish",e),e)for(const s of e)this.onParticipantPublish(s)}onJoining(e){if(e){console.log("av-c","onJoining",e);for(const s of e){let e=s.id;if(this.isSelfScreenSharing(e))continue;let t=!0,o=s.display;for(const[s,r]of this.subscriberMap)if(s===e){r.audience=!0,r.callExtra=o,t=!1;break}if(t){let s=new p.default(e,this);this.subscriberMap.set(s.userId,s);let t=(new Date).valueOf();if(this.setUserAcceptTime(s.userId,t),this.setUserJoinTime(s.userId,t),s.videoMuted=!0,s.audioMuted=!0,s.status=m.default.STATUS_CONNECTED,s.audience=!0,s.callExtra=o,this.sessionCallback){let e=this.getScreenSharingUserId(s.userId);this.sessionCallback.didParticipantJoined(e||s.userId,null!==e)}}}}}onUnpublish(e){for(const[s,t]of this.subscriberMap)if(s===e){t.audience=!0,t.videoMuted=!0,t.audioMuted=!0,t.peerConnection&&(t.peerConnection.close(),t.peerConnection=null),t.handleId=0;break}this.conference&&e!==this.selfUserInfo.uid&&this.reportAudienceChanged(e,!0)}reportAudienceChanged(e,s){let t=this.getScreenSharingUserId(e);this.sessionCallback&&this.sessionCallback.didChangeType(t||e,s,null!==t)}onSlowLink(e,s,t){if(!this.sessionCallback)return;let o=t.media,r=t.uplink,i=t.lost;if(this.handleId===s)this.sessionCallback.didMediaLostPacket(o,i,!1);else if(this.screenSharingPublisher&&this.screenSharingPublisher.handleId===s)this.sessionCallback.didMediaLostPacket(o,i,!0);else for(const[e,t]of this.subscriberMap)if(t.handleId===s){if(e.startsWith("screen_sharing_")){let s=e.substr("screen_sharing_".length);this.sessionCallback.didUserMediaLostPacket(s,o,i,r,!0)}else this.sessionCallback.didUserMediaLostPacket(e,o,i,r,!1);break}}onLeave(e){this.getSubscriber(e)?this.endUserCall(e,f.default.REASON_RemoteHangup):e===this.selfUserInfo.uid&&this.endCall(f.default.REASON_Hangup,!1)}mediaStream(){return this.screenShareStream?this.screenShareStream:this.cameraVideoStream}requestChangeMode(e,s){let t=new y.default(this.callId,s),o=new C.default(v.default.Single,e,0);h.default.sendSignalMessageEx(o,t,this.getParticipantIds(),!1,!1)}onRequestChangeMode(e){this.switchAudience(e)}onKickoff(){this.leaveConference(!1)}switchAudience(e){var s=this;return(0,n.default)((function*(){console.log("av-c","switchAudience",e),s.conference&&(s._isSwitchAudience||e===s.audience?console.log("av-c",`switchAudience isSwitching ${s._isSwitchAudience}`):(s._isSwitchAudience=!0,e?s.audience||(s.screenSharingPublisher&&(yield s.screenSharingPublisher.unPublishMedia(),s.screenSharingPublisher.screenShareStream=null),s.cameraPublisher&&(yield s.cameraPublisher.unPublishMedia(),s.cameraPublisher.cameraVideoStream=null),s.reportAudienceChanged(s.selfUserInfo.uid,!0),s.audience=!0):(s.cameraPublisher||(s.cameraPublisher=new R.default(s),s.cameraPublisher.handleId=s.handleId),yield s.cameraPublisher.publishMedia(),s.reportAudienceChanged(s.selfUserInfo.uid,!1),s.notifyMuteState(),s.audience=!1),s._isSwitchAudience=!1))}))()}onMute(e){let s=[],t=new(c());r()(e).forEach(s=>{t.set(s,e[s])}),this.subscriberMap.forEach((o,r)=>{let i=e[r],n=!1,a=!1;i&&(t.delete(r),n=!!i.hasOwnProperty("a")&&i.a,a=!!i.hasOwnProperty("v")&&i.v),o.videoMuted===a&&o.audioMuted===n||(o.videoMuted=a,o.audioMuted=n,o.audience||s.push(r))});for(const e of t.entries())this.unusedMuteDict.set(e[0],e[1]);s=s.filter(e=>e!==this.selfUserInfo.uid),s.length>0&&this.sessionCallback&&this.sessionCallback.didMuteStateChanged(s)}notifyMuteState(){if(!this.conference||this.status===m.default.STATUS_IDLE)return;let e={handle_id:this.handleId,a:this.audioMuted};j.default.SCREEN_SHARING_REPLACE_MODE?e.v=this.videoMuted&&!this.isScreenSharing():e.v=this.videoMuted,h.default.sendConferenceRequest(this.sessionId,this.callId,"mute",l()(e),(e,s)=>{console.log("av-c","mute res",e,s)})}kickoffParticipant(e,s,t){if(this.status===m.default.STATUS_IDLE&&t&&t(-1),this.getSubscriber(e)){let o={handle_id:this.handleId,user:e};h.default.sendConferenceRequest(this.sessionId,this.callId,"kick",l()(o),(e,o)=>{console.log("av-c","kick res",e,o),0===e?s&&s():t&&t(e)})}}closeVoipWindow(){localStorage.getItem("enable_voip_debug")||(S.currentWindow?S.currentWindow.close():E.default.emitToMain("close-voip-div"))}setAudioInputDeviceId(e){console.log("av-c","setInputAudioDeviceId",this.audioInputDeviceId,e),e="null"===e?null:e,this.audioInputDeviceId=e,this.cameraPublisher&&(this.cameraPublisher.stopVideoStream(this.cameraPublisher.cameraVideoStream),this.cameraPublisher.cameraVideoStream=null,this.cameraPublisher.createMediaSenders())}setVideoInputDeviceId(e){console.log("av-c","setVideoInputDeviceId",this.videoInputDeviceId,e),e="null"===e?null:e,this.videoInputDeviceId=e,this.cameraPublisher&&(this.cameraPublisher.stopVideoStream(this.cameraPublisher.cameraVideoStream),this.cameraPublisher.cameraVideoStream=null,this.cameraPublisher.createMediaSenders())}setInputStream(e){this.externalStream=e,this.cameraPublisher&&(this.cameraPublisher.stopVideoStream(this.cameraPublisher.cameraVideoStream),this.cameraPublisher.cameraVideoStream=null,this.cameraPublisher.createMediaSenders())}switchCamera(){return!!navigator.mediaDevices.getSupportedConstraints().facingMode&&("user"===this.videoCamera?this.videoCamera="environment":this.videoCamera="user",console.log("av-c","switch camera",this.videoCamera),this.cameraPublisher.stopVideoStream(this.cameraPublisher.cameraVideoStream),this.cameraPublisher.createMediaSenders(),!0)}rotate(e){console.log("av-c","rotate",e),this.cameraPublisher&&this.cameraPublisher.rotate(e)}screenSharingId(){return"screen_sharing_"+this.selfUserInfo.uid}getScreenSharingUserId(e=""){return e.startsWith("screen_sharing_")?e.substring("screen_sharing_".length):null}isSelfScreenSharing(e=""){return this.screenSharingId()===e}setVideoMaxBitrate(e){this.cameraPublisher&&this.cameraPublisher.setVideoMaxBitrate(e)}scaleVideoResolutionDownBy(e){this.cameraPublisher&&this.cameraPublisher.scaleVideoResolutionDownBy(e)}dumpStats(e){let s="";return e.forEach(e=>{s+="<h3>Report type=",s+=e.type,s+="</h3>\n",s+=`id ${e.id}<br>`,s+=`time ${e.timestamp}<br>`,r()(e).forEach(t=>{"timestamp"!==t&&"type"!==t&&"id"!==t&&("object"==typeof e[t]?s+=`${t}: ${l()(e[t])}<br>`:s+=`${t}: ${e[t]}<br>`)})}),s}showRemoteStats(e,s){const t=this.dumpStats(s);localStorage.getItem("enable_voip_debug.stats")&&console.log("av-c","statsString",e,t),s.forEach(s=>{const t=s.timestamp;let o;if("inbound-rtp"===s.type&&"video"===s.mediaType){const e=s.bytesReceived;this.timestampPrev&&(o=8*(e-this.bytesPrev)/(t-this.timestampPrev),o=Math.floor(o)),this.bytesPrev=e,this.timestampPrev=t}o&&(o+=" kbits/sec",console.log("av-c","Bitrate:",e,o))})}setParticipantVideoType(e,s,t){s&&(e="screen_sharing_"+e);for(const[s,o]of this.subscriberMap)if(e===s){o.setVideoType(t);break}}onIMConnectionStatusChange(e){console.log("av-c","onIMConnectionStatusChange",e),1===e?(this.status===m.default.STATUS_CONNECTED&&this.queryParticipantStatus(),this.cameraPublisher&&this.cameraPublisher.restartICE(),this.screenSharingPublisher&&this.screenSharingPublisher.restartICE(),this.subscriberMap&&this.subscriberMap.forEach((e,s)=>{e.restartICE()})):-2!==e&&-3!==e&&-5!==e&&-6!==e&&-7!==e&&-8!==e&&-9!==e||this.endCall(f.default.REASON_Hangup)}queryParticipantStatus(){let e={handle_id:this.handleId,pin:this.pin};h.default.sendConferenceRequest(this.sessionId,this.callId,"query_participants",l()(e),(e,s)=>{if(0!==e)return void console.log("av-c","conference request, query_participants error",e);let t=JSON.parse(s).data;if(t){let e=t.publishers,s=t.attendees;this.onJoining(s),this.onPublish(e)}})}createDummyVideoStream(){return(0,n.default)((function*(){const e=document.createElement("video");e.autoplay=!0,e.loop=!0,e.volume=.5,e.src=j.default.DUMMY_VIDEO_URI,e.load();try{yield e.play()}catch(e){console.log("av-c","video auto play error",e)}let s=null;return e.captureStream?s=e.captureStream():e.mozCaptureStream?s=e.mozCaptureStream():(console.log("av-c","video captureStream() not supported, fallback to canvas"),s=document.createElement("canvas").captureStream(60)),console.log("av-c","createDummyVideoStream",s,s.getVideoTracks().length),s}))()}inviteRemoteControl(){if(this.conversation.type!==v.default.Single&&!this.audioOnly)return void console.error("av-c","仅高级版音视频单人视频通话，支持远程控制");this.rcStatus=U.default.STATUS_OUTGOING_INVITE;let e=new N.default(this.callId);h.default.sendSignalMessageEx(this.conversation,e,[],!1),setTimeout(()=>{this.rcStatus!==U.default.STATUS_CONNECTED&&(this.rcStatus=U.default.STATUS_IDLE,this.sessionCallback&&this.sessionCallback.didRemoteControlEnd(w.default.REASON_TIME_OUT))},6e4)}onDataChannelMessage(e,s){if(this.rcStatus===U.default.STATUS_CONNECTED)if("string"==typeof s){let e=JSON.parse(s);"rce"===e.type?this.sessionCallback&&this.sessionCallback.didRemoteControlInputError(e.code):"cs"===e.type&&this._writeClipboardData(e.data)}else if(this.sessionCallback){let e=this.sessionCallback.didReceiveRemoteControlEvent(s);0!==e&&this._lastRCInputError!==e?(this._lastRCInputError=e,this.cameraPublisher.dataChannel.send(l()({type:"rce",code:e}))):this._lastRCInputError=e}}acceptRemoteControlInvite(){if(this.conversation.type!==v.default.Single&&!this.audioOnly)return void console.error("av-c","仅高级版音视频单人视频通话，支持远程控制");this.rcStatus=U.default.STATUS_CONNECTED,this._readClipboard(),this._listenDocumentOnFocus();let e=new P.default(this.callId);h.default.sendSignalMessageEx(this.conversation,e,[],!1)}rejectRemoteControlInvite(){if(this.conversation.type!==v.default.Single&&!this.audioOnly)return void console.error("av-c","仅高级版音视频单人视频通话，支持远程控制");let e=new x.default(this.callId);e.reason=w.default.REASON_REJECT,h.default.sendSignalMessageEx(this.conversation,e,[],!1)}endRemoteControl(e){if(this.conversation.type!==v.default.Single&&!this.audioOnly)return void console.error("av-c","仅高级版音视频单人视频通话，支持远程控制");let s=new x.default(this.callId);s.reason=w.default.REASON_HANGUP,this.rcStatus=U.default.STATUS_IDLE,h.default.sendSignalMessageEx(this.conversation,s,[],!1)}_onReceiveRemoteControlInvite(){this.rcStatus=U.default.STATUS_INCOMING_INVITE,this.sessionCallback.onReceiveRemoteControlInvite(),setTimeout(()=>{this.rcStatus!==U.default.STATUS_CONNECTED&&(this.rcStatus=U.default.STATUS_IDLE,this.sessionCallback&&this.sessionCallback.didRemoteControlEnd(w.default.REASON_TIME_OUT))},6e4)}_didRemoteControlEnd(e){this.rcStatus=U.default.STATUS_IDLE,this.sessionCallback.didRemoteControlEnd(e)}_didAcceptRemoteControlInvite(){this.rcStatus=U.default.STATUS_CONNECTED,this.sessionCallback.didAcceptRemoteControlInvite()}_isSupportRemoteControl(){return!(this.conversation.type!==v.default.Single&&!this.audioOnly)||(console.error("av-c","仅高级版音视频单人视频通话，支持远程控制"),!1)}sendRemoteControlInputEvent(e){"open"===this.cameraPublisher.dataChannel.readyState&&this.cameraPublisher.dataChannel.send(e)}_sendClipboardData(e,s){s&&this.cameraPublisher.dataChannel&&this._lastLocalClipboardData[e]!==s&&("open"===this.cameraPublisher.dataChannel.readyState&&(console.log("datachannel ready, send clipboard data",e,s),this.cameraPublisher.dataChannel.send(l()({type:"cs",data:{type:e,data:s}}))),this._lastLocalClipboardData[e]=s)}_readClipboard(){this.clipboardInterval||(this.clipboardInterval=setInterval(()=>{if(S.clipboard){let e=S.clipboard.readText();e&&this._sendClipboardData("text",e)}else{if(!document.hasFocus())return;navigator.clipboard.readText().then(e=>{this._sendClipboardData("text",e)}).catch(e=>{})}},50))}_writeClipboardData(e){let s=e.type,t=e.data;if(S.clipboard)if("text"===s)S.clipboard.writeText(t);else if("image"===s){let e=S.nativeImage.createFromDataURL(t);S.clipboard.writeImage(e)}}}},"./av/internal/publisherImpl.js":(e,s,t)=>{t.r(s),t.d(s,{default:()=>_});var o=t("./node_modules/babel-runtime/core-js/json/stringify.js"),r=t.n(o),i=t("./node_modules/babel-runtime/core-js/promise.js"),n=t.n(i),a=t("./node_modules/babel-runtime/helpers/asyncToGenerator.js"),l=t("../engine/callState"),d=t("./av/internal/avenginekitImpl.js"),c=t("./av/internal/roomErrorCode.js"),u=t("../engine/callEndReason"),m=t("../engine/avenginekit"),h=t("../engine/videoProfile"),f=t("./av/internal/soundMeter.js");class _{constructor(e){this.callSession=e}createMediaSenders(){var e=this;return(0,a.default)((function*(){let s;if(e.callSession.previewStream&&(console.log("av-c","stop previewStream"),e.callSession.previewStream.getTracks().forEach((function(e){return e.stop()}))),console.log("av-c","createMediaSenders -0",e.callSession.audioOnly,e.callSession.videoMuted),e.callSession.externalStream)e.cameraVideoStream=e.callSession.externalStream,e.callSession.sessionCallback&&!e.callSession.videoMuted&&e.callSession.sessionCallback.didCreateLocalVideoTrack(e.callSession.externalStream,!1);else{if(e.cameraVideoStream=yield e.callSession.createLocalCameraVideoStream(e.callSession.audioOnly||m.default.SCREEN_SHARING_REPLACE_MODE&&e.callSession.isScreenSharing()),!e.cameraVideoStream){if(!e.callSession.audioOnly){let t=yield e.callSession.createLocalCameraVideoStream(!0);t&&(s=t.getAudioTracks()[0])}if(e.cameraVideoStream=yield e.callSession.createDummyVideoStream(),s){let t=e.cameraVideoStream.getAudioTracks()[0];e.cameraVideoStream.removeTrack(t),e.cameraVideoStream.addTrack(s)}else s=e.cameraVideoStream.getAudioTracks()[0]}if(!e.cameraVideoStream)return console.log("av-c","can not getUserMedia"),void e.callSession.endCall(u.default.REASON_MediaError)}if(s=e.cameraVideoStream.getAudioTracks()[0],!s&&!e.callSession.audioOnly){console.warn("do not have audioTrack, create local audio track");let t=yield e.callSession.createLocalCameraVideoStream(!0,!1);t&&(s=t.getAudioTracks()[0])}if(s.enabled=!e.callSession.audioMuted,s.onended=function(){e.callSession.status!==l.default.STATUS_IDLE&&(console.log("av-c","audio track ended, re-createMediaSenders"),e.callSession.audioInputDeviceId=null,e.stopVideoTrack(e.cameraVideoStream),e.cameraVideoStream=null,e.createMediaSenders())},e.cameraVideoStream.getVideoTracks().length>0){e.cameraVideoStream.getVideoTracks()[0].onended=function(){console.log("av-c","video track ended"),e.callSession.endCall(u.default.REASON_MediaError)}}e.soundMeter&&(e.soundMeter.stop(),e.soundMeter=null);let t=new f.SoundMeter(window.audioContext);try{t.connectToSource(e.cameraVideoStream,(function(e){console.log("av-c","connect to self soundMeter",e)}))}catch(e){console.error(e)}e.soundMeter=t;let o=e.peerConnection;if(o){let t=e.cameraVideoStream;if(e.callSession.audioOnly)e.audioSender?(e.audioSender.track.stop(),yield e.audioSender.replaceTrack(s)):e.audioSender=o.addTrack(s,t);else if(e.audioSender?(e.audioSender.track.stop(),yield e.audioSender.replaceTrack(s)):e.audioSender=o.addTrack(s,t),console.log("av-c","createMediaSenders -1",e.callSession.audioOnly,e.callSession.videoMuted,t,t.getVideoTracks().length),t&&t.getVideoTracks().length>0&&t.getVideoTracks()[0]){let s=h.default.getVideoProfile(m.default.VIDEO_PROFILE);if(m.default.SCREEN_SHARING_REPLACE_MODE&&e.callSession.isScreenSharing())e.setVideoMaxBitrate(s.bitrate);else{let r=new MediaStream([t.getVideoTracks()[0]]),i=t;if(e.callSession.rotateAng&&e.callSession.sessionCallback.onRotateStream&&(i=e.callSession.sessionCallback.onRotateStream(r,e.callSession.rotateAng),console.log("av-c","rotatedStream",i?i.getVideoTracks().length:"no videoTrack"),e.callSession.sessionCallback.didRotateLocalVideoTrack&&(i.addTrack(e.cameraVideoStream.getAudioTracks()[0]),e.callSession.sessionCallback.didRotateLocalVideoTrack(i))),e.videoSender?(console.log("av-c","pc replace video track",i.getVideoTracks()[0]),yield e.videoSender.replaceTrack(i.getVideoTracks()[0])):(console.log("av-c","pc add video track",i.getVideoTracks()[0]),e.videoSender=o.addTrack(i.getVideoTracks()[0])),!m.default.DISABLE_DUAL_STREAM){let s;if(console.log("av-c","to add small stream"),e.callSession.rotateAng&&e.callSession.sessionCallback.onRotateStream){let t=e.callSession.sessionCallback.onRotateStream(r,e.callSession.rotateAng,{width:200,height:200});s=t.getVideoTracks()[0],console.log("av-c","small rotatedStream",t?t.getVideoTracks().length:"no videoTrack")}else s=t.getVideoTracks()[0].clone();e.smallCameraVideoTrack=s,e.smallVideoSender?(console.log("av-c","pc small replace video track",s),yield e.smallVideoSender.replaceTrack(s)):(console.log("av-c","pc small add video track",s),e.smallVideoSender=o.addTrack(s))}e.setVideoMaxBitrate(s.bitrate)}}e.callSession.videoMuted&&(console.log("av-c","videoMuted, stopVideoTrack"),e.stopVideoTrack(e.cameraVideoStream)),e.callSession.audioMuted&&(console.log("av-c","audioMuted, stopAudioTrack"),e.stopAudioTrack(e.cameraVideoStream)),console.log("av-c","Added local stream to pc")}}))()}publishMedia(e=!1){var s=this;return(0,a.default)((function*(){e||(s.peerConnection=s.callSession.createPeerConnection(s.callSession.selfUserInfo.uid),console.log("av-c","enable data channel",m.default.ENABLE_DATA_CHANNEL),m.default.ENABLE_DATA_CHANNEL&&(s.dataChannel=s.peerConnection.createDataChannel("data_channel",{ordered:!0}),s.dataChannel.onerror=function(e){console.log("av-c","data channel error",e)}),yield s.createMediaSenders());try{let t=yield s.peerConnection.createOffer(e?s.callSession.restartPublishConstrains():s.callSession.defaultPublishMediaConstraints());console.log("av-c","publishMedia offer, m=video index",t.sdp.indexOf("m=video")),yield s.peerConnection.setLocalDescription(t);let o={};o.session_id=s.callSession.sessionId,o.handle_id=s.handleId;let i={request:"configure",audio:!0,video:!0};i.pin=s.callSession.pin,o.body=i;let a={};return a.sdp=t.sdp,a.type="offer",o.jsep=a,new(n())((function(e,t){d.default.sendConferenceRequest(s.callSession.sessionId,s.callSession.callId,"message",r()(o),(function(t,o){if(0!==t)return console.log("av-c","conference request, message, error",t),void e();let r=JSON.parse(o);if(s.callSession.sessionId!==r.session_id)return console.log("av-c","conference request, message unknown sessionId",s.sessionId,r.session_id),void e();let i=r.jsep;if(i&&"answer"===i.type)s.peerConnection&&s.peerConnection.setRemoteDescription(i),s.callSession.notifyMuteState();else{let e=r.plugindata;if(e){let t=e.data;if(t){t.error_code===c.default.JANUS_VIDEOROOM_ERROR_PUBLISHERS_FULL?s.callSession.endCall(u.default.RoomParticipantsFull):s.callSession.endCall(u.default.REASON_SignalError)}}}e()}))}))}catch(e){console.error("av-c","publish media error",e),s.callSession.endCall(u.default.REASON_MediaError)}}))()}unPublishMedia(){var e=this;return(0,a.default)((function*(){if(e.stopVideoStream(e.cameraVideoStream),e.soundMeter){try{e.soundMeter.stop()}catch(e){}e.soundMeter=null}e.peerConnection&&(e.peerConnection.close(),e.peerConnection=null,e.audioSender=null,e.videoSender=null,e.smallVideoSender=null);let s={};return s.handle_id=e.handleId,s.pin=e.callSession.pin,new(n())((function(t,o){d.default.sendConferenceRequest(e.callSession.sessionId,e.callSession.callId,"unpublish",r()(s),(function(s,o){s>0&&e.callSession.endCall(u.default.REASON_SignalError),t()}))}))}))()}rotate(e){var s=this;return(0,a.default)((function*(){if(s.callSession.rotateAng!==e&&(s.callSession.rotateAng=e,!s.callSession.videoMuted&&s.cameraVideoStream&&s.cameraVideoStream.getVideoTracks().length>0&&s.cameraVideoStream.getVideoTracks()[0]&&s.callSession.sessionCallback.onRotateStream)){let t=new MediaStream([s.cameraVideoStream.getVideoTracks()[0]]),o=s.callSession.sessionCallback.onRotateStream(t,e);if(s.callSession.sessionCallback.didRotateLocalVideoTrack&&s.callSession.sessionCallback.didRotateLocalVideoTrack(new MediaStream([o.getVideoTracks()[0],s.cameraVideoStream.getAudioTracks()[0]])),s.videoSender&&s.videoSender.replaceTrack(o.getVideoTracks()[0]),s.smallVideoSender){let o=s.callSession.sessionCallback.onRotateStream(t,e,{width:200,height:200});s.smallVideoSender.replaceTrack(o.getVideoTracks()[0])}}}))()}endMedia(){if(this.peerConnection&&(this.peerConnection.close(),this.peerConnection=null),this.stopVideoStream(this.cameraVideoStream),this.stopVideoStream(this.callSession.screenShareStream),this.callSession.smallScreenShareVideoTrack&&(console.log("av-c","stop smallScreenShareVideoTrack"),this.callSession.smallScreenShareVideoTrack.stop()),this.soundMeter){try{this.soundMeter.stop()}catch(e){}this.soundMeter=null}this.cameraVideoStream=null,this.audioSender=null,this.videoSender=null,this.smallVideoSender=null}tinyVideoTrackConstraints(e){let s=m.default.SMALL_STREAM_WIDTH?m.default.SMALL_STREAM_WIDTH:200,t=m.default.SMALL_STREAM_HEIGHT?m.default.SMALL_STREAM_HEIGHT:200,o={width:{ideal:s,max:s},height:{ideal:t,max:t}};m.default.DISABLE_SMALL_STREAM_LOW_FPS?m.default.SMALL_STREAM_FPS&&(o.frameRate={ideal:m.default.SMALL_STREAM_FPS,max:m.default.SMALL_STREAM_FPS}):o.frameRate={max:8,ideal:8};let r=e.getCapabilities();return r.frameRate.max<o.frameRate.max&&delete o.frameRate,r.height.max<o.height.max&&delete o.height,r.width.max<o.width.max&&delete o.width,o}setVideoMaxBitrate(e){let s=e;this.videoSender&&this.setVideoSenderMaxBitrate(this.videoSender,s),this.smallVideoSender&&this.setVideoSenderMaxBitrate(this.smallVideoSender,160)}setVideoSenderMaxBitrate(e,s){const t=e.getParameters();t.encodings&&0!==t.encodings.length||(t.encodings=[{}]),t.encodings.length<1?console.error("av-c","setVideoSenderMaxBitrate error: no encodings"):(t.encodings[0].maxBitrate=1e3*s,e.setParameters(t).catch(e=>{console.error("av-c","set maxBitrate error",e)}))}scaleVideoResolutionDownBy(e){console.log("av-c","scaleVideoResolutionDownBy",e),this.videoSender&&this.scaleVideoSenderVideoResolutionDownBy(this.videoSender,e),this.smallVideoSender&&this.scaleVideoSenderVideoResolutionDownBy(this.smallVideoSender,e)}scaleVideoSenderVideoResolutionDownBy(e,s){const t=e.getParameters();t.encodings||(t.encodings=[{}]),t.encodings.length<1?console.log("av-c","scaleVideoResolutionDownBy error: no encodings"):(t.encodings[0].scaleResolutionDownBy=s,e.setParameters(t).catch(e=>{console.log("av-c","set scaleVideoResolutionDownBy error",e)}))}stopVideoTrack(e){console.log("av-c","stopVideoTrack"),e&&e.getTracks().forEach(e=>{"video"===e.kind&&e.stop()}),this.smallCameraVideoTrack&&(console.log("stop smallVideo track",this.smallCameraVideoTrack),this.smallCameraVideoTrack.stop())}stopAudioTrack(e){console.log("av-c","stopAudioTrack"),e&&e.getTracks().forEach(e=>{"audio"===e.kind&&(e.enabled=!1)})}stopVideoStream(e){e&&(void 0===e.getTracks?e.stop():e.getTracks().forEach(e=>{console.log("av-c","stop track",e.kind,e.id),e.stop()}),this.smallCameraVideoTrack&&(console.log("stop smallVideo track",this.smallCameraVideoTrack),this.smallCameraVideoTrack.stop()))}restartICE(){this.peerConnection&&(console.log("av-c","restart publish ice"),this.publishMedia(!0))}}},"./av/internal/roomErrorCode.js":(e,s,t)=>{t.r(s),t.d(s,{default:()=>o});class o{}o.JANUS_VIDEOROOM_ERROR_UNKNOWN_ERROR=499,o.JANUS_VIDEOROOM_ERROR_NO_MESSAGE=421,o.JANUS_VIDEOROOM_ERROR_INVALID_JSON=422,o.JANUS_VIDEOROOM_ERROR_INVALID_REQUEST=423,o.JANUS_VIDEOROOM_ERROR_JOIN_FIRST=424,o.JANUS_VIDEOROOM_ERROR_ALREADY_JOINED=425,o.JANUS_VIDEOROOM_ERROR_NO_SUCH_ROOM=426,o.JANUS_VIDEOROOM_ERROR_ROOM_EXISTS=427,o.JANUS_VIDEOROOM_ERROR_NO_SUCH_FEED=428,o.JANUS_VIDEOROOM_ERROR_MISSING_ELEMENT=429,o.JANUS_VIDEOROOM_ERROR_INVALID_ELEMENT=430,o.JANUS_VIDEOROOM_ERROR_INVALID_SDP_TYPE=431,o.JANUS_VIDEOROOM_ERROR_PUBLISHERS_FULL=432,o.JANUS_VIDEOROOM_ERROR_UNAUTHORIZED=433,o.JANUS_VIDEOROOM_ERROR_ALREADY_PUBLISHED=434,o.JANUS_VIDEOROOM_ERROR_NOT_PUBLISHED=435,o.JANUS_VIDEOROOM_ERROR_ID_EXISTS=436,o.JANUS_VIDEOROOM_ERROR_INVALID_SDP=437},"./av/internal/screenSharingPublisherImpl.js":(e,s,t)=>{t.r(s),t.d(s,{default:()=>h});var o=t("./node_modules/babel-runtime/core-js/json/stringify.js"),r=t.n(o),i=t("./node_modules/babel-runtime/helpers/asyncToGenerator.js"),n=t("../engine/videoProfile"),a=t("../engine/avenginekit"),l=t("./av/internal/publisherImpl.js"),d=t("./av/internal/avenginekitImpl.js"),c=t("./av/internal/roomErrorCode.js"),u=t("../engine/callEndReason"),m=t("../engine/callState");class h extends l.default{constructor(e){super(e)}createMediaSenders(){var e=this;return(0,i.default)((function*(){let s=e.peerConnection,t=e.callSession.screenShareStream;e.cameraVideoStream=t;let o=t;if(e.callSession.rotateAng&&e.callSession.sessionCallback.onRotateStream&&(o=e.callSession.sessionCallback.onRotateStream(e.cameraVideoStream,e.callSession.rotateAng),e.callSession.sessionCallback.didRotateLocalVideoTrack&&e.callSession.sessionCallback.didRotateLocalVideoTrack(new MediaStream([o.getVideoTracks()[0]]))),e.videoSender=s.addTrack(o.getVideoTracks()[0]),!a.default.DISABLE_DUAL_STREAM){if(e.callSession.rotateAng&&e.callSession.sessionCallback.onRotateStream){let s=e.callSession.sessionCallback.onRotateStream(e.cameraVideoStream,e.callSession.rotateAng,{width:200,height:200});e.smallCameraVideoTrack=s.getVideoTracks()[0]}else e.smallCameraVideoTrack=t.getVideoTracks()[0].clone();e.smallVideoSender=s.addTrack(e.smallCameraVideoTrack),console.log("av-c","screen sharing small video track added",e.smallCameraVideoTrack.label)}if(a.default.SCREEN_SHARE_MAX_BITRATE)e.setVideoMaxBitrate(a.default.SCREEN_SHARE_MAX_BITRATE);else{let s=n.default.getVideoProfile(a.default.VIDEO_PROFILE);e.setVideoMaxBitrate(s.bitrate)}}))()}attachAndPublishScreenSharing(){let e={};e.session_id=this.callSession.sessionId,e.handle_id=this.handleId,e.user_id=this.callSession.screenSharingId(),e.pin=this.callSession.pin,this.callSession.callExtra&&(e.extra=this.callSession.callExtra),d.default.sendConferenceRequest(this.callSession.sessionId,this.callSession.callId,"join_pub_ss",r()(e),(e,s)=>{if(0!==e)return void console.log("av-c","conference request, join_pub_ss, error",e);let t=JSON.parse(s);this.handleId=t.handle_id;let o=t.data.error_code;o>0?o===c.default.JANUS_VIDEOROOM_ERROR_NO_SUCH_ROOM?this.callSession.endCall(u.default.RoomNotExist):e===c.default.JANUS_VIDEOROOM_ERROR_ID_EXISTS?this.reattachAndPublish():this.callSession.endCall(u.default.REASON_SignalError):this.publishMedia()})}reattachAndPublish(){setTimeout(()=>{this.callSession.status!==m.default.STATUS_IDLE&&this.attachAndPublishScreenSharing()},5e3)}deattach(){let e={};e.session_id=this.callSession.sessionId,e.handle_id=this.handleId,e.pin=this.callSession.pin,d.default.sendConferenceRequest(this.callSession.sessionId,this.callSession.callId,"deattach",r()(e),(e,s)=>{0!==e&&(console.log("av-c","conference request, ss-deattach, error",e),this.callSession.endCall(u.default.REASON_SignalError))})}}},"./av/internal/soundMeter.js":(e,s,t)=>{function o(e){this.context=e,this.instant=0,this.slow=0,this.clip=0,this.script=e.createScriptProcessor(2048,1,1);const s=this;this.script.onaudioprocess=function(e){const t=e.inputBuffer.getChannelData(0);let o,r=0,i=0;for(o=0;o<t.length;++o)r+=t[o]*t[o],Math.abs(t[o])>.99&&(i+=1);s.instant=Math.sqrt(r/t.length),s.slow=.95*s.slow+.05*s.instant,s.clip=i/t.length}}t.r(s),t.d(s,{SoundMeter:()=>o}),o.prototype.connectToSource=function(e,s){console.log("av-c","SoundMeter connecting");try{this.mic=this.context.createMediaStreamSource(e),this.mic.connect(this.script),this.script.connect(this.context.destination),void 0!==s&&s(null)}catch(e){console.error("av-c",e),void 0!==s&&s(e)}},o.prototype.stop=function(){console.log("av-c","SoundMeter stopping"),this.mic.disconnect(),this.script.disconnect()}},"./av/internal/subscriberImpl.js":(e,s,t)=>{t.r(s),t.d(s,{default:()=>c});var o=t("./node_modules/babel-runtime/helpers/asyncToGenerator.js"),r=t("./node_modules/babel-runtime/core-js/json/stringify.js"),i=t.n(r),n=t("../engine/subscriber"),a=t("./av/internal/avenginekitImpl.js"),l=t("../engine/avenginekit"),d=t("../engine/videoType");class c extends n.default{constructor(e,s){super(),this.tickSinceLastFramesDecoded=0,this.availableVideoMids=[],this.availableAudioMids=[],this.availableDataMids=[],this.ready=!1,this.subscribedVideoMid="",this.userId=e,this.callSession=s,this.availableVideoMids=[],this.availableAudioMids=[],this.availableDataMids=[],this.videoType=s.defaultVideoType,this.currentVideoType=this.videoType}subscribe(){if(this.handleId)return;this.ready=!1;let e={};e.feed=this.userId,e.pin=this.callSession.pin;let s=[];this.availableAudioMids.length>0&&s.push({feed:this.userId,mid:this.availableAudioMids[0]}),this.availableDataMids.length>0&&s.push({feed:this.userId,mid:this.availableDataMids[0]}),this.callSession.audioOnly||(this.availableVideoMids.length>1?0===this.availableAudioMids.length?(console.log("av-c","subscribe screen share stream",this.videoType),this.videoType===d.default.BIG_STREAM?s.push({feed:this.userId,mid:this.availableVideoMids[0]}):(this.videoType=d.default.SMALL_STREAM,this.currentVideoType=d.default.SMALL_STREAM,s.push({feed:this.userId,mid:this.availableVideoMids[1]}))):this.videoType===d.default.BIG_STREAM?s.push({feed:this.userId,mid:this.availableVideoMids[0]}):this.videoType===d.default.SMALL_STREAM&&s.push({feed:this.userId,mid:this.availableVideoMids[1]}):1===this.availableVideoMids.length&&s.push({feed:this.userId,mid:this.availableVideoMids[0]})),e.streams=s,console.log("xxxxxxx av-c subscribe",this.userId,s),a.default.sendConferenceRequestEx(this.callSession.sessionId,this.callSession.callId,"join_sub",i()(e),this.callSession.advance,(e,s)=>{if(0!==e)return void console.log("av-c","join_sub error",e);let t=JSON.parse(s),o=t.session_id;if(o!==this.callSession.sessionId)return void console.log("av-c","join response, unknown sessionId",this.callSession.sessionId,o);this.handleId=t.handle_id;let r=t.jsep;console.log("av-c","call subscribeMedia",r),this.parseSubscribedVideoMid(t),this.subscribeMedia(r)})}subscribeMedia(e){var s=this;return(0,o.default)((function*(){if(console.log("av-c","subscribeMedia",e),e){s.peerConnection||(yield s.callSession.createPeerConnection(s.userId),console.log("av-c","enable data channel",l.default.ENABLE_DATA_CHANNEL),l.default.ENABLE_DATA_CHANNEL&&(s.peerConnection.createDataChannel("data_channel",{ordered:!0}),console.log("av-c","listen data channel"),s.peerConnection.ondatachannel=function(e){console.log("av-c","on data channel ",e.channel.label,e),s.dataChannel=e.channel,s.dataChannel.onmessage=function(e){console.log("av-c","data channel on message",e.data),s.callSession.onDataChannelMessage(s.userId,e.data)}}));try{l.default.FORCE_MEDIA_OVER_TCP&&(e.sdp=e.sdp.replaceAll(/a=candidate:\d+ \d+ udp.*\r\n?/gm,""),console.log("av-c","subscribeMedia force tcp",e.sdp)),yield s.peerConnection.setRemoteDescription(e);let t=yield s.peerConnection.createAnswer(s.callSession.defaultSubscribeMediaConstraints());yield s.peerConnection.setLocalDescription(t);let o={};o.session_id=s.callSession.sessionId,o.handle_id=s.handleId;let r={request:"start"};r.room=s.callSession.callId,o.body=r;let n={};n.sdp=t.sdp,n.type="answer",o.jsep=n,a.default.sendConferenceRequestEx(s.callSession.sessionId,s.callSession.callId,"message",i()(o),s.callSession.advance,(function(e,t){0===e?s.setReady(!0):console.log("av-c","conference request, message error",e)}))}catch(e){console.log("av-c","subscribeMedia error",s.userId,e)}}}))()}streams(e){e&&(this.availableVideoMids.length=0,this.availableAudioMids.length=0,console.log("av-c","streams",this.userId,e),e.forEach(e=>{if("video"===e.type){let s=e.mid;this.availableVideoMids.push(s)}else if("audio"===e.type){let s=e.mid;this.availableAudioMids.push(s)}else if("data"===e.type){let s=e.mid;this.availableDataMids.push(s)}}))}subscribeStream(e,s){let t={handle_id:this.handleId,feed:this.userId};e&&(t.subscribe=[{feed:this.userId,mid:e}]),s&&(this.callSession.getScreenSharingUserId(this.userId)?t.unsubscribe=[{feed:this.userId}]:t.unsubscribe=[{feed:this.userId,mid:s}]),console.log("av-c","update request",t),a.default.sendConferenceRequestEx(this.callSession.sessionId,this.callSession.callId,"update",i()(t),this.callSession.advance,(e,s)=>{if(0!==e)return void console.log("av-c","conference request, message error",e);console.log("av-c","subscribe stream response",t);let o=JSON.parse(s),r=o.jsep;this.parseSubscribedVideoMid(o),r&&this.subscribeMedia(r)})}switchTo(e){let s={handle_id:this.handleId,feed:this.userId};s.streams=[{feed:this.userId,mid:e,sub_mid:this.callSession.getScreenSharingUserId(this.userId)?"0":this.subscribedVideoMid}],console.log("av-c","wfc switch request",s),a.default.sendConferenceRequestEx(this.callSession.sessionId,this.callSession.callId,"switch",i()(s),this.callSession.advance,(e,s)=>{0!==e?console.log("av-c","wfc conference switch request, message error",e):this.setReady(!0)})}setReady(e){this.ready=e,e&&this.setVideoType(this.videoType)}setVideoType(e){if(console.log("av-c","av setVideoType",this.userId,this.videoType,this.currentVideoType,e),(this.videoType!==e||this.currentVideoType!==e)&&!this.callSession.audioOnly&&0!==this.availableVideoMids.length&&(1!==this.availableVideoMids.length||e!==d.default.SMALL_STREAM)&&(this.videoType=e,this.handleId&&this.ready))if(this.setReady(!1),this.currentVideoType!==e)if(console.log("av-c","av setVideoType to",this.userId,e),this.currentVideoType===d.default.NONE){let s=e===d.default.BIG_STREAM?this.availableVideoMids[0]:this.availableVideoMids[1];this.subscribeStream(s,null),this.currentVideoType=e}else if(e===d.default.NONE){let s=this.currentVideoType===d.default.BIG_STREAM?this.availableVideoMids[0]:this.availableVideoMids[1];this.subscribeStream(null,s),this.currentVideoType=e}else{let s=e===d.default.BIG_STREAM?this.availableVideoMids[0]:this.availableVideoMids[1];this.currentVideoType=e,this.switchTo(s)}else this.setReady(!0)}restartICE(){if(this.audience||!this.peerConnection)return;console.log("av-c","restart subscribe ice");let e={handle_id:this.handleId};a.default.sendConferenceRequestEx(this.callSession.sessionId,this.callSession.callId,"restart_ice",i()(e),this.callSession.advance,(e,s)=>{if(0!==e)return void console.log("av-c","restart ice error",e);let t=JSON.parse(s),o=t.jsep;console.log("av-c","call subscribeMedia",o),this.parseSubscribedVideoMid(t),this.subscribeMedia(o)})}parseSubscribedVideoMid(e){if(!e)return;let s=e.data;if(s){let e=s.streams;if(e&&e.length>0)for(let s=0;s<e.length;s++){let t=e[s];if(t&&"video"===t.type){let e=t.mid;console.log("av-c","parseSubscribedVideoMid "+e),this.subscribedVideoMid=e;break}}}}}},"./node_modules/babel-runtime/core-js/json/stringify.js":(e,s,t)=>{e.exports={default:t("./node_modules/core-js/library/fn/json/stringify.js"),__esModule:!0}},"./node_modules/babel-runtime/core-js/map.js":(e,s,t)=>{e.exports={default:t("./node_modules/core-js/library/fn/map.js"),__esModule:!0}},"./node_modules/babel-runtime/core-js/object/assign.js":(e,s,t)=>{e.exports={default:t("./node_modules/core-js/library/fn/object/assign.js"),__esModule:!0}},"./node_modules/babel-runtime/core-js/object/keys.js":(e,s,t)=>{e.exports={default:t("./node_modules/core-js/library/fn/object/keys.js"),__esModule:!0}},"./node_modules/babel-runtime/core-js/promise.js":(e,s,t)=>{e.exports={default:t("./node_modules/core-js/library/fn/promise.js"),__esModule:!0}},"./node_modules/babel-runtime/helpers/asyncToGenerator.js":(e,s,t)=>{s.__esModule=!0;var o,r=t("./node_modules/babel-runtime/core-js/promise.js"),i=(o=r)&&o.__esModule?o:{default:o};s.default=function(e){return function(){var s=e.apply(this,arguments);return new i.default((function(e,t){return function o(r,n){try{var a=s[r](n),l=a.value}catch(e){return void t(e)}if(!a.done)return i.default.resolve(l).then((function(e){o("next",e)}),(function(e){o("throw",e)}));e(l)}("next")}))}}},"./node_modules/babel-runtime/helpers/extends.js":(e,s,t)=>{s.__esModule=!0;var o,r=t("./node_modules/babel-runtime/core-js/object/assign.js"),i=(o=r)&&o.__esModule?o:{default:o};s.default=i.default||function(e){for(var s=1;s<arguments.length;s++){var t=arguments[s];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e}},"./node_modules/core-js/library/fn/json/stringify.js":(e,s,t)=>{var o=t("./node_modules/core-js/library/modules/_core.js"),r=o.JSON||(o.JSON={stringify:JSON.stringify});e.exports=function(e){return r.stringify.apply(r,arguments)}},"./node_modules/core-js/library/fn/map.js":(e,s,t)=>{t("./node_modules/core-js/library/modules/es6.object.to-string.js"),t("./node_modules/core-js/library/modules/es6.string.iterator.js"),t("./node_modules/core-js/library/modules/web.dom.iterable.js"),t("./node_modules/core-js/library/modules/es6.map.js"),t("./node_modules/core-js/library/modules/es7.map.to-json.js"),t("./node_modules/core-js/library/modules/es7.map.of.js"),t("./node_modules/core-js/library/modules/es7.map.from.js"),e.exports=t("./node_modules/core-js/library/modules/_core.js").Map},"./node_modules/core-js/library/fn/object/assign.js":(e,s,t)=>{t("./node_modules/core-js/library/modules/es6.object.assign.js"),e.exports=t("./node_modules/core-js/library/modules/_core.js").Object.assign},"./node_modules/core-js/library/fn/object/keys.js":(e,s,t)=>{t("./node_modules/core-js/library/modules/es6.object.keys.js"),e.exports=t("./node_modules/core-js/library/modules/_core.js").Object.keys},"./node_modules/core-js/library/fn/promise.js":(e,s,t)=>{t("./node_modules/core-js/library/modules/es6.object.to-string.js"),t("./node_modules/core-js/library/modules/es6.string.iterator.js"),t("./node_modules/core-js/library/modules/web.dom.iterable.js"),t("./node_modules/core-js/library/modules/es6.promise.js"),t("./node_modules/core-js/library/modules/es7.promise.finally.js"),t("./node_modules/core-js/library/modules/es7.promise.try.js"),e.exports=t("./node_modules/core-js/library/modules/_core.js").Promise},"./node_modules/core-js/library/modules/_a-function.js":e=>{e.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},"./node_modules/core-js/library/modules/_add-to-unscopables.js":e=>{e.exports=function(){}},"./node_modules/core-js/library/modules/_an-instance.js":e=>{e.exports=function(e,s,t,o){if(!(e instanceof s)||void 0!==o&&o in e)throw TypeError(t+": incorrect invocation!");return e}},"./node_modules/core-js/library/modules/_an-object.js":(e,s,t)=>{var o=t("./node_modules/core-js/library/modules/_is-object.js");e.exports=function(e){if(!o(e))throw TypeError(e+" is not an object!");return e}},"./node_modules/core-js/library/modules/_array-from-iterable.js":(e,s,t)=>{var o=t("./node_modules/core-js/library/modules/_for-of.js");e.exports=function(e,s){var t=[];return o(e,!1,t.push,t,s),t}},"./node_modules/core-js/library/modules/_array-includes.js":(e,s,t)=>{var o=t("./node_modules/core-js/library/modules/_to-iobject.js"),r=t("./node_modules/core-js/library/modules/_to-length.js"),i=t("./node_modules/core-js/library/modules/_to-absolute-index.js");e.exports=function(e){return function(s,t,n){var a,l=o(s),d=r(l.length),c=i(n,d);if(e&&t!=t){for(;d>c;)if((a=l[c++])!=a)return!0}else for(;d>c;c++)if((e||c in l)&&l[c]===t)return e||c||0;return!e&&-1}}},"./node_modules/core-js/library/modules/_array-methods.js":(e,s,t)=>{var o=t("./node_modules/core-js/library/modules/_ctx.js"),r=t("./node_modules/core-js/library/modules/_iobject.js"),i=t("./node_modules/core-js/library/modules/_to-object.js"),n=t("./node_modules/core-js/library/modules/_to-length.js"),a=t("./node_modules/core-js/library/modules/_array-species-create.js");e.exports=function(e,s){var t=1==e,l=2==e,d=3==e,c=4==e,u=6==e,m=5==e||u,h=s||a;return function(s,a,f){for(var _,p,S=i(s),b=r(S),g=o(a,f,3),j=n(b.length),v=0,y=t?h(s,j):l?h(s,0):void 0;j>v;v++)if((m||v in b)&&(p=g(_=b[v],v,S),e))if(t)y[v]=p;else if(p)switch(e){case 3:return!0;case 5:return _;case 6:return v;case 2:y.push(_)}else if(c)return!1;return u?-1:d||c?c:y}}},"./node_modules/core-js/library/modules/_array-species-constructor.js":(e,s,t)=>{var o=t("./node_modules/core-js/library/modules/_is-object.js"),r=t("./node_modules/core-js/library/modules/_is-array.js"),i=t("./node_modules/core-js/library/modules/_wks.js")("species");e.exports=function(e){var s;return r(e)&&("function"!=typeof(s=e.constructor)||s!==Array&&!r(s.prototype)||(s=void 0),o(s)&&null===(s=s[i])&&(s=void 0)),void 0===s?Array:s}},"./node_modules/core-js/library/modules/_array-species-create.js":(e,s,t)=>{var o=t("./node_modules/core-js/library/modules/_array-species-constructor.js");e.exports=function(e,s){return new(o(e))(s)}},"./node_modules/core-js/library/modules/_classof.js":(e,s,t)=>{var o=t("./node_modules/core-js/library/modules/_cof.js"),r=t("./node_modules/core-js/library/modules/_wks.js")("toStringTag"),i="Arguments"==o(function(){return arguments}());e.exports=function(e){var s,t,n;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(t=function(e,s){try{return e[s]}catch(e){}}(s=Object(e),r))?t:i?o(s):"Object"==(n=o(s))&&"function"==typeof s.callee?"Arguments":n}},"./node_modules/core-js/library/modules/_cof.js":e=>{var s={}.toString;e.exports=function(e){return s.call(e).slice(8,-1)}},"./node_modules/core-js/library/modules/_collection-strong.js":(e,s,t)=>{var o=t("./node_modules/core-js/library/modules/_object-dp.js").f,r=t("./node_modules/core-js/library/modules/_object-create.js"),i=t("./node_modules/core-js/library/modules/_redefine-all.js"),n=t("./node_modules/core-js/library/modules/_ctx.js"),a=t("./node_modules/core-js/library/modules/_an-instance.js"),l=t("./node_modules/core-js/library/modules/_for-of.js"),d=t("./node_modules/core-js/library/modules/_iter-define.js"),c=t("./node_modules/core-js/library/modules/_iter-step.js"),u=t("./node_modules/core-js/library/modules/_set-species.js"),m=t("./node_modules/core-js/library/modules/_descriptors.js"),h=t("./node_modules/core-js/library/modules/_meta.js").fastKey,f=t("./node_modules/core-js/library/modules/_validate-collection.js"),_=m?"_s":"size",p=function(e,s){var t,o=h(s);if("F"!==o)return e._i[o];for(t=e._f;t;t=t.n)if(t.k==s)return t};e.exports={getConstructor:function(e,s,t,d){var c=e((function(e,o){a(e,c,s,"_i"),e._t=s,e._i=r(null),e._f=void 0,e._l=void 0,e[_]=0,null!=o&&l(o,t,e[d],e)}));return i(c.prototype,{clear:function(){for(var e=f(this,s),t=e._i,o=e._f;o;o=o.n)o.r=!0,o.p&&(o.p=o.p.n=void 0),delete t[o.i];e._f=e._l=void 0,e[_]=0},delete:function(e){var t=f(this,s),o=p(t,e);if(o){var r=o.n,i=o.p;delete t._i[o.i],o.r=!0,i&&(i.n=r),r&&(r.p=i),t._f==o&&(t._f=r),t._l==o&&(t._l=i),t[_]--}return!!o},forEach:function(e){f(this,s);for(var t,o=n(e,arguments.length>1?arguments[1]:void 0,3);t=t?t.n:this._f;)for(o(t.v,t.k,this);t&&t.r;)t=t.p},has:function(e){return!!p(f(this,s),e)}}),m&&o(c.prototype,"size",{get:function(){return f(this,s)[_]}}),c},def:function(e,s,t){var o,r,i=p(e,s);return i?i.v=t:(e._l=i={i:r=h(s,!0),k:s,v:t,p:o=e._l,n:void 0,r:!1},e._f||(e._f=i),o&&(o.n=i),e[_]++,"F"!==r&&(e._i[r]=i)),e},getEntry:p,setStrong:function(e,s,t){d(e,s,(function(e,t){this._t=f(e,s),this._k=t,this._l=void 0}),(function(){for(var e=this._k,s=this._l;s&&s.r;)s=s.p;return this._t&&(this._l=s=s?s.n:this._t._f)?c(0,"keys"==e?s.k:"values"==e?s.v:[s.k,s.v]):(this._t=void 0,c(1))}),t?"entries":"values",!t,!0),u(s)}}},"./node_modules/core-js/library/modules/_collection-to-json.js":(e,s,t)=>{var o=t("./node_modules/core-js/library/modules/_classof.js"),r=t("./node_modules/core-js/library/modules/_array-from-iterable.js");e.exports=function(e){return function(){if(o(this)!=e)throw TypeError(e+"#toJSON isn't generic");return r(this)}}},"./node_modules/core-js/library/modules/_collection.js":(e,s,t)=>{var o=t("./node_modules/core-js/library/modules/_global.js"),r=t("./node_modules/core-js/library/modules/_export.js"),i=t("./node_modules/core-js/library/modules/_meta.js"),n=t("./node_modules/core-js/library/modules/_fails.js"),a=t("./node_modules/core-js/library/modules/_hide.js"),l=t("./node_modules/core-js/library/modules/_redefine-all.js"),d=t("./node_modules/core-js/library/modules/_for-of.js"),c=t("./node_modules/core-js/library/modules/_an-instance.js"),u=t("./node_modules/core-js/library/modules/_is-object.js"),m=t("./node_modules/core-js/library/modules/_set-to-string-tag.js"),h=t("./node_modules/core-js/library/modules/_object-dp.js").f,f=t("./node_modules/core-js/library/modules/_array-methods.js")(0),_=t("./node_modules/core-js/library/modules/_descriptors.js");e.exports=function(e,s,t,p,S,b){var g=o[e],j=g,v=S?"set":"add",y=j&&j.prototype,C={};return _&&"function"==typeof j&&(b||y.forEach&&!n((function(){(new j).entries().next()})))?(j=s((function(s,t){c(s,j,e,"_c"),s._c=new g,null!=t&&d(t,S,s[v],s)})),f("add,clear,delete,forEach,get,has,set,keys,values,entries,toJSON".split(","),(function(e){var s="add"==e||"set"==e;e in y&&(!b||"clear"!=e)&&a(j.prototype,e,(function(t,o){if(c(this,j,e),!s&&b&&!u(t))return"get"==e&&void 0;var r=this._c[e](0===t?0:t,o);return s?this:r}))})),b||h(j.prototype,"size",{get:function(){return this._c.size}})):(j=p.getConstructor(s,e,S,v),l(j.prototype,t),i.NEED=!0),m(j,e),C[e]=j,r(r.G+r.W+r.F,C),b||p.setStrong(j,e,S),j}},"./node_modules/core-js/library/modules/_core.js":e=>{var s=e.exports={version:"2.6.10"};"number"==typeof __e&&(__e=s)},"./node_modules/core-js/library/modules/_ctx.js":(e,s,t)=>{var o=t("./node_modules/core-js/library/modules/_a-function.js");e.exports=function(e,s,t){if(o(e),void 0===s)return e;switch(t){case 1:return function(t){return e.call(s,t)};case 2:return function(t,o){return e.call(s,t,o)};case 3:return function(t,o,r){return e.call(s,t,o,r)}}return function(){return e.apply(s,arguments)}}},"./node_modules/core-js/library/modules/_defined.js":e=>{e.exports=function(e){if(null==e)throw TypeError("Can't call method on  "+e);return e}},"./node_modules/core-js/library/modules/_descriptors.js":(e,s,t)=>{e.exports=!t("./node_modules/core-js/library/modules/_fails.js")((function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}))},"./node_modules/core-js/library/modules/_dom-create.js":(e,s,t)=>{var o=t("./node_modules/core-js/library/modules/_is-object.js"),r=t("./node_modules/core-js/library/modules/_global.js").document,i=o(r)&&o(r.createElement);e.exports=function(e){return i?r.createElement(e):{}}},"./node_modules/core-js/library/modules/_enum-bug-keys.js":e=>{e.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},"./node_modules/core-js/library/modules/_export.js":(e,s,t)=>{var o=t("./node_modules/core-js/library/modules/_global.js"),r=t("./node_modules/core-js/library/modules/_core.js"),i=t("./node_modules/core-js/library/modules/_ctx.js"),n=t("./node_modules/core-js/library/modules/_hide.js"),a=t("./node_modules/core-js/library/modules/_has.js"),l=function(e,s,t){var d,c,u,m=e&l.F,h=e&l.G,f=e&l.S,_=e&l.P,p=e&l.B,S=e&l.W,b=h?r:r[s]||(r[s]={}),g=b.prototype,j=h?o:f?o[s]:(o[s]||{}).prototype;for(d in h&&(t=s),t)(c=!m&&j&&void 0!==j[d])&&a(b,d)||(u=c?j[d]:t[d],b[d]=h&&"function"!=typeof j[d]?t[d]:p&&c?i(u,o):S&&j[d]==u?function(e){var s=function(s,t,o){if(this instanceof e){switch(arguments.length){case 0:return new e;case 1:return new e(s);case 2:return new e(s,t)}return new e(s,t,o)}return e.apply(this,arguments)};return s.prototype=e.prototype,s}(u):_&&"function"==typeof u?i(Function.call,u):u,_&&((b.virtual||(b.virtual={}))[d]=u,e&l.R&&g&&!g[d]&&n(g,d,u)))};l.F=1,l.G=2,l.S=4,l.P=8,l.B=16,l.W=32,l.U=64,l.R=128,e.exports=l},"./node_modules/core-js/library/modules/_fails.js":e=>{e.exports=function(e){try{return!!e()}catch(e){return!0}}},"./node_modules/core-js/library/modules/_for-of.js":(e,s,t)=>{var o=t("./node_modules/core-js/library/modules/_ctx.js"),r=t("./node_modules/core-js/library/modules/_iter-call.js"),i=t("./node_modules/core-js/library/modules/_is-array-iter.js"),n=t("./node_modules/core-js/library/modules/_an-object.js"),a=t("./node_modules/core-js/library/modules/_to-length.js"),l=t("./node_modules/core-js/library/modules/core.get-iterator-method.js"),d={},c={},u=e.exports=function(e,s,t,u,m){var h,f,_,p,S=m?function(){return e}:l(e),b=o(t,u,s?2:1),g=0;if("function"!=typeof S)throw TypeError(e+" is not iterable!");if(i(S)){for(h=a(e.length);h>g;g++)if((p=s?b(n(f=e[g])[0],f[1]):b(e[g]))===d||p===c)return p}else for(_=S.call(e);!(f=_.next()).done;)if((p=r(_,b,f.value,s))===d||p===c)return p};u.BREAK=d,u.RETURN=c},"./node_modules/core-js/library/modules/_global.js":e=>{var s=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=s)},"./node_modules/core-js/library/modules/_has.js":e=>{var s={}.hasOwnProperty;e.exports=function(e,t){return s.call(e,t)}},"./node_modules/core-js/library/modules/_hide.js":(e,s,t)=>{var o=t("./node_modules/core-js/library/modules/_object-dp.js"),r=t("./node_modules/core-js/library/modules/_property-desc.js");e.exports=t("./node_modules/core-js/library/modules/_descriptors.js")?function(e,s,t){return o.f(e,s,r(1,t))}:function(e,s,t){return e[s]=t,e}},"./node_modules/core-js/library/modules/_html.js":(e,s,t)=>{var o=t("./node_modules/core-js/library/modules/_global.js").document;e.exports=o&&o.documentElement},"./node_modules/core-js/library/modules/_ie8-dom-define.js":(e,s,t)=>{e.exports=!t("./node_modules/core-js/library/modules/_descriptors.js")&&!t("./node_modules/core-js/library/modules/_fails.js")((function(){return 7!=Object.defineProperty(t("./node_modules/core-js/library/modules/_dom-create.js")("div"),"a",{get:function(){return 7}}).a}))},"./node_modules/core-js/library/modules/_invoke.js":e=>{e.exports=function(e,s,t){var o=void 0===t;switch(s.length){case 0:return o?e():e.call(t);case 1:return o?e(s[0]):e.call(t,s[0]);case 2:return o?e(s[0],s[1]):e.call(t,s[0],s[1]);case 3:return o?e(s[0],s[1],s[2]):e.call(t,s[0],s[1],s[2]);case 4:return o?e(s[0],s[1],s[2],s[3]):e.call(t,s[0],s[1],s[2],s[3])}return e.apply(t,s)}},"./node_modules/core-js/library/modules/_iobject.js":(e,s,t)=>{var o=t("./node_modules/core-js/library/modules/_cof.js");e.exports=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==o(e)?e.split(""):Object(e)}},"./node_modules/core-js/library/modules/_is-array-iter.js":(e,s,t)=>{var o=t("./node_modules/core-js/library/modules/_iterators.js"),r=t("./node_modules/core-js/library/modules/_wks.js")("iterator"),i=Array.prototype;e.exports=function(e){return void 0!==e&&(o.Array===e||i[r]===e)}},"./node_modules/core-js/library/modules/_is-array.js":(e,s,t)=>{var o=t("./node_modules/core-js/library/modules/_cof.js");e.exports=Array.isArray||function(e){return"Array"==o(e)}},"./node_modules/core-js/library/modules/_is-object.js":e=>{e.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}},"./node_modules/core-js/library/modules/_iter-call.js":(e,s,t)=>{var o=t("./node_modules/core-js/library/modules/_an-object.js");e.exports=function(e,s,t,r){try{return r?s(o(t)[0],t[1]):s(t)}catch(s){var i=e.return;throw void 0!==i&&o(i.call(e)),s}}},"./node_modules/core-js/library/modules/_iter-create.js":(e,s,t)=>{var o=t("./node_modules/core-js/library/modules/_object-create.js"),r=t("./node_modules/core-js/library/modules/_property-desc.js"),i=t("./node_modules/core-js/library/modules/_set-to-string-tag.js"),n={};t("./node_modules/core-js/library/modules/_hide.js")(n,t("./node_modules/core-js/library/modules/_wks.js")("iterator"),(function(){return this})),e.exports=function(e,s,t){e.prototype=o(n,{next:r(1,t)}),i(e,s+" Iterator")}},"./node_modules/core-js/library/modules/_iter-define.js":(e,s,t)=>{var o=t("./node_modules/core-js/library/modules/_library.js"),r=t("./node_modules/core-js/library/modules/_export.js"),i=t("./node_modules/core-js/library/modules/_redefine.js"),n=t("./node_modules/core-js/library/modules/_hide.js"),a=t("./node_modules/core-js/library/modules/_iterators.js"),l=t("./node_modules/core-js/library/modules/_iter-create.js"),d=t("./node_modules/core-js/library/modules/_set-to-string-tag.js"),c=t("./node_modules/core-js/library/modules/_object-gpo.js"),u=t("./node_modules/core-js/library/modules/_wks.js")("iterator"),m=!([].keys&&"next"in[].keys()),h=function(){return this};e.exports=function(e,s,t,f,_,p,S){l(t,s,f);var b,g,j,v=function(e){if(!m&&e in I)return I[e];switch(e){case"keys":case"values":return function(){return new t(this,e)}}return function(){return new t(this,e)}},y=s+" Iterator",C="values"==_,T=!1,I=e.prototype,E=I[u]||I["@@iterator"]||_&&I[_],M=E||v(_),O=_?C?v("entries"):M:void 0,R="Array"==s&&I.entries||E;if(R&&(j=c(R.call(new e)))!==Object.prototype&&j.next&&(d(j,y,!0),o||"function"==typeof j[u]||n(j,u,h)),C&&E&&"values"!==E.name&&(T=!0,M=function(){return E.call(this)}),o&&!S||!m&&!T&&I[u]||n(I,u,M),a[s]=M,a[y]=h,_)if(b={values:C?M:v("values"),keys:p?M:v("keys"),entries:O},S)for(g in b)g in I||i(I,g,b[g]);else r(r.P+r.F*(m||T),s,b);return b}},"./node_modules/core-js/library/modules/_iter-detect.js":(e,s,t)=>{var o=t("./node_modules/core-js/library/modules/_wks.js")("iterator"),r=!1;try{var i=[7][o]();i.return=function(){r=!0},Array.from(i,(function(){throw 2}))}catch(e){}e.exports=function(e,s){if(!s&&!r)return!1;var t=!1;try{var i=[7],n=i[o]();n.next=function(){return{done:t=!0}},i[o]=function(){return n},e(i)}catch(e){}return t}},"./node_modules/core-js/library/modules/_iter-step.js":e=>{e.exports=function(e,s){return{value:s,done:!!e}}},"./node_modules/core-js/library/modules/_iterators.js":e=>{e.exports={}},"./node_modules/core-js/library/modules/_library.js":e=>{e.exports=!0},"./node_modules/core-js/library/modules/_meta.js":(e,s,t)=>{var o=t("./node_modules/core-js/library/modules/_uid.js")("meta"),r=t("./node_modules/core-js/library/modules/_is-object.js"),i=t("./node_modules/core-js/library/modules/_has.js"),n=t("./node_modules/core-js/library/modules/_object-dp.js").f,a=0,l=Object.isExtensible||function(){return!0},d=!t("./node_modules/core-js/library/modules/_fails.js")((function(){return l(Object.preventExtensions({}))})),c=function(e){n(e,o,{value:{i:"O"+ ++a,w:{}}})},u=e.exports={KEY:o,NEED:!1,fastKey:function(e,s){if(!r(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!i(e,o)){if(!l(e))return"F";if(!s)return"E";c(e)}return e[o].i},getWeak:function(e,s){if(!i(e,o)){if(!l(e))return!0;if(!s)return!1;c(e)}return e[o].w},onFreeze:function(e){return d&&u.NEED&&l(e)&&!i(e,o)&&c(e),e}}},"./node_modules/core-js/library/modules/_microtask.js":(e,s,t)=>{var o=t("./node_modules/core-js/library/modules/_global.js"),r=t("./node_modules/core-js/library/modules/_task.js").set,i=o.MutationObserver||o.WebKitMutationObserver,n=o.process,a=o.Promise,l="process"==t("./node_modules/core-js/library/modules/_cof.js")(n);e.exports=function(){var e,s,t,d=function(){var o,r;for(l&&(o=n.domain)&&o.exit();e;){r=e.fn,e=e.next;try{r()}catch(o){throw e?t():s=void 0,o}}s=void 0,o&&o.enter()};if(l)t=function(){n.nextTick(d)};else if(!i||o.navigator&&o.navigator.standalone)if(a&&a.resolve){var c=a.resolve(void 0);t=function(){c.then(d)}}else t=function(){r.call(o,d)};else{var u=!0,m=document.createTextNode("");new i(d).observe(m,{characterData:!0}),t=function(){m.data=u=!u}}return function(o){var r={fn:o,next:void 0};s&&(s.next=r),e||(e=r,t()),s=r}}},"./node_modules/core-js/library/modules/_new-promise-capability.js":(e,s,t)=>{var o=t("./node_modules/core-js/library/modules/_a-function.js");function r(e){var s,t;this.promise=new e((function(e,o){if(void 0!==s||void 0!==t)throw TypeError("Bad Promise constructor");s=e,t=o})),this.resolve=o(s),this.reject=o(t)}e.exports.f=function(e){return new r(e)}},"./node_modules/core-js/library/modules/_object-assign.js":(e,s,t)=>{var o=t("./node_modules/core-js/library/modules/_descriptors.js"),r=t("./node_modules/core-js/library/modules/_object-keys.js"),i=t("./node_modules/core-js/library/modules/_object-gops.js"),n=t("./node_modules/core-js/library/modules/_object-pie.js"),a=t("./node_modules/core-js/library/modules/_to-object.js"),l=t("./node_modules/core-js/library/modules/_iobject.js"),d=Object.assign;e.exports=!d||t("./node_modules/core-js/library/modules/_fails.js")((function(){var e={},s={},t=Symbol(),o="abcdefghijklmnopqrst";return e[t]=7,o.split("").forEach((function(e){s[e]=e})),7!=d({},e)[t]||Object.keys(d({},s)).join("")!=o}))?function(e,s){for(var t=a(e),d=arguments.length,c=1,u=i.f,m=n.f;d>c;)for(var h,f=l(arguments[c++]),_=u?r(f).concat(u(f)):r(f),p=_.length,S=0;p>S;)h=_[S++],o&&!m.call(f,h)||(t[h]=f[h]);return t}:d},"./node_modules/core-js/library/modules/_object-create.js":(e,s,t)=>{var o=t("./node_modules/core-js/library/modules/_an-object.js"),r=t("./node_modules/core-js/library/modules/_object-dps.js"),i=t("./node_modules/core-js/library/modules/_enum-bug-keys.js"),n=t("./node_modules/core-js/library/modules/_shared-key.js")("IE_PROTO"),a=function(){},l=function(){var e,s=t("./node_modules/core-js/library/modules/_dom-create.js")("iframe"),o=i.length;for(s.style.display="none",t("./node_modules/core-js/library/modules/_html.js").appendChild(s),s.src="javascript:",(e=s.contentWindow.document).open(),e.write("<script>document.F=Object<\/script>"),e.close(),l=e.F;o--;)delete l.prototype[i[o]];return l()};e.exports=Object.create||function(e,s){var t;return null!==e?(a.prototype=o(e),t=new a,a.prototype=null,t[n]=e):t=l(),void 0===s?t:r(t,s)}},"./node_modules/core-js/library/modules/_object-dp.js":(e,s,t)=>{var o=t("./node_modules/core-js/library/modules/_an-object.js"),r=t("./node_modules/core-js/library/modules/_ie8-dom-define.js"),i=t("./node_modules/core-js/library/modules/_to-primitive.js"),n=Object.defineProperty;s.f=t("./node_modules/core-js/library/modules/_descriptors.js")?Object.defineProperty:function(e,s,t){if(o(e),s=i(s,!0),o(t),r)try{return n(e,s,t)}catch(e){}if("get"in t||"set"in t)throw TypeError("Accessors not supported!");return"value"in t&&(e[s]=t.value),e}},"./node_modules/core-js/library/modules/_object-dps.js":(e,s,t)=>{var o=t("./node_modules/core-js/library/modules/_object-dp.js"),r=t("./node_modules/core-js/library/modules/_an-object.js"),i=t("./node_modules/core-js/library/modules/_object-keys.js");e.exports=t("./node_modules/core-js/library/modules/_descriptors.js")?Object.defineProperties:function(e,s){r(e);for(var t,n=i(s),a=n.length,l=0;a>l;)o.f(e,t=n[l++],s[t]);return e}},"./node_modules/core-js/library/modules/_object-gops.js":(e,s)=>{s.f=Object.getOwnPropertySymbols},"./node_modules/core-js/library/modules/_object-gpo.js":(e,s,t)=>{var o=t("./node_modules/core-js/library/modules/_has.js"),r=t("./node_modules/core-js/library/modules/_to-object.js"),i=t("./node_modules/core-js/library/modules/_shared-key.js")("IE_PROTO"),n=Object.prototype;e.exports=Object.getPrototypeOf||function(e){return e=r(e),o(e,i)?e[i]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?n:null}},"./node_modules/core-js/library/modules/_object-keys-internal.js":(e,s,t)=>{var o=t("./node_modules/core-js/library/modules/_has.js"),r=t("./node_modules/core-js/library/modules/_to-iobject.js"),i=t("./node_modules/core-js/library/modules/_array-includes.js")(!1),n=t("./node_modules/core-js/library/modules/_shared-key.js")("IE_PROTO");e.exports=function(e,s){var t,a=r(e),l=0,d=[];for(t in a)t!=n&&o(a,t)&&d.push(t);for(;s.length>l;)o(a,t=s[l++])&&(~i(d,t)||d.push(t));return d}},"./node_modules/core-js/library/modules/_object-keys.js":(e,s,t)=>{var o=t("./node_modules/core-js/library/modules/_object-keys-internal.js"),r=t("./node_modules/core-js/library/modules/_enum-bug-keys.js");e.exports=Object.keys||function(e){return o(e,r)}},"./node_modules/core-js/library/modules/_object-pie.js":(e,s)=>{s.f={}.propertyIsEnumerable},"./node_modules/core-js/library/modules/_object-sap.js":(e,s,t)=>{var o=t("./node_modules/core-js/library/modules/_export.js"),r=t("./node_modules/core-js/library/modules/_core.js"),i=t("./node_modules/core-js/library/modules/_fails.js");e.exports=function(e,s){var t=(r.Object||{})[e]||Object[e],n={};n[e]=s(t),o(o.S+o.F*i((function(){t(1)})),"Object",n)}},"./node_modules/core-js/library/modules/_perform.js":e=>{e.exports=function(e){try{return{e:!1,v:e()}}catch(e){return{e:!0,v:e}}}},"./node_modules/core-js/library/modules/_promise-resolve.js":(e,s,t)=>{var o=t("./node_modules/core-js/library/modules/_an-object.js"),r=t("./node_modules/core-js/library/modules/_is-object.js"),i=t("./node_modules/core-js/library/modules/_new-promise-capability.js");e.exports=function(e,s){if(o(e),r(s)&&s.constructor===e)return s;var t=i.f(e);return(0,t.resolve)(s),t.promise}},"./node_modules/core-js/library/modules/_property-desc.js":e=>{e.exports=function(e,s){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:s}}},"./node_modules/core-js/library/modules/_redefine-all.js":(e,s,t)=>{var o=t("./node_modules/core-js/library/modules/_hide.js");e.exports=function(e,s,t){for(var r in s)t&&e[r]?e[r]=s[r]:o(e,r,s[r]);return e}},"./node_modules/core-js/library/modules/_redefine.js":(e,s,t)=>{e.exports=t("./node_modules/core-js/library/modules/_hide.js")},"./node_modules/core-js/library/modules/_set-collection-from.js":(e,s,t)=>{var o=t("./node_modules/core-js/library/modules/_export.js"),r=t("./node_modules/core-js/library/modules/_a-function.js"),i=t("./node_modules/core-js/library/modules/_ctx.js"),n=t("./node_modules/core-js/library/modules/_for-of.js");e.exports=function(e){o(o.S,e,{from:function(e){var s,t,o,a,l=arguments[1];return r(this),(s=void 0!==l)&&r(l),null==e?new this:(t=[],s?(o=0,a=i(l,arguments[2],2),n(e,!1,(function(e){t.push(a(e,o++))}))):n(e,!1,t.push,t),new this(t))}})}},"./node_modules/core-js/library/modules/_set-collection-of.js":(e,s,t)=>{var o=t("./node_modules/core-js/library/modules/_export.js");e.exports=function(e){o(o.S,e,{of:function(){for(var e=arguments.length,s=new Array(e);e--;)s[e]=arguments[e];return new this(s)}})}},"./node_modules/core-js/library/modules/_set-species.js":(e,s,t)=>{var o=t("./node_modules/core-js/library/modules/_global.js"),r=t("./node_modules/core-js/library/modules/_core.js"),i=t("./node_modules/core-js/library/modules/_object-dp.js"),n=t("./node_modules/core-js/library/modules/_descriptors.js"),a=t("./node_modules/core-js/library/modules/_wks.js")("species");e.exports=function(e){var s="function"==typeof r[e]?r[e]:o[e];n&&s&&!s[a]&&i.f(s,a,{configurable:!0,get:function(){return this}})}},"./node_modules/core-js/library/modules/_set-to-string-tag.js":(e,s,t)=>{var o=t("./node_modules/core-js/library/modules/_object-dp.js").f,r=t("./node_modules/core-js/library/modules/_has.js"),i=t("./node_modules/core-js/library/modules/_wks.js")("toStringTag");e.exports=function(e,s,t){e&&!r(e=t?e:e.prototype,i)&&o(e,i,{configurable:!0,value:s})}},"./node_modules/core-js/library/modules/_shared-key.js":(e,s,t)=>{var o=t("./node_modules/core-js/library/modules/_shared.js")("keys"),r=t("./node_modules/core-js/library/modules/_uid.js");e.exports=function(e){return o[e]||(o[e]=r(e))}},"./node_modules/core-js/library/modules/_shared.js":(e,s,t)=>{var o=t("./node_modules/core-js/library/modules/_core.js"),r=t("./node_modules/core-js/library/modules/_global.js"),i=r["__core-js_shared__"]||(r["__core-js_shared__"]={});(e.exports=function(e,s){return i[e]||(i[e]=void 0!==s?s:{})})("versions",[]).push({version:o.version,mode:t("./node_modules/core-js/library/modules/_library.js")?"pure":"global",copyright:"© 2019 Denis Pushkarev (zloirock.ru)"})},"./node_modules/core-js/library/modules/_species-constructor.js":(e,s,t)=>{var o=t("./node_modules/core-js/library/modules/_an-object.js"),r=t("./node_modules/core-js/library/modules/_a-function.js"),i=t("./node_modules/core-js/library/modules/_wks.js")("species");e.exports=function(e,s){var t,n=o(e).constructor;return void 0===n||null==(t=o(n)[i])?s:r(t)}},"./node_modules/core-js/library/modules/_string-at.js":(e,s,t)=>{var o=t("./node_modules/core-js/library/modules/_to-integer.js"),r=t("./node_modules/core-js/library/modules/_defined.js");e.exports=function(e){return function(s,t){var i,n,a=String(r(s)),l=o(t),d=a.length;return l<0||l>=d?e?"":void 0:(i=a.charCodeAt(l))<55296||i>56319||l+1===d||(n=a.charCodeAt(l+1))<56320||n>57343?e?a.charAt(l):i:e?a.slice(l,l+2):n-56320+(i-55296<<10)+65536}}},"./node_modules/core-js/library/modules/_task.js":(e,s,t)=>{var o,r,i,n=t("./node_modules/core-js/library/modules/_ctx.js"),a=t("./node_modules/core-js/library/modules/_invoke.js"),l=t("./node_modules/core-js/library/modules/_html.js"),d=t("./node_modules/core-js/library/modules/_dom-create.js"),c=t("./node_modules/core-js/library/modules/_global.js"),u=c.process,m=c.setImmediate,h=c.clearImmediate,f=c.MessageChannel,_=c.Dispatch,p=0,S={},b=function(){var e=+this;if(S.hasOwnProperty(e)){var s=S[e];delete S[e],s()}},g=function(e){b.call(e.data)};m&&h||(m=function(e){for(var s=[],t=1;arguments.length>t;)s.push(arguments[t++]);return S[++p]=function(){a("function"==typeof e?e:Function(e),s)},o(p),p},h=function(e){delete S[e]},"process"==t("./node_modules/core-js/library/modules/_cof.js")(u)?o=function(e){u.nextTick(n(b,e,1))}:_&&_.now?o=function(e){_.now(n(b,e,1))}:f?(i=(r=new f).port2,r.port1.onmessage=g,o=n(i.postMessage,i,1)):c.addEventListener&&"function"==typeof postMessage&&!c.importScripts?(o=function(e){c.postMessage(e+"","*")},c.addEventListener("message",g,!1)):o="onreadystatechange"in d("script")?function(e){l.appendChild(d("script")).onreadystatechange=function(){l.removeChild(this),b.call(e)}}:function(e){setTimeout(n(b,e,1),0)}),e.exports={set:m,clear:h}},"./node_modules/core-js/library/modules/_to-absolute-index.js":(e,s,t)=>{var o=t("./node_modules/core-js/library/modules/_to-integer.js"),r=Math.max,i=Math.min;e.exports=function(e,s){return(e=o(e))<0?r(e+s,0):i(e,s)}},"./node_modules/core-js/library/modules/_to-integer.js":e=>{var s=Math.ceil,t=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(e>0?t:s)(e)}},"./node_modules/core-js/library/modules/_to-iobject.js":(e,s,t)=>{var o=t("./node_modules/core-js/library/modules/_iobject.js"),r=t("./node_modules/core-js/library/modules/_defined.js");e.exports=function(e){return o(r(e))}},"./node_modules/core-js/library/modules/_to-length.js":(e,s,t)=>{var o=t("./node_modules/core-js/library/modules/_to-integer.js"),r=Math.min;e.exports=function(e){return e>0?r(o(e),9007199254740991):0}},"./node_modules/core-js/library/modules/_to-object.js":(e,s,t)=>{var o=t("./node_modules/core-js/library/modules/_defined.js");e.exports=function(e){return Object(o(e))}},"./node_modules/core-js/library/modules/_to-primitive.js":(e,s,t)=>{var o=t("./node_modules/core-js/library/modules/_is-object.js");e.exports=function(e,s){if(!o(e))return e;var t,r;if(s&&"function"==typeof(t=e.toString)&&!o(r=t.call(e)))return r;if("function"==typeof(t=e.valueOf)&&!o(r=t.call(e)))return r;if(!s&&"function"==typeof(t=e.toString)&&!o(r=t.call(e)))return r;throw TypeError("Can't convert object to primitive value")}},"./node_modules/core-js/library/modules/_uid.js":e=>{var s=0,t=Math.random();e.exports=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++s+t).toString(36))}},"./node_modules/core-js/library/modules/_user-agent.js":(e,s,t)=>{var o=t("./node_modules/core-js/library/modules/_global.js").navigator;e.exports=o&&o.userAgent||""},"./node_modules/core-js/library/modules/_validate-collection.js":(e,s,t)=>{var o=t("./node_modules/core-js/library/modules/_is-object.js");e.exports=function(e,s){if(!o(e)||e._t!==s)throw TypeError("Incompatible receiver, "+s+" required!");return e}},"./node_modules/core-js/library/modules/_wks.js":(e,s,t)=>{var o=t("./node_modules/core-js/library/modules/_shared.js")("wks"),r=t("./node_modules/core-js/library/modules/_uid.js"),i=t("./node_modules/core-js/library/modules/_global.js").Symbol,n="function"==typeof i;(e.exports=function(e){return o[e]||(o[e]=n&&i[e]||(n?i:r)("Symbol."+e))}).store=o},"./node_modules/core-js/library/modules/core.get-iterator-method.js":(e,s,t)=>{var o=t("./node_modules/core-js/library/modules/_classof.js"),r=t("./node_modules/core-js/library/modules/_wks.js")("iterator"),i=t("./node_modules/core-js/library/modules/_iterators.js");e.exports=t("./node_modules/core-js/library/modules/_core.js").getIteratorMethod=function(e){if(null!=e)return e[r]||e["@@iterator"]||i[o(e)]}},"./node_modules/core-js/library/modules/es6.array.iterator.js":(e,s,t)=>{var o=t("./node_modules/core-js/library/modules/_add-to-unscopables.js"),r=t("./node_modules/core-js/library/modules/_iter-step.js"),i=t("./node_modules/core-js/library/modules/_iterators.js"),n=t("./node_modules/core-js/library/modules/_to-iobject.js");e.exports=t("./node_modules/core-js/library/modules/_iter-define.js")(Array,"Array",(function(e,s){this._t=n(e),this._i=0,this._k=s}),(function(){var e=this._t,s=this._k,t=this._i++;return!e||t>=e.length?(this._t=void 0,r(1)):r(0,"keys"==s?t:"values"==s?e[t]:[t,e[t]])}),"values"),i.Arguments=i.Array,o("keys"),o("values"),o("entries")},"./node_modules/core-js/library/modules/es6.map.js":(e,s,t)=>{var o=t("./node_modules/core-js/library/modules/_collection-strong.js"),r=t("./node_modules/core-js/library/modules/_validate-collection.js");e.exports=t("./node_modules/core-js/library/modules/_collection.js")("Map",(function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}}),{get:function(e){var s=o.getEntry(r(this,"Map"),e);return s&&s.v},set:function(e,s){return o.def(r(this,"Map"),0===e?0:e,s)}},o,!0)},"./node_modules/core-js/library/modules/es6.object.assign.js":(e,s,t)=>{var o=t("./node_modules/core-js/library/modules/_export.js");o(o.S+o.F,"Object",{assign:t("./node_modules/core-js/library/modules/_object-assign.js")})},"./node_modules/core-js/library/modules/es6.object.keys.js":(e,s,t)=>{var o=t("./node_modules/core-js/library/modules/_to-object.js"),r=t("./node_modules/core-js/library/modules/_object-keys.js");t("./node_modules/core-js/library/modules/_object-sap.js")("keys",(function(){return function(e){return r(o(e))}}))},"./node_modules/core-js/library/modules/es6.object.to-string.js":()=>{},"./node_modules/core-js/library/modules/es6.promise.js":(e,s,t)=>{var o,r,i,n,a=t("./node_modules/core-js/library/modules/_library.js"),l=t("./node_modules/core-js/library/modules/_global.js"),d=t("./node_modules/core-js/library/modules/_ctx.js"),c=t("./node_modules/core-js/library/modules/_classof.js"),u=t("./node_modules/core-js/library/modules/_export.js"),m=t("./node_modules/core-js/library/modules/_is-object.js"),h=t("./node_modules/core-js/library/modules/_a-function.js"),f=t("./node_modules/core-js/library/modules/_an-instance.js"),_=t("./node_modules/core-js/library/modules/_for-of.js"),p=t("./node_modules/core-js/library/modules/_species-constructor.js"),S=t("./node_modules/core-js/library/modules/_task.js").set,b=t("./node_modules/core-js/library/modules/_microtask.js")(),g=t("./node_modules/core-js/library/modules/_new-promise-capability.js"),j=t("./node_modules/core-js/library/modules/_perform.js"),v=t("./node_modules/core-js/library/modules/_user-agent.js"),y=t("./node_modules/core-js/library/modules/_promise-resolve.js"),C=l.TypeError,T=l.process,I=T&&T.versions,E=I&&I.v8||"",M=l.Promise,O="process"==c(T),R=function(){},A=r=g.f,k=!!function(){try{var e=M.resolve(1),s=(e.constructor={})[t("./node_modules/core-js/library/modules/_wks.js")("species")]=function(e){e(R,R)};return(O||"function"==typeof PromiseRejectionEvent)&&e.then(R)instanceof s&&0!==E.indexOf("6.6")&&-1===v.indexOf("Chrome/66")}catch(e){}}(),V=function(e){var s;return!(!m(e)||"function"!=typeof(s=e.then))&&s},N=function(e,s){if(!e._n){e._n=!0;var t=e._c;b((function(){for(var o=e._v,r=1==e._s,i=0,n=function(s){var t,i,n,a=r?s.ok:s.fail,l=s.resolve,d=s.reject,c=s.domain;try{a?(r||(2==e._h&&w(e),e._h=1),!0===a?t=o:(c&&c.enter(),t=a(o),c&&(c.exit(),n=!0)),t===s.promise?d(C("Promise-chain cycle")):(i=V(t))?i.call(t,l,d):l(t)):d(o)}catch(e){c&&!n&&c.exit(),d(e)}};t.length>i;)n(t[i++]);e._c=[],e._n=!1,s&&!e._h&&P(e)}))}},P=function(e){S.call(l,(function(){var s,t,o,r=e._v,i=x(e);if(i&&(s=j((function(){O?T.emit("unhandledRejection",r,e):(t=l.onunhandledrejection)?t({promise:e,reason:r}):(o=l.console)&&o.error&&o.error("Unhandled promise rejection",r)})),e._h=O||x(e)?2:1),e._a=void 0,i&&s.e)throw s.v}))},x=function(e){return 1!==e._h&&0===(e._a||e._c).length},w=function(e){S.call(l,(function(){var s;O?T.emit("rejectionHandled",e):(s=l.onrejectionhandled)&&s({promise:e,reason:e._v})}))},U=function(e){var s=this;s._d||(s._d=!0,(s=s._w||s)._v=e,s._s=2,s._a||(s._a=s._c.slice()),N(s,!0))},D=function(e){var s,t=this;if(!t._d){t._d=!0,t=t._w||t;try{if(t===e)throw C("Promise can't be resolved itself");(s=V(e))?b((function(){var o={_w:t,_d:!1};try{s.call(e,d(D,o,1),d(U,o,1))}catch(e){U.call(o,e)}})):(t._v=e,t._s=1,N(t,!1))}catch(e){U.call({_w:t,_d:!1},e)}}};k||(M=function(e){f(this,M,"Promise","_h"),h(e),o.call(this);try{e(d(D,this,1),d(U,this,1))}catch(e){U.call(this,e)}},(o=function(e){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1}).prototype=t("./node_modules/core-js/library/modules/_redefine-all.js")(M.prototype,{then:function(e,s){var t=A(p(this,M));return t.ok="function"!=typeof e||e,t.fail="function"==typeof s&&s,t.domain=O?T.domain:void 0,this._c.push(t),this._a&&this._a.push(t),this._s&&N(this,!1),t.promise},catch:function(e){return this.then(void 0,e)}}),i=function(){var e=new o;this.promise=e,this.resolve=d(D,e,1),this.reject=d(U,e,1)},g.f=A=function(e){return e===M||e===n?new i(e):r(e)}),u(u.G+u.W+u.F*!k,{Promise:M}),t("./node_modules/core-js/library/modules/_set-to-string-tag.js")(M,"Promise"),t("./node_modules/core-js/library/modules/_set-species.js")("Promise"),n=t("./node_modules/core-js/library/modules/_core.js").Promise,u(u.S+u.F*!k,"Promise",{reject:function(e){var s=A(this);return(0,s.reject)(e),s.promise}}),u(u.S+u.F*(a||!k),"Promise",{resolve:function(e){return y(a&&this===n?M:this,e)}}),u(u.S+u.F*!(k&&t("./node_modules/core-js/library/modules/_iter-detect.js")((function(e){M.all(e).catch(R)}))),"Promise",{all:function(e){var s=this,t=A(s),o=t.resolve,r=t.reject,i=j((function(){var t=[],i=0,n=1;_(e,!1,(function(e){var a=i++,l=!1;t.push(void 0),n++,s.resolve(e).then((function(e){l||(l=!0,t[a]=e,--n||o(t))}),r)})),--n||o(t)}));return i.e&&r(i.v),t.promise},race:function(e){var s=this,t=A(s),o=t.reject,r=j((function(){_(e,!1,(function(e){s.resolve(e).then(t.resolve,o)}))}));return r.e&&o(r.v),t.promise}})},"./node_modules/core-js/library/modules/es6.string.iterator.js":(e,s,t)=>{var o=t("./node_modules/core-js/library/modules/_string-at.js")(!0);t("./node_modules/core-js/library/modules/_iter-define.js")(String,"String",(function(e){this._t=String(e),this._i=0}),(function(){var e,s=this._t,t=this._i;return t>=s.length?{value:void 0,done:!0}:(e=o(s,t),this._i+=e.length,{value:e,done:!1})}))},"./node_modules/core-js/library/modules/es7.map.from.js":(e,s,t)=>{t("./node_modules/core-js/library/modules/_set-collection-from.js")("Map")},"./node_modules/core-js/library/modules/es7.map.of.js":(e,s,t)=>{t("./node_modules/core-js/library/modules/_set-collection-of.js")("Map")},"./node_modules/core-js/library/modules/es7.map.to-json.js":(e,s,t)=>{var o=t("./node_modules/core-js/library/modules/_export.js");o(o.P+o.R,"Map",{toJSON:t("./node_modules/core-js/library/modules/_collection-to-json.js")("Map")})},"./node_modules/core-js/library/modules/es7.promise.finally.js":(e,s,t)=>{var o=t("./node_modules/core-js/library/modules/_export.js"),r=t("./node_modules/core-js/library/modules/_core.js"),i=t("./node_modules/core-js/library/modules/_global.js"),n=t("./node_modules/core-js/library/modules/_species-constructor.js"),a=t("./node_modules/core-js/library/modules/_promise-resolve.js");o(o.P+o.R,"Promise",{finally:function(e){var s=n(this,r.Promise||i.Promise),t="function"==typeof e;return this.then(t?function(t){return a(s,e()).then((function(){return t}))}:e,t?function(t){return a(s,e()).then((function(){throw t}))}:e)}})},"./node_modules/core-js/library/modules/es7.promise.try.js":(e,s,t)=>{var o=t("./node_modules/core-js/library/modules/_export.js"),r=t("./node_modules/core-js/library/modules/_new-promise-capability.js"),i=t("./node_modules/core-js/library/modules/_perform.js");o(o.S,"Promise",{try:function(e){var s=r.f(this),t=i(e);return(t.e?s.reject:s.resolve)(t.v),s.promise}})},"./node_modules/core-js/library/modules/web.dom.iterable.js":(e,s,t)=>{t("./node_modules/core-js/library/modules/es6.array.iterator.js");for(var o=t("./node_modules/core-js/library/modules/_global.js"),r=t("./node_modules/core-js/library/modules/_hide.js"),i=t("./node_modules/core-js/library/modules/_iterators.js"),n=t("./node_modules/core-js/library/modules/_wks.js")("toStringTag"),a="CSSRuleList,CSSStyleDeclaration,CSSValueList,ClientRectList,DOMRectList,DOMStringList,DOMTokenList,DataTransferItemList,FileList,HTMLAllCollection,HTMLCollection,HTMLFormElement,HTMLSelectElement,MediaList,MimeTypeArray,NamedNodeMap,NodeList,PaintRequestList,Plugin,PluginArray,SVGLengthList,SVGNumberList,SVGPathSegList,SVGPointList,SVGStringList,SVGTransformList,SourceBufferList,StyleSheetList,TextTrackCueList,TextTrackList,TouchList".split(","),l=0;l<a.length;l++){var d=a[l],c=o[d],u=c&&c.prototype;u&&!u[n]&&r(u,n,d),i[d]=i.Array}},"../../../config.js":s=>{s.exports=e},"../../../platform.js":e=>{e.exports=s},"../../messages/messageContentType":e=>{e.exports=t},"../../model/conversation":e=>{e.exports=o},"../../model/conversationType":e=>{e.exports=r},"../../model/nullUserInfo":e=>{e.exports=i},"../../util/longUtil.js":e=>{e.exports=n},"../engine/avenginekit":e=>{e.exports=a},"../engine/avenginekitproxy":e=>{e.exports=l},"../engine/callEndReason":e=>{e.exports=d},"../engine/callSession":e=>{e.exports=c},"../engine/callState":e=>{e.exports=u},"../engine/participantProfile":e=>{e.exports=m},"../engine/rcEndReason":e=>{e.exports=h},"../engine/rcState":e=>{e.exports=f},"../engine/subscriber":e=>{e.exports=_},"../engine/videoProfile":e=>{e.exports=p},"../engine/videoType":e=>{e.exports=S},"../messages/addParticipantsMessageContent":e=>{e.exports=b},"../messages/callAnswerMessageContent":e=>{e.exports=g},"../messages/callByeMessageContent":e=>{e.exports=j},"../messages/callModifyMessageContent":e=>{e.exports=v},"../messages/callStartMessageContent":e=>{e.exports=y},"../messages/conferenceChangeModeContent":e=>{e.exports=C},"../messages/muteVideoMessageContent":e=>{e.exports=T},"../messages/rcAcceptInviteMessageContent":e=>{e.exports=I},"../messages/rcEndMessageContent":e=>{e.exports=E},"../messages/rcInviteMessageContent":e=>{e.exports=M},"../messages/rcRequestMessageContent":e=>{e.exports=O}},A={};function k(e){var s=A[e];if(void 0!==s)return s.exports;var t=A[e]={exports:{}};return R[e](t,t.exports,k),t.exports}k.n=e=>{var s=e&&e.__esModule?()=>e.default:()=>e;return k.d(s,{a:s}),s},k.d=(e,s)=>{for(var t in s)k.o(s,t)&&!k.o(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:s[t]})},k.o=(e,s)=>Object.prototype.hasOwnProperty.call(e,s),k.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var V=k("./av/internal/avenginekitImpl.js"),N=V.WfcAVEngineKitImpl,P=V.default;export{N as WfcAVEngineKitImpl,P as default};
//# sourceMappingURL=engine-conference.min.js.map