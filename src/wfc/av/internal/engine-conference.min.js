!function(e,s){if("object"==typeof exports&&"object"==typeof module)module.exports=s(require("../../../config.js"),require("../../../platform.js"),require("../../messages/messageContentType"),require("../../model/conversation"),require("../../model/conversationType"),require("../../util/longUtil.js"),require("../engine/avenginekit"),require("../engine/avenginekitproxy"),require("../engine/callEndReason"),require("../engine/callSession"),require("../engine/callState"),require("../engine/subscriber"),require("../engine/videoProfile"),require("../engine/videoType"),require("../messages/addParticipantsMessageContent"),require("../messages/callAnswerMessageContent"),require("../messages/callByeMessageContent"),require("../messages/callModifyMessageContent"),require("../messages/callStartMessageContent"),require("../messages/conferenceChangeModeContent"),require("../messages/muteVideoMessageContent"));else if("function"==typeof define&&define.amd)define(["../../../config.js","../../../platform.js","../../messages/messageContentType","../../model/conversation","../../model/conversationType","../../util/longUtil.js","../engine/avenginekit","../engine/avenginekitproxy","../engine/callEndReason","../engine/callSession","../engine/callState","../engine/subscriber","../engine/videoProfile","../engine/videoType","../messages/addParticipantsMessageContent","../messages/callAnswerMessageContent","../messages/callByeMessageContent","../messages/callModifyMessageContent","../messages/callStartMessageContent","../messages/conferenceChangeModeContent","../messages/muteVideoMessageContent"],s);else{var o="object"==typeof exports?s(require("../../../config.js"),require("../../../platform.js"),require("../../messages/messageContentType"),require("../../model/conversation"),require("../../model/conversationType"),require("../../util/longUtil.js"),require("../engine/avenginekit"),require("../engine/avenginekitproxy"),require("../engine/callEndReason"),require("../engine/callSession"),require("../engine/callState"),require("../engine/subscriber"),require("../engine/videoProfile"),require("../engine/videoType"),require("../messages/addParticipantsMessageContent"),require("../messages/callAnswerMessageContent"),require("../messages/callByeMessageContent"),require("../messages/callModifyMessageContent"),require("../messages/callStartMessageContent"),require("../messages/conferenceChangeModeContent"),require("../messages/muteVideoMessageContent")):s(e["../../../config.js"],e["../../../platform.js"],e["../../messages/messageContentType"],e["../../model/conversation"],e["../../model/conversationType"],e["../../util/longUtil.js"],e["../engine/avenginekit"],e["../engine/avenginekitproxy"],e["../engine/callEndReason"],e["../engine/callSession"],e["../engine/callState"],e["../engine/subscriber"],e["../engine/videoProfile"],e["../engine/videoType"],e["../messages/addParticipantsMessageContent"],e["../messages/callAnswerMessageContent"],e["../messages/callByeMessageContent"],e["../messages/callModifyMessageContent"],e["../messages/callStartMessageContent"],e["../messages/conferenceChangeModeContent"],e["../messages/muteVideoMessageContent"]);for(var t in o)("object"==typeof exports?exports:e)[t]=o[t]}}(window,(function(e,s,o,t,r,n,i,a,l,c,d,u,A,m,h,f,_,p,b,j,S){return function(e){var s={};function o(t){if(s[t])return s[t].exports;var r=s[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,o),r.l=!0,r.exports}return o.m=e,o.c=s,o.d=function(e,s,t){o.o(e,s)||Object.defineProperty(e,s,{enumerable:!0,get:t})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,s){if(1&s&&(e=o(e)),8&s)return e;if(4&s&&"object"==typeof e&&e&&e.__esModule)return e;var t=Object.create(null);if(o.r(t),Object.defineProperty(t,"default",{enumerable:!0,value:e}),2&s&&"string"!=typeof e)for(var r in e)o.d(t,r,function(s){return e[s]}.bind(null,r));return t},o.n=function(e){var s=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(s,"a",s),s},o.o=function(e,s){return Object.prototype.hasOwnProperty.call(e,s)},o.p="",o(o.s="./av/internal/avenginekitImpl.js")}({"../../../config.js":function(s,o){s.exports=e},"../../../platform.js":function(e,o){e.exports=s},"../../messages/messageContentType":function(e,s){e.exports=o},"../../model/conversation":function(e,s){e.exports=t},"../../model/conversationType":function(e,s){e.exports=r},"../../util/longUtil.js":function(e,s){e.exports=n},"../engine/avenginekit":function(e,s){e.exports=i},"../engine/avenginekitproxy":function(e,s){e.exports=a},"../engine/callEndReason":function(e,s){e.exports=l},"../engine/callSession":function(e,s){e.exports=c},"../engine/callState":function(e,s){e.exports=d},"../engine/subscriber":function(e,s){e.exports=u},"../engine/videoProfile":function(e,s){e.exports=A},"../engine/videoType":function(e,s){e.exports=m},"../messages/addParticipantsMessageContent":function(e,s){e.exports=h},"../messages/callAnswerMessageContent":function(e,s){e.exports=f},"../messages/callByeMessageContent":function(e,s){e.exports=_},"../messages/callModifyMessageContent":function(e,s){e.exports=p},"../messages/callStartMessageContent":function(e,s){e.exports=b},"../messages/conferenceChangeModeContent":function(e,s){e.exports=j},"../messages/muteVideoMessageContent":function(e,s){e.exports=S},"./av/internal/avenginekitImpl.js":function(e,s,o){"use strict";o.r(s),o.d(s,"WfcAVEngineKitImpl",(function(){return O}));var t=o("./node_modules/babel-runtime/core-js/map.js"),r=o.n(t),n=o("../../messages/messageContentType"),i=o.n(n),a=o("../messages/callByeMessageContent"),l=o.n(a),c=o("../messages/callAnswerMessageContent"),d=o.n(c),u=o("../messages/callStartMessageContent"),A=o.n(u),m=o("../messages/callModifyMessageContent"),h=o.n(m),f=o("../../model/conversationType"),_=o.n(f),p=o("../engine/callEndReason"),b=o.n(p),j=o("../engine/avenginekitproxy"),S=o.n(j),g=o("../engine/callState"),y=o.n(g),v=o("./av/internal/callSessionImpl.js"),C=o("../messages/addParticipantsMessageContent"),I=o.n(C),E=o("../engine/avenginekit"),T=o.n(E),M=o("../../../config.js"),R=o.n(M);class O extends T.a{constructor(){super(),this.sendMessageId=0,this.sendConferenceRequestId=0,this._fixLongSerializedIssue=e=>("string"!=typeof e||"string"==typeof(e=JSON.parse(e))&&(e=JSON.parse(e)),e),this.onSendMessage=(e,s)=>{s=this._fixLongSerializedIssue(s);let o=this.sendMessageCallbackMap.get(s.sendMessageId);o&&o(s.error,s.messageUid,s.timestamp),this.sendMessageCallbackMap.delete(s.sendMessageId)},this.onSendConferenceRequest=(e,s)=>{s=this._fixLongSerializedIssue(s);let o=this.sendConferenceRequestCallbackMap.get(s.sendConferenceRequestId);o&&(o(s.error,s.response),this.sendConferenceRequestCallbackMap.delete(s.sendConferenceRequestId))},this.onConferenceEvent=(e,s)=>{s=this._fixLongSerializedIssue(s),this.currentSession&&this.currentSession.onConferenceEvent(s)},this.onReceiveMessage=(e,s)=>{if(s=this._fixLongSerializedIssue(s),console.log("receive voip message ",s),!(s.conversation.type!==_.a.Single&&s.conversation.type!==_.a.Group||1!==s.direction&&s.messageContent.type!==i.a.VOIP_CONTENT_TYPE_ACCEPT&&s.messageContent.type!==i.a.VOIP_CONTENT_TYPE_END)){let e=s.messageContent;if(s.messageContent.type===i.a.VOIP_CONTENT_TYPE_SIGNAL){if(!k.currentSession||k.currentSession.status===y.a.STATUS_IDLE)return;let o=s.messageContent;o.callId!==k.currentSession.callId?k.rejectOtherCall(s.conversation,e.callId,null,s.messageUid):!k.currentSession||k.currentSession.status!==y.a.STATUS_CONNECTING&&k.currentSession.status!==y.a.STATUS_CONNECTED&&k.currentSession.status!==y.a.STATUS_OUTGOING||k.onReceiveData(s.from,o.payload)}else if(s.messageContent.type===i.a.VOIP_CONTENT_TYPE_START){console.log("callstart",s);let o=s.messageContent.targetIds;if(o.findIndex(e=>e===s.selfUserInfo.uid)<0)return;o=o.filter(e=>e!==s.selfUserInfo.uid),o=o.push(s.from),k.currentSession&&k.currentSession.status!==y.a.STATUS_IDLE?k.rejectOtherCall(s.conversation,e.callId,o,s.messageUid):(k.currentSession=v.default.newSession(s.conversation,s.from,e.callId,e.audioOnly,k.sessionCallback),k.currentSession.startMsgUid=s.messageUid,k.currentSession.pin=e.pin,k.currentSession.initSession(!1,s.selfUserInfo,s.participantUserInfos,s.groupMemberUserInfos),k.currentSession.setState(y.a.STATUS_INCOMING),k.currentSession.joinTime=s.timestamp,k.currentSession.setUserJoinTime(s.from,s.timestamp),s.participantUserInfos.forEach(e=>{k.currentSession.setUserJoinTime(e.uid,s.timestamp)}),k.currentSession.setUserAcceptTime(s.from,s.timestamp))}else if(s.messageContent.type===i.a.VOIP_CONTENT_TYPE_ACCEPT||s.messageContent.type===i.a.VOIP_CONTENT_TYPE_ACCEPT_T){if(k.currentSession&&k.currentSession.status!==y.a.STATUS_IDLE){if(e.callId!==k.currentSession.callId)return void(1===s.direction&&k.rejectOtherCall(s.conversation,e.callId,[s.selfUserInfo.uid]));if(0===s.direction&&k.currentSession.status===y.a.STATUS_INCOMING)return void k.currentSession.endCall(b.a.REASON_AcceptByOtherClient);k.currentSession.status===y.a.STATUS_OUTGOING&&k.currentSession.setState(y.a.STATUS_CONNECTING),!k.currentSession.audioOnly&&e.audioOnly&&k.currentSession.setAudioOnly(!0),k.currentSession.setUserAcceptTime(s.from,s.timestamp);let o=k.queueOfferMessageMap.get(s.from);o&&o.forEach(e=>{k.processSignalingMessage(s.from,e)}),k.queueOfferMessageMap.delete(s.from)}}else if(s.messageContent.type===i.a.VOIP_CONTENT_TYPE_END)if(k.currentSession&&k.currentSession.status!==y.a.STATUS_IDLE&&k.currentSession.callId===e.callId){let o=e.reason;if(1===s.direction){switch(e.reason){case b.a.REASON_Unknown:o=b.a.REASON_Unknown;break;case b.a.REASON_Busy:o=b.a.RemoteBusy;break;case b.a.REASON_SignalError:o=b.a.RemoteNetworkError;break;case b.a.REASON_Hangup:o=b.a.REASON_RemoteHangup;break;case b.a.REASON_MediaError:o=b.a.RemoteNetworkError;break;case b.a.REASON_RemoteHangup:o=b.a.REASON_Hangup;break;case b.a.REASON_OpenCameraFailure:o=b.a.RemoteNetworkError;break;case b.a.REASON_Timeout:o=b.a.RemoteTimeout;break;case b.a.REASON_AcceptByOtherClient:o=b.a.REASON_AcceptByOtherClient;break;case b.a.REASON_AllLeft:o=b.a.REASON_AllLeft;break;case b.a.RemoteBusy:o=b.a.REASON_Busy;break;case b.a.RemoteTimeout:o=b.a.REASON_Timeout;break;case b.a.RemoteNetworkError:o=b.a.REASON_SignalError;break;case b.a.RoomDestroyed:o=b.a.RoomDestroyed;break;case b.a.RoomNotExist:o=b.a.RoomNotExist;break;case b.a.RoomParticipantsFull:o=b.a.RoomParticipantsFull;break;default:o=b.a.RemoteNetworkError}k.currentSession.endUserCall(s.from,o)}else k.currentSession.endCall(o)}else console.log("invalid bye message, ignore it",k.currentSession,e);else if(s.messageContent.type===i.a.VOIP_CONTENT_TYPE_MODIFY)k.currentSession&&k.currentSession.status===y.a.STATUS_CONNECTED&&k.currentSession.callId===e.callId&&(e.audioOnly?(k.currentSession.audioOnly=!0,k.currentSession.downgrade2Voice(!0)):console.log("cannot modify voice call to video call"));else if(s.messageContent.type===i.a.VOIP_Join_Call_Request)k.currentSession&&k.currentSession.status===y.a.STATUS_CONNECTED&&s.messageContent.callId===k.currentSession.callId&&k.currentSession.initiatorId===k.currentSession.selfUserInfo.uid&&k.currentSession.inviteNewParticipants([s.from],s.messageContent.clientId,!0);else if(s.messageContent.type===i.a.VOIP_CONTENT_TYPE_ADD_PARTICIPANT)if(e.participants.indexOf(s.selfUserInfo.uid)>-1){if(k.currentSession&&k.currentSession.status!==y.a.STATUS_IDLE){if(k.currentSession.callId===s.messageContent.callId)return;let o=[];return o.push(...s.messageContent.participants),s.messageContent.existParticipants&&o.push(...s.messageContent.existParticipants),o.push(s.from),o=o.filter(e=>e!==s.selfUserInfo.uid),void k.rejectOtherCall(s.conversation,e.callId,o)}k.currentSession=v.default.newSession(s.conversation,s.from,e.callId,e.audioOnly,k.sessionCallback),k.currentSession.pin=e.pin,k.currentSession.startMsgUid=s.messageUid;let o=s.participantUserInfos.filter(e=>e.uid!==s.selfUserInfo.uid);k.currentSession.initSession(!1,s.selfUserInfo,o,s.groupMemberUserInfos),k.currentSession.joinTime=s.timestamp,o.forEach(e=>{k.currentSession.setUserJoinTime(e.uid,s.timestamp)}),k.currentSession.updateExistParticipant(e.existParticipants,s.timestamp),R.a.ENABLE_MULTI_CALL_AUTO_JOIN&&e.autoAnswer&&k.currentSession.answer(e.audioOnly)}else if(k.currentSession&&k.currentSession.status!==y.a.STATUS_IDLE&&k.currentSession.callId===e.callId){let o=s.participantUserInfos.filter(s=>e.participants.indexOf(s.uid)>-1);k.currentSession.didAddNewParticipants(e.participants,o),o.forEach(e=>{k.currentSession.setUserJoinTime(e.uid,s.timestamp)})}else{let o=[];o.push(...s.messageContent.participants),s.messageContent.existParticipants&&o.push(...s.messageContent.existParticipants),o.push(s.from),o=o.filter(e=>e!==s.selfUserInfo.uid),k.rejectOtherCall(s.conversation,e.callId,o)}else if(s.messageContent.type===i.a.VOIP_CONTENT_TYPE_MUTE_VIDEO){let e=s.messageContent;k.currentSession&&k.currentSession.callId===e.callId&&k.currentSession.status!==y.a.STATUS_IDLE&&k.currentSession.updateVideoMute(s.from,e.videoMuted)}else if(s.messageContent.type===i.a.CONFERENCE_CONTENT_TYPE_CHANGE_MODE){let e=s.messageContent;k.currentSession&&k.currentSession.callId===e.callId&&k.currentSession.onRequestChangeMode(e.audience)}else if(s.messageContent.type===i.a.CONFERENCE_CONTENT_TYPE_KICKOFF_MEMBER){let e=s.messageContent;k.currentSession&&k.currentSession.callId===e.callId&&k.currentSession.onKickoff()}}},this.startCall=(e,s)=>{let o=(s=this._fixLongSerializedIssue(s)).conversation,t=s.audioOnly;if(this.currentSession)return;this.currentSession=v.default.newSession(o,s.selfUserInfo.uid,s.callId,t,k.sessionCallback),this.currentSession.pin="";for(let e=0;e<6;e++)this.currentSession.pin+=Math.floor(10*Math.random());this.currentSession.callExtra=s.callExtra,this.currentSession.initSession(!0,s.selfUserInfo,s.participantUserInfos,s.groupMemberUserInfos),this.currentSession.setState(y.a.STATUS_OUTGOING);let r=new A.a;r.audioOnly=t,r.callId=s.callId,r.pin=this.currentSession.pin,r.targetIds=this.currentSession.getParticipantIds(),this.currentSession.createRoom(e=>{0===e?this.sendSignalMessage(r,this.currentSession.getParticipantIds(),!0,(e,s,o)=>{k.currentSession&&(0!==e?this.currentSession.endCall(b.a.REASON_SignalError):(this.currentSession.startMsgUid=s,console.log("startMsgUid",this.currentSession.startMsgUid,s),this.currentSession.joinTime=o,this.currentSession.setAcceptTime(o),r.targetIds.forEach(e=>{this.currentSession.setUserJoinTime(e,o)},this)))}):this.currentSession.endCall(b.a.REASON_SignalError)})},this.startConference=(e,s)=>{let o=(s=this._fixLongSerializedIssue(s)).audioOnly;this.currentSession||(this.currentSession=v.default.newSession(null,s.selfUserInfo.uid,s.callId,o,k.sessionCallback),this.currentSession.pin=s.pin,this.currentSession.host=s.host,this.currentSession.title=s.title,this.currentSession.desc=s.desc,this.currentSession.conference=!0,this.currentSession.defaultAudience=s.audience,this.currentSession.advance=s.advance,this.currentSession.record=s.record,this.currentSession.extra=s.extra,this.currentSession.callExtra=s.callExtra,this.currentSession.initSession(!0,s.selfUserInfo,null,null,!0),this.currentSession.setState(y.a.STATUS_OUTGOING),this.currentSession.createRoom(e=>{0!==e&&this.currentSession.endCall(b.a.REASON_SignalError)}))},this._joinConference=(e,s)=>{this.joinConference(s)},this.joinConference=e=>{e=this._fixLongSerializedIssue(e),this.currentSession||(console.log("joinConference",e),this.currentSession=v.default.newSession(null,e.selfUserInfo.uid,e.callId,e.audioOnly,k.sessionCallback),this.currentSession.pin=e.pin,this.currentSession.host=e.host,this.currentSession.title=e.title,this.currentSession.desc=e.desc,this.currentSession.defaultAudience=e.audience,e.audience&&e.host===e.selfUserInfo.uid?this.currentSession.audience=!1:this.currentSession.audience=e.audience,this.currentSession.conference=!0,this.currentSession.advance=e.advance,this.currentSession.audioMuted=e.muteAudio,this.currentSession.videoMuted=e.muteVideo,this.currentSession.extra=e.extra,this.currentSession.callExtra=e.callExtra,this.currentSession.initSession(!1,e.selfUserInfo,null,null,!0),this.currentSession.setState(y.a.STATUS_CONNECTING))}}setup(e){console.log("wfc avengine-conference"),S.a.listenVoipEvent("message",this.onReceiveMessage),S.a.listenVoipEvent("conferenceEvent",this.onConferenceEvent),S.a.listenVoipEvent("sendMessageResult",this.onSendMessage),S.a.listenVoipEvent("sendConferenceRequestResult",this.onSendConferenceRequest),S.a.listenVoipEvent("startCall",this.startCall),S.a.listenVoipEvent("startConference",this.startConference),S.a.listenVoipEvent("joinConference",this._joinConference),this.sendMessageCallbackMap=new r.a,this.sendConferenceRequestCallbackMap=new r.a,this.queueOfferMessageMap=new r.a,this.sessionCallback=e}getCurrentSession(){return k.currentSession}inviteNewParticipants(e,s,o,t){let r=k.currentSession;if(!r)return;let n=new I.a;n.callId=r.callId,n.initiator=r.selfUserInfo.uid,console.log("inviteNewParticipants","initiator "+r.selfUserInfo),n.audioOnly=r.audioOnly,n.pin=s,n.participants=e,n.existParticipants=r.getExistParticipantsStatus(),n.autoAnswer=t,n.clientId=o;let i=[...r.getParticipantIds()];i.push(...e),this.sendSignalMessage(n,i,!0,(s,o,t)=>{if(console.log("send invite message success"),0!==s)return void console.log("send invite message error",s);let n=r.groupMemberUserInfos.filter(s=>e.findIndex(e=>e===s.uid)>-1);console.log("didAddNewParticipants av",e,n),r.didAddNewParticipants(e,n),e.forEach(e=>{r.setUserJoinTime(e,t)})})}updateCallStartMessageContent(e,s){let o={messageUid:e,content:s};S.a.emitToMain("update-call-start-message",o)}clearInviteUnreadStatus(e){}sendSignalMessage(e,s,o,t){k.currentSession.conversation&&this.sendSignalMessageEx(k.currentSession.conversation,e,s,o,t)}sendSignalMessageEx(e,s,o,t,r){let n={conversation:e,content:s.encode(),toUsers:o};console.log("send signal message",s),r&&(this.sendMessageId++,n.sendMessageId=this.sendMessageId,this.sendMessageCallbackMap.set(this.sendMessageId,r)),S.a.emitToMain("voip-message",n)}sendConferenceRequest(e,s,o,t,r){this.sendConferenceRequestEx(e,s,o,t,this.currentSession.advance,r)}sendConferenceRequestEx(e,s,o,t,r,n){let i={sessionId:e,roomId:s,request:o,data:t,advance:r};n&&(this.sendConferenceRequestId++,i.sendConferenceRequestId=this.sendConferenceRequestId,this.sendConferenceRequestCallbackMap.set(this.sendConferenceRequestId,n)),S.a.emitToMain("conference-request",i)}rejectOtherCall(e,s,o,t){let r=new l.a;r.callId=s,r.inviteMsgUid=t,r.reason=b.a.REASON_Busy,console.log("reject other call");let n={conversation:e,content:r.encode(),toUsers:o};S.a.emitToMain("voip-message",n)}onReceiveData(e,s){let o=JSON.parse(s);if(k.currentSession.getPeerConnection(e))k.processSignalingMessage(e,o);else{console.log("queue signal",e,o);let s=this.queueOfferMessageMap.get(e);s||(s=[],this.queueOfferMessageMap.set(e,s)),s.push(o)}}processSignalingMessage(e,s){console.log("process remote signal:"+s)}answerCurrentCall(){let e=new d.a;e.audioOnly=k.currentSession.audioOnly,e.callId=k.currentSession.callId,e.inviteMessageUid=k.currentSession.startMsgUid,this.sendSignalMessage(e,this.currentSession.getParticipantIds(),!0,(e,s,o)=>{0===e?this.currentSession.setAcceptTime(o):this.currentSession.endCall(b.a.REASON_SignalError)})}downgrade2VoiceCall(){let e=new h.a;k.currentSession.audioOnly=!0,e.audioOnly=k.currentSession.audioOnly,e.callId=k.currentSession.callId,this.sendSignalMessage(e,this.currentSession.getParticipantIds(),!0)}}const k=new O;s.default=k},"./av/internal/callSessionImpl.js":function(e,s,o){"use strict";o.r(s),o.d(s,"default",(function(){return Q}));var t=o("./node_modules/babel-runtime/core-js/object/keys.js"),r=o.n(t),n=o("./node_modules/babel-runtime/helpers/extends.js"),i=o.n(n),a=o("./node_modules/babel-runtime/helpers/asyncToGenerator.js"),l=o.n(a),c=o("./node_modules/babel-runtime/core-js/map.js"),d=o.n(c),u=o("./node_modules/babel-runtime/core-js/json/stringify.js"),A=o.n(u),m=o("../engine/callState"),h=o.n(m),f=o("./av/internal/avenginekitImpl.js"),_=o("../engine/callEndReason"),p=o.n(_),b=o("../messages/callByeMessageContent"),j=o.n(b),S=o("./av/internal/subscriberImpl.js"),g=o("../../../platform.js"),y=o("../engine/callSession"),v=o.n(y),C=o("../../util/longUtil.js"),I=o("../engine/avenginekit"),E=o.n(I),T=o("../../model/conversationType"),M=o.n(T),R=o("../messages/conferenceChangeModeContent"),O=o.n(R),k=o("../../model/conversation"),w=o.n(k),N=o("./av/internal/roomErrorCode.js"),V=o("./av/internal/soundMeter.js"),x=o("../engine/avenginekitproxy"),P=o.n(x),U=o("../messages/muteVideoMessageContent"),B=o.n(U),D=o("../engine/videoProfile"),L=o.n(D),G=o("./av/internal/publisherImpl.js"),q=o("./av/internal/screenSharingPublisherImpl.js");class Q extends v.a{constructor(...e){var s;return s=super(...e),this.audience=!1,this.joinTime=0,this.acceptTime=0,this.status=0,this.isAllBusy=!0,this.videoCamera="user",this.rotateAng=0,this.onVoipWindowClose=e=>{this.endCall(p.a.RemoteNetworkError),window.removeEventListener("beforeunload",this.onVoipWindowClose)},this.callTimeout=()=>{let e=(new Date).valueOf();this.callTimer||(this.callTimer=setInterval(this.callTimeout,1e3));let s=Object(C.numberValue)(this.joinTime);if(0!==s){if(this.status===h.a.STATUS_INCOMING){if(e-s>6e4)return void this.endCall(p.a.REASON_Timeout)}else if(this.status!==h.a.STATUS_CONNECTED&&e-s>6e4)return void this.endCall(p.a.RemoteTimeout);this.subscriberMap.forEach((s,o)=>{let t=Object(C.gt)(s.acceptTime,s.joinTime)?s.acceptTime:s.joinTime;s.status!==h.a.STATUS_CONNECTED&&Object(C.gt)(t,0)&&e-Object(C.numberValue)(t)>6e4&&(console.log("subscriber timeout",e,Object(C.numberValue)(s.acceptTime),Object(C.numberValue)(s.joinTime)),this.endUserCall(o,p.a.RemoteTimeout))})}},this.gotRemoteStream=(e,s)=>{if(this.sessionCallback){let o=this.getScreenSharingUserId(e);this.sessionCallback.didReceiveRemoteVideoTrack(o||e,s.streams[0],null!==o)}let o=s.streams[0];o.onremovetrack=s=>{console.log("pc remove remote stream",s),this.sessionCallback&&this.sessionCallback.didRemoveRemoteVideoTrack(e)};let t=this.getSubscriber(e);if(o.getAudioTracks().length>0){let e=new V.SoundMeter(window.audioContext);e.connectToSource(o,e=>{console.log("connect to soundMeter",e)}),t.soundMeter=e}t.stream=s.streams[0],console.log("pc received remote stream",e,s.streams[0],s.streams[0].getVideoTracks().length,s.streams[0].getAudioTracks().length)},this.onIceCandidate=(e,s,o)=>{if(!o.candidate)return;let t={};if(t.session_id=this.sessionId,e===this.selfUserInfo.uid)t.handle_id=this.handleId;else{let s=this.getSubscriber(e);t.handle_id=s.handleId}let r={};r.candidate=o.candidate.candidate,r.sdpMLineIndex=o.candidate.sdpMLineIndex,r.sdpMid=o.candidate.sdpMid,r.pin=this.pin,t.candidate=r,f.default.sendConferenceRequest(this.sessionId,this.callId,"trickle",A()(t),(e,s)=>{0!==e&&console.log("conference request, trickle error",e)})},this.onIceStateChange=(e,s,o)=>{if(s){if(this.selfUserInfo.uid===e)return this.connectedTime||(this.connectedTime=(new Date).getTime()),void this.setState(h.a.STATUS_CONNECTED);let t=this.getSubscriber(e);if(console.log("ICE state change event: ",o),"connected"===s.iceConnectionState&&(this.setState(h.a.STATUS_CONNECTED),t.status=h.a.STATUS_CONNECTED,this.sessionCallback)){let s=this.getScreenSharingUserId(e);this.sessionCallback.didParticipantConnected(s||e,null!==s)}"disconnected"===s.iceConnectionState||"failed"===s.iceConnectionState&&(console.log("iceConnectionState failed, endCall"),this.endUserCall(e,p.a.REASON_MediaError))}},this.bytesPrev=0,this.timestampPrev=0,s}static newSession(e,s,o,t,r){console.log("newSession");let n=new Q;return n.conversation=e,n.initiatorId=s,n.callId=o,n.audioOnly=t,n.sessionCallback=r,window.__callSession=n,n}getParticipantIds(){let e=[];for(const[s,o]of this.subscriberMap)e.push(s);return e}setAcceptTime(e){this.acceptTime||(this.acceptTime=e),this.updateInitiator()}setUserAcceptTime(e,s){console.log("setUserAcceptTime",e,s);let o=this.getSubscriber(e);o?o.acceptTime=s:console.error("setUserAcceptTime undefined",e,this.status,this.subscriberMap)}setUserJoinTime(e,s){this.getSubscriber(e).joinTime=s}getSubscriber(e,s){return s&&(e="screen_sharing_"+e),this.subscriberMap.get(e)}getPeerConnection(e){return this.subscriberMap.get(e).peerConnection}answer(e,s){this.status===h.a.STATUS_INCOMING&&(this.setState(h.a.STATUS_CONNECTING),this.audioOnly&&!e&&(e=!0),this.audioOnly=e,this.callExtra=s,f.default.answerCurrentCall())}setState(e){if(this.status!==e&&(this.status!==h.a.STATUS_CONNECTED||e!==h.a.STATUS_CONNECTING)){if(this.status=e,console.log("set status",e,this.startMsgUid),e===h.a.STATUS_IDLE||e===h.a.STATUS_CONNECTED){if(this.startMsgUid){let s={audioOnly:this.audioOnly};s.status=this.endReason?this.endReason:0,e===h.a.STATUS_CONNECTED?(s.connectTime=(new Date).getTime(),this.startTime=s.connectTime):s.endTime=(new Date).getTime(),f.default.updateCallStartMessageContent(this.startMsgUid,s)}e===h.a.STATUS_CONNECTED&&this.conference&&this.notifyMuteState()}else e===h.a.STATUS_CONNECTING&&this.joinAndPublish();this.sessionCallback&&this.sessionCallback.didChangeState(e)}}initSession(e,s,o=[],t=[],r=!1){this.moCall=e,this.selfUserInfo=s,this.participantUserInfos=o,this.singleCall=o&&1===o.length,this.groupMemberUserInfos=t;let n=s;!e&&o&&o.length>0&&(n=o.filter(e=>e.uid===this.initiatorId)[0]),this.sessionCallback.onInitial(this,s,n,o,t);let i=[];o&&o.length>0&&o.forEach(e=>{i.push(e.uid)}),this.initSubscriberMap(i),r||(e?(this.setState(h.a.STATUS_OUTGOING),this.startPreview(this.audioOnly)):(this.setState(h.a.STATUS_INCOMING),this.playIncomingRing())),this.callTimeout(),window.AudioContext=window.AudioContext||window.webkitAudioContext,window.audioContext=new AudioContext,setTimeout(()=>{window.addEventListener("beforeunload",this.onVoipWindowClose)},500),this.soundMeterTimer=setInterval(()=>{let e=this.cameraPublisher&&this.cameraPublisher.soundMeter;if(e){let s=e.instant.toFixed(2);e.slow.toFixed(2),e.clip;this.sessionCallback.didReportAudioVolume(this.selfUserInfo.uid,Number(s))}this.subscriberMap.forEach((e,s)=>{if(!e.soundMeter)return;let o=e.soundMeter.instant.toFixed(2);e.soundMeter.slow.toFixed(2),e.soundMeter.clip;this.sessionCallback.didReportAudioVolume(s,Number(o))})},100),localStorage.getItem("enable_voip_debug")&&(this.pcStatsTimer=setInterval(()=>{this.subscriberMap.forEach((e,s)=>{let o=e.peerConnection;o&&o.getStats().then(e=>{this.showRemoteStats(s,e)})})},1e3))}initSubscriberMap(e){console.log("initParticipantClientMap",e),this.subscriberMap||(this.subscriberMap=new d.a),!e||e.length<1||e.forEach(e=>{let s=new S.default(e,this);e===this.selfUserInfo.uid?s.status=h.a.STATUS_OUTGOING:s.status=h.a.STATUS_INCOMING,this.subscriberMap.set(e,s)},this)}inviteNewParticipants(e,s,o){e.length&&(e=e.filter(e=>e!==this.selfUserInfo.uid&&this.participantUserInfos.findIndex(s=>s.uid===e)<0)).length&&(this.singleCall=!1,f.default.inviteNewParticipants(e,this.pin,s,o))}getExistParticipantsStatus(){let e=[];return e.push({userId:this.selfUserInfo.uid,acceptTime:this.acceptTime?Object(C.numberValue)(this.acceptTime):0,joinTime:this.joinTime?Object(C.numberValue)(this.joinTime):0,videoMuted:this.videoMuted}),this.participantUserInfos.forEach(s=>{let o=this.getSubscriber(s.uid);e.push({userId:o.userId,acceptTime:o.acceptTime?Object(C.numberValue)(o.acceptTime):0,joinTime:o.joinTime?Object(C.numberValue)(o.joinTime):0,videoMuted:o.videoMuted})},this),e}didAddNewParticipants(e,s){console.log("didAddNewParticipants",e,s),e.forEach(e=>{let s=new S.default(e,this);s.status=h.a.STATUS_INCOMING,this.subscriberMap.set(e,s)},this),s.forEach(e=>{this.participantUserInfos.push(e),this.sessionCallback&&this.sessionCallback.didParticipantJoined(e.uid,!1)},this)}updateExistParticipant(e,s){e.forEach(e=>{let o=this.getSubscriber(e.userId);o.status=h.a.STATUS_INCOMING,o.joinTime=s,o.videoMuted=e.videoMuted,o.acceptTime=e.acceptTime})}updateVideoMute(e,s){let o=this.getSubscriber(e);o&&o.videoMuted!==s&&(o.videoMuted=s,this.sessionCallback&&this.sessionCallback.didVideoMuted(e,s))}defaultVideoConstraints(e){let s;if(e)s={audio:{echoCancellation:!0,noiseSuppression:!0,autoGainControl:!0},video:!1};else{let e=L.a.getVideoProfile(E.a.VIDEO_PROFILE);s={audio:{echoCancellation:!0,noiseSuppression:!0,autoGainControl:!0},video:{width:{ideal:e.width},height:{ideal:e.height},frameRate:{ideal:e.fps}}}}return this.audioInputDeviceId&&(s.audio.deviceId=this.audioInputDeviceId),e||(this.videoInputDeviceId&&(s.video.deviceId=this.videoInputDeviceId),s.video.facingMode=this.videoCamera),console.log("camera stream constraints",s),s}createLocalCameraVideoStream(e){var s=this;return l()((function*(){try{console.log("createLocalCameraVideoStream",e);const o=yield navigator.mediaDevices.getUserMedia(s.defaultVideoConstraints(e));console.log("Received local stream",o,e),s.sessionCallback&&s.sessionCallback.didCreateLocalVideoTrack(o,!1);const t=o.getVideoTracks();e?t&&t.length>0&&(console.log("audioonly, stop video track"),t.forEach((function(e){return e.stop()}))):t&&t.length>0&&console.log(`Using video device: ${t[0].label}`);const r=o.getAudioTracks();return r.length>0&&console.log(`Using audio device: ${r[0].label}`),o}catch(e){console.error("getUserMedia error",e),s.sessionCallback&&s.sessionCallback.didCreateLocalVideoTrackError()}return null}))()}startPreview(e){var s=this;return l()((function*(){if(console.log("start preview"),s.conference&&s.audience)return;(yield s.createLocalCameraVideoStream(e))||s.endCall(p.a.REASON_MediaError)}))()}getDesktopSources(e){return g.desktopCapturer?g.desktopCapturer.getSources({types:e}):null}startScreenShare(e){var s=this;return l()((function*(){if(!s.isScreenSharing()&&!s.audioOnly)if(console.log("start screen share"),console.log("desktopCapturer ",g.desktopCapturer),g.desktopCapturer?(s.screenShareStream=yield navigator.mediaDevices.getUserMedia({audio:!1,video:{mandatory:i()({chromeMediaSource:"desktop"},e)}}),console.log("desktopCapturer screen share stream",s.screenShareStream)):s.screenShareStream=yield navigator.mediaDevices.getDisplayMedia({audio:!1,video:!0}),s.sessionCallback&&s.sessionCallback.didCreateLocalVideoTrack(s.screenShareStream,!0),E.a.SCREEN_SHARING_REPLACE_MODE){if(s.cameraPublisher.videoSender){if(s.cameraPublisher.videoSender.replaceTrack(s.screenShareStream.getVideoTracks()[0]),!E.a.DISABLE_DUAL_STREAM){let e=s.screenShareStream.getVideoTracks()[0].clone();yield e.applyConstraints(s.cameraPublisher.tinyVideoTrackConstraints()),s.cameraPublisher.smallVideoSender.replaceTrack(e)}s.cameraPublisher.stopVideoTrack(s.cameraPublisher.cameraVideoStream)}else console.error("screen share error, publisher.videoSender is null");s.videoMuted&&s.notifyMuteState()}else s.screenSharingPublisher=new q.default(s),s.screenSharingPublisher.attachAndPublishScreenSharing()}))()}isScreenSharing(){return!!this.screenShareStream}stopScreenShare(){var e=this;E.a.SCREEN_SHARING_REPLACE_MODE?(this.cameraPublisher.stopVideoStream(this.screenShareStream),this.screenShareStream=null,this.videoMuted?this.notifyMuteState():l()((function*(){yield e.cameraPublisher.createMediaSenders(),e.sessionCallback&&e.sessionCallback.didCreateLocalVideoTrack(e.cameraPublisher.cameraVideoStream,!1)}))()):(this.screenSharingPublisher&&(this.screenSharingPublisher.stopVideoStream(this.screenShareStream),this.screenSharingPublisher.unPublishMedia(),this.screenSharingPublisher.deattach(),this.screenSharingPublisher=null,this.sessionCallback&&this.cameraPublisher.cameraVideoStream&&this.sessionCallback.didCreateLocalVideoTrack(this.cameraPublisher.cameraVideoStream,!1)),this.screenShareStream=null)}createPeerConnection(e,s){let o=this.getSelectedSdpSemantics();console.log("RTCPeerConnection configuration:",o);let t=new RTCPeerConnection(o);if(e!==this.selfUserInfo.uid){let o=this.getSubscriber(e);o.peerConnection=t,o.isInitiator=s}return console.log("Created local peer connection object pc"),t.addEventListener("icecandidate",s=>this.onIceCandidate(e,t,s)),t.addEventListener("iceconnectionstatechange",s=>this.onIceStateChange(e,t,s)),t.addEventListener("track",s=>this.gotRemoteStream(e,s)),t.addEventListener("connectionstatechange",s=>this.onConnectionStateChange(e,t,s)),console.log("createPeerConnection",e,this.getSubscriber(e)),t}getSelectedSdpSemantics(){return console.log("-0000000001111----"),{bundlePolicy:"max-bundle"}}onConnectionStateChange(e,s,o){console.log("onConnectionStateChange",e,s,o),"failed"===s.connectionState&&(console.log("pc connectionState failed, endCall"),this.endUserCall(e,p.a.REASON_MediaError))}hangup(){console.log("Ending call"),this.endCall(p.a.REASON_Hangup)}setAudioOnly(e){this.audioOnly=e,this.conference||this.sessionCallback&&this.sessionCallback.didChangeMode(e)}downgrade2Voice(e=!1){this.status===h.a.STATUS_CONNECTED&&(this.cameraPublisher.stopVideoTrack(this.cameraPublisher.cameraVideoStream),e||f.default.downgrade2VoiceCall(),this.setAudioOnly(!0))}downToVoice(){if(console.log("down to voice"),this.stopIncomingRing(),this.status===h.a.STATUS_INCOMING)return this.setAudioOnly(!0),void this.answerCall(!0);this.status===h.a.STATUS_CONNECTED&&(this.audioOnly||(this.setAudioOnly(!0),f.default.downgrade2VoiceCall()))}muteVideo(e){this.setVideoEnabled(!e)}setVideoEnabled(e){if(this.videoMuted!==!e&&!this.audioOnly&&!this.isScreenSharing())if(this.videoMuted=!e,e?this.cameraPublisher.createMediaSenders():this.cameraPublisher.stopVideoTrack(this.cameraPublisher.cameraVideoStream),this.conference)this.notifyMuteState(),this.sessionCallback&&this.sessionCallback.didMuteStateChanged([this.selfUserInfo.uid]);else{let e=new B.a;e.callId=this.callId,e.videoMuted=this.videoMuted,e.existParticipants=this.getExistParticipantsStatus(),f.default.sendSignalMessage(e,this.getParticipantIds(),!0)}}muteAudio(e){this.setAudioEnabled(!e)}setAudioEnabled(e){if(this.audioMuted!==!e&&this.cameraPublisher.cameraVideoStream){const s=this.cameraPublisher.cameraVideoStream.getAudioTracks();s&&s.length>0&&(s[0].enabled=!s[0].enabled,this.audioMuted=!e,this.conference&&(this.notifyMuteState(),this.sessionCallback&&this.sessionCallback.didMuteStateChanged([this.selfUserInfo.uid])))}}endMedia(e,s){console.log("Ending media"),this.setState(h.a.STATUS_IDLE),this.stopIncomingRing(),this.cameraPublisher&&this.cameraPublisher.endMedia(),this.screenSharingPublisher&&this.screenSharingPublisher.endMedia()}endUserCall(e,s){if(console.log("endUserCall",e,s),e===this.selfUserInfo.uid)return void this.endCall(s);if(!this.conference&&e===this.initiatorId){let o=!1;for(const[s,t]of this.subscriberMap)if(t.acceptTime>0&&e===s){o=!0;break}if(o=o||this.acceptTime>0,!o)return void this.endCall(s)}let o=this.getSubscriber(e);if(this.subscriberMap.delete(e),this.participantUserInfos&&(this.participantUserInfos=this.participantUserInfos.filter(s=>s.uid!==e)),o){if(o.peerConnection){o.peerConnection.getSenders().forEach(e=>o.peerConnection.removeTrack(e)),o.peerConnection.close(),o.peerConnection=null}if(e===this.initiatorId&&this.updateInitiator(),this.sessionCallback){let o=this.getScreenSharingUserId(e);this.sessionCallback.didParticipantLeft(o||e,s,null!==o)}}this.isAllBusy=this.isAllBusy&&s===p.a.RemoteBusy,this.conference||0!==this.subscriberMap.size||(0===this.conversation.type||this.singleCall?this.endCall(s):this.endCall(this.isAllBusy?p.a.RemoteBusy:p.a.REASON_AllLeft))}leaveConference(e){this.conference?this.endCall(p.a.REASON_Hangup,e):this.endCall(p.a.REASON_Hangup)}endCall(e,s){if(console.log("endCall ---- ",e,(new Error).stack),this.endReason=e,this.status===h.a.STATUS_IDLE)return;if(this.setState(h.a.STATUS_IDLE),!this.conference&&e!==p.a.REASON_AcceptByOtherClient&&e!==p.a.REASON_AllLeft&&this.getParticipantIds().length>0){let s=new j.a;s.callId=this.callId,s.inviteMsgUid=this.startMsgUid,s.reason=e,f.default.sendSignalMessage(s,this.getParticipantIds(),!1)}if(e!==p.a.REASON_AcceptByOtherClient){let o={};o.handle_id=this.handleId,(s||e===p.a.REASON_AllLeft||this.conversation&&this.conversation.type===M.a.Single&&[p.a.RemoteBusy,p.a.REASON_RemoteHangup,p.a.RemoteTimeout].indexOf(e)>-1)&&(o.destroy=!0),console.log("leave",A()(o)),f.default.sendConferenceRequest(this.sessionId,this.callId,"leave",A()(o),(e,s)=>{0!==e&&console.log("conference request, leave error",e)})}let o={callId:this.callId,audioOnly:this.audioOnly,pin:this.pin,host:this.host,title:this.title,desc:this.desc,audience:this.audience,advance:this.advance};this.keepAlive(!1),this.endTime=(new Date).valueOf();for(const[e,s]of this.subscriberMap)s.peerConnection&&(s.peerConnection.close(),s.peerConnection=null);f.default.currentSession=null,clearInterval(this.callTimer),clearInterval(this.soundMeterTimer),this.pcStatsTimer&&clearInterval(this.pcStatsTimer),this.endMedia(e,o),this.sessionCallback&&this.sessionCallback.didCallEndWithReason(e)}defaultPublishMediaConstraints(){return{offerToReceiveAudio:!1,offerToReceiveVideo:!1}}defaultSubscribeMediaConstraints(){return{offerToReceiveAudio:!0,offerToReceiveVideo:!0}}createRoom(e){let s={participants:9};s.pin=this.pin,s.publishers=this.audioOnly?E.a.MAX_AUDIO_PARTICIPANT_COUNT:E.a.MAX_VIDEO_PARTICIPANT_COUNT,this.conference||(s.is_private=!0),this.record&&(s.record=!0),console.log("create room"),f.default.sendConferenceRequest(this.sessionId,this.callId,"create_room",A()(s),(s,o)=>{if(console.log("create_room res",s,o),0!==s)return void e(s);let t=JSON.parse(o);this.sessionId=t.session_id,this.handleId=t.handle_id;let r=t.data;this.callId,r.room,this.keepAlive(!0),e(0),this.conference&&this.setState(h.a.STATUS_CONNECTING)})}onConferenceEvent(e){let s;if(s="string"==typeof e?JSON.parse(e):e,this.sessionId!==s.session_id)return void console.log("on conference event, unknown sessionId",this.sessionId,s.session_id);console.log("onConferenceEvent",A()(e));let o=s.data,t=o?o.videoroom:null;if("event"===t){let e=o.publishers;this.onPublish(e);let s=o.unpublished;s&&this.onUnpublish(s);let t=o.leaving;t&&("ok"===t&&"kicked"===o.reason?this.onLeave(this.selfUserInfo.uid):this.onLeave(t));let r=o.kicked;r&&this.onLeave(r);let n=o.joining;n&&this.onJoining([n]);let i=o.attendees;this.onJoining(i)}else if("destroyed"===t)this.endCall(p.a.RoomDestroyed);else if("participants"===t){let e=o.attendees;if(e&&e.length>0){let s=e.map(e=>({id:e}));this.onJoining(s)}let s=o.leavings;s&&s.length>0&&s.forEach(e=>{this.onLeave(e)})}else if("mute"===t){let e=o.mute;this.onMute(e)}else if("slowlink"===t){let e=s.handle_id;this.onSlowLink(this.sessionId,e,o)}else{"hangup"===s.janus||console.log("unknown event")}}keepAlive(e){if(e){if(this.keepAliveTimer)return;this.keepAliveTimer=setInterval(()=>{f.default.sendConferenceRequest(this.sessionId,this.callId,"keepalive","",(e,s)=>{})},2e4)}else this.keepAliveTimer&&(clearInterval(this.keepAliveTimer),this.keepAliveTimer=0)}joinAndPublish(){let e={};e.handle_id=this.handleId,e.user_id=this.selfUserInfo.uid,e.pin=this.pin,this.callExtra&&(e.extra=this.callExtra),f.default.sendConferenceRequest(this.sessionId,this.callId,"join_pub",A()(e),(e,s)=>{if(console.log("join_pub",e,s),0!==e)return void this.endCall(p.a.REASON_SignalError);let o=JSON.parse(s),t=o.data,r=t.error_code;if(r>0)return console.log("conference request, join_pub error",r),void(r===N.default.JANUS_VIDEOROOM_ERROR_NO_SUCH_ROOM?this.endCall(p.a.RoomNotExist):r===N.default.JANUS_VIDEOROOM_ERROR_ID_EXISTS&&setTimeout(()=>{this.status!==h.a.STATUS_IDLE&&(console.log("rejoin"),this.joinAndPublish())},500));this.sessionId=o.session_id,this.handleId=o.handle_id;let n=t.publishers;this.onPublish(n);t.id,t.videoroom;this.privateId=t.private_id;t.description,t.room;let i=t.attendees;this.onJoining(i),this.audience||(this.cameraPublisher=new G.default(this),this.cameraPublisher.handleId=this.handleId,this.cameraPublisher.publishMedia()),this.keepAlive(!0)})}updateInitiator(){let e,s=(new Date).getTime()+864e5;Object(C.gt)(this.acceptTime,0)&&(s=this.acceptTime,e=this.selfUserInfo.uid),this.subscriberMap.forEach(o=>{Object(C.gt)(o.acceptTime,0)&&Object(C.gt)(s,o.acceptTime)&&(s=o.acceptTime,e=o.userId)});let o=this.initiatorId;this.initiatorId=e,this.subscriberMap.forEach(e=>{e.isInitiator=this.initiatorId===e.userId}),o!==e&&e!==this.selfUserInfo.uid&&this.sessionCallback&&this.sessionCallback.didChangeInitiator(this.initiatorId)}onParticipantPublish(e){e.talking;let s=e.id;if(this.isSelfScreenSharing(s))return;let o=e.display,t=!0,r=e.streams;for(const[e,n]of this.subscriberMap)if(e===s){n.streams(r),n.callExtra=o,n.subscribe(),n.audience=!1,t=!1;break}if(t){let e=new S.default(s,this);this.subscriberMap.set(e.userId,e);let t=(new Date).valueOf();if(this.setUserAcceptTime(e.userId,t),this.setUserJoinTime(e.userId,t),e.status=h.a.STATUS_CONNECTED,e.audience=!1,e.callExtra=o,e.streams(r),e.subscribe(),this.sessionCallback){let s=this.getScreenSharingUserId(e.userId);this.sessionCallback.didParticipantJoined(s||e.userId,null!==s),this.reportAudienceChanged(e.userId,!1)}}else this.reportAudienceChanged(s,!1);let n=this.subscriberMap.get(s);(n.videoMuted||n.audioMuted)&&this.sessionCallback&&this.sessionCallback.didMuteStateChanged([s])}onPublish(e){if(console.log("onPublish",e),e)for(const s of e)this.onParticipantPublish(s)}onJoining(e){if(e){console.log("onJoining",e);for(const s of e){let e=s.id,o=!0,t=s.display;for(const[s,r]of this.subscriberMap)if(s===e){r.audience=!0,r.callExtra=t,o=!1;break}if(o){let s=new S.default(e,this);this.subscriberMap.set(s.userId,s);let o=(new Date).valueOf();if(this.setUserAcceptTime(s.userId,o),this.setUserJoinTime(s.userId,o),s.status=h.a.STATUS_CONNECTED,s.audience=!0,s.callExtra=t,this.sessionCallback){let e=this.getScreenSharingUserId(s.userId);this.sessionCallback.didParticipantJoined(e||s.userId,null!==e)}}}}}onUnpublish(e){for(const[s,o]of this.subscriberMap)if(s===e){o.audience=!0,o.videoMuted=!1,o.audioMuted=!1,o.peerConnection&&(o.peerConnection.close(),o.peerConnection=null),o.handleId=0;break}this.conference&&e!==this.selfUserInfo.uid&&this.reportAudienceChanged(e,!0)}reportAudienceChanged(e,s){let o=this.getScreenSharingUserId(e);this.sessionCallback&&this.sessionCallback.didChangeType(o||e,s,null!==o)}onSlowLink(e,s,o){if(!this.sessionCallback)return;let t=o.media,r=o.uplink,n=o.lost;if(this.handleId===s)this.sessionCallback.didMediaLostPacket(t,n,!1);else if(this.screenSharingPublisher&&this.screenSharingPublisher.handleId===s)this.sessionCallback.didMediaLostPacket(t,n,!0);else for(const[e,o]of this.subscriberMap)if(o.handleId===s){if(e.startsWith("screen_sharing_")){let s=e.substr("screen_sharing_".length);this.sessionCallback.didUserMediaLostPacket(s,t,n,r,!0)}else this.sessionCallback.didUserMediaLostPacket(e,t,n,r,!1);break}}onLeave(e){this.getSubscriber(e)?this.endUserCall(e,p.a.REASON_RemoteHangup):e===this.selfUserInfo.uid&&this.endCall(p.a.REASON_Hangup,!1)}mediaStream(){return this.screenShareStream?this.screenShareStream:this.cameraVideoStream}requestChangeMode(e,s){let o=new O.a(this.callId,s),t=new w.a(M.a.Single,e,0);f.default.sendSignalMessageEx(t,o,this.getParticipantIds(),!1)}onRequestChangeMode(e){this.switchAudience(e)}onKickoff(){this.leaveConference(!1)}switchAudience(e){var s=this;return l()((function*(){s.conference&&(e?s.audience||(s.audience=!0,s.cameraPublisher.unPublishMedia(),s.reportAudienceChanged(s.selfUserInfo.uid,!0)):(s.audience=!1,s.cameraPublisher=new G.default(s),s.cameraPublisher.handleId=s.handleId,yield s.cameraPublisher.publishMedia(),s.reportAudienceChanged(s.selfUserInfo.uid,!1)))}))()}onMute(e){let s=[];this.subscriberMap.forEach((o,t)=>{let r=e[t],n=!1,i=!1;r&&(n=!!r.hasOwnProperty("a")&&r.a,i=!!r.hasOwnProperty("v")&&r.v),o.videoMuted===i&&o.audioMuted===n||(o.videoMuted=i,o.audioMuted=n,o.audience||s.push(t))}),s=s.filter(e=>e!==this.selfUserInfo.uid),s.length>0&&this.sessionCallback&&this.sessionCallback.didMuteStateChanged(s)}notifyMuteState(){if(!this.conference||this.status===h.a.STATUS_IDLE)return;let e={handle_id:this.handleId,a:this.audioMuted};E.a.SCREEN_SHARING_REPLACE_MODE?e.v=this.videoMuted&&!this.isScreenSharing():e.v=this.videoMuted,f.default.sendConferenceRequest(this.sessionId,this.callId,"mute",A()(e),(e,s)=>{console.log("mute res",e,s)})}kickoffParticipant(e,s,o){if(this.status===h.a.STATUS_IDLE&&o&&o(-1),this.getSubscriber(e)){let t={handle_id:this.handleId,user:e};f.default.sendConferenceRequest(this.sessionId,this.callId,"kick",A()(t),(e,t)=>{console.log("kick res",e,t),0===e?s&&s():o&&o(e)})}}closeVoipWindow(){localStorage.getItem("enable_voip_debug")||(P.a.useIframe?P.a.emitToMain("close-iframe-window"):g.currentWindow?g.currentWindow.close():window.close())}setAudioInputDeviceId(e){console.log("setInputAudioDeviceId",this.audioInputDeviceId,e),e="null"===e?null:e,this.audioInputDeviceId=e,this.cameraPublisher&&this.cameraPublisher.createMediaSenders()}setVideoInputDeviceId(e){console.log("setVideoInputDeviceId",this.videoInputDeviceId,e),e="null"===e?null:e,this.videoInputDeviceId=e,this.cameraPublisher&&(this.cameraPublisher.stopVideoStream(this.cameraPublisher.cameraVideoStream),this.cameraPublisher.createMediaSenders())}switchCamera(){return!!navigator.mediaDevices.getSupportedConstraints().facingMode&&("user"===this.videoCamera?this.videoCamera="environment":this.videoCamera="user",console.log("switch camera",this.videoCamera),this.cameraPublisher.stopVideoStream(this.cameraPublisher.cameraVideoStream),this.cameraPublisher.createMediaSenders(),!0)}rotate(e){console.log("rotate",e),this.cameraPublisher&&this.cameraPublisher.rotate(e)}screenSharingId(){return"screen_sharing_"+this.selfUserInfo.uid}getScreenSharingUserId(e=""){return e.startsWith("screen_sharing_")?e.substr("screen_sharing_".length):null}isSelfScreenSharing(e=""){return this.screenSharingId()===e}setVideoMaxBitrate(e){this.cameraPublisher&&this.cameraPublisher.setVideoMaxBitrate(e)}scaleVideoResolutionDownBy(e){this.cameraPublisher&&this.cameraPublisher.scaleVideoResolutionDownBy(e)}dumpStats(e){let s="";return e.forEach(e=>{s+="<h3>Report type=",s+=e.type,s+="</h3>\n",s+=`id ${e.id}<br>`,s+=`time ${e.timestamp}<br>`,r()(e).forEach(o=>{"timestamp"!==o&&"type"!==o&&"id"!==o&&("object"==typeof e[o]?s+=`${o}: ${A()(e[o])}<br>`:s+=`${o}: ${e[o]}<br>`)})}),s}showRemoteStats(e,s){const o=this.dumpStats(s);localStorage.getItem("enable_voip_debug.stats")&&console.log("statsString",e,o),s.forEach(s=>{const o=s.timestamp;let t;if("inbound-rtp"===s.type&&"video"===s.mediaType){const e=s.bytesReceived;this.timestampPrev&&(t=8*(e-this.bytesPrev)/(o-this.timestampPrev),t=Math.floor(t)),this.bytesPrev=e,this.timestampPrev=o}t&&(t+=" kbits/sec",console.log("Bitrate:",e,t))})}setParticipantVideoType(e,s,o){s&&(e=this.getScreenSharingUserId(e));for(const[s,t]of this.subscriberMap)if(Object(C.gt)(t.acceptTime,0)&&e===s){t.setVideoType(o);break}}}},"./av/internal/publisherImpl.js":function(e,s,o){"use strict";o.r(s),o.d(s,"default",(function(){return b}));var t=o("./node_modules/babel-runtime/core-js/json/stringify.js"),r=o.n(t),n=o("./node_modules/babel-runtime/helpers/asyncToGenerator.js"),i=o.n(n),a=o("../engine/callState"),l=o.n(a),c=o("./av/internal/avenginekitImpl.js"),d=o("./av/internal/roomErrorCode.js"),u=o("../engine/callEndReason"),A=o.n(u),m=o("../engine/avenginekit"),h=o.n(m),f=o("../engine/videoProfile"),_=o.n(f),p=o("./av/internal/soundMeter.js");class b{constructor(e){this.callSession=e}createMediaSenders(){var e=this;return i()((function*(){let s;if(e.cameraVideoStream=yield e.callSession.createLocalCameraVideoStream(e.callSession.audioOnly||e.callSession.videoMuted||h.a.SCREEN_SHARING_REPLACE_MODE&&e.callSession.isScreenSharing()),e.cameraVideoStream)s=e.cameraVideoStream.getAudioTracks()[0];else{if(!e.callSession.audioOnly){let o=yield e.callSession.createLocalCameraVideoStream(!0);o&&(s=o.getAudioTracks()[0])}if(e.cameraVideoStream=yield e.createDummyVideoStream(),s){let o=e.cameraVideoStream.getAudioTracks()[0];e.cameraVideoStream.removeTrack(o),e.cameraVideoStream.addTrack(s)}else s=e.cameraVideoStream.getAudioTracks()[0]}e.dummyVideoStream||(e.dummyVideoStream=yield e.createDummyVideoStream()),s.enabled=!e.callSession.audioMuted,s.onended=function(){e.callSession.status!==l.a.STATUS_IDLE&&(console.log("audio track ended, re-createMediaSenders"),e.audioInputDeviceId=null,e.stopVideoTrack(e.cameraVideoStream),e.cameraVideoStream=null,e.createMediaSenders())};let o=e.peerConnection,t=e.callSession.videoMuted?e.dummyVideoStream:e.cameraVideoStream;if(e.callSession.audioOnly)e.audioSender?e.audioSender.replaceTrack(s):e.audioSender=o.addTrack(s,t);else{e.audioSender?e.audioSender.replaceTrack(s):e.audioSender=o.addTrack(s,t);let r=_.a.getVideoProfile(h.a.VIDEO_PROFILE);if(h.a.SCREEN_SHARING_REPLACE_MODE&&e.callSession.isScreenSharing())e.setVideoMaxBitrate(r.bitrate);else{let s=new MediaStream([t.getVideoTracks()[0]]),n=t;if(e.callSession.rotateAng&&e.callSession.sessionCallback.onRotateStream&&(n=e.callSession.sessionCallback.onRotateStream(s,e.callSession.rotateAng),e.callSession.sessionCallback.didRotateLocalVideoTrack&&(n.addTrack(e.cameraVideoStream.getAudioTracks()[0]),e.callSession.sessionCallback.didRotateLocalVideoTrack(n))),e.videoSender?e.videoSender.replaceTrack(n.getVideoTracks()[0]):e.videoSender=o.addTrack(n.getVideoTracks()[0]),!h.a.DISABLE_DUAL_STREAM){let r;if(e.callSession.rotateAng&&e.callSession.sessionCallback.onRotateStream){r=e.callSession.sessionCallback.onRotateStream(s,e.callSession.rotateAng,{width:200,height:200}).getVideoTracks()[0]}else{r=t.getVideoTracks()[0].clone();try{yield r.applyConstraints(e.tinyVideoTrackConstraints())}catch(s){console.log("smallCameraVideoTrack applyConstraints error",s,r.getCapabilities(),e.tinyVideoTrackConstraints())}}e.smallVideoSender?e.smallVideoSender.replaceTrack(r):e.smallVideoSender=o.addTrack(r)}e.setVideoMaxBitrate(r.bitrate)}}e.soundMeter&&(e.soundMeter.stop(),e.soundMeter=null);let r=new p.SoundMeter(window.audioContext);r.connectToSource(e.cameraVideoStream,(function(e){console.log("connect to self soundMeter",e)})),e.soundMeter=r,console.log("Added local stream to pc")}))()}publishMedia(){var e=this;return i()((function*(){e.peerConnection=e.callSession.createPeerConnection(e.callSession.selfUserInfo.uid),yield e.createMediaSenders();try{let s=yield e.peerConnection.createOffer(e.callSession.defaultPublishMediaConstraints());yield e.peerConnection.setLocalDescription(s);let o={};o.session_id=e.callSession.sessionId,o.handle_id=e.handleId;let t={request:"configure",audio:!0,video:!0};t.pin=e.pin,o.body=t;let n={};n.sdp=s.sdp,n.type="offer",o.jsep=n,c.default.sendConferenceRequest(e.callSession.sessionId,e.callSession.callId,"message",r()(o),(function(s,o){if(0!==s)return void console.log("conference request, message, error",s);let t=JSON.parse(o);if(e.callSession.sessionId!==t.session_id)return void console.log("conference request, message unknown sessionId",e.sessionId,t.session_id);let r=t.jsep;if(r&&"answer"===r.type)e.peerConnection.setRemoteDescription(r);else{let s=t.plugindata;if(s){let o=s.data;if(o){o.error_code===d.default.JANUS_VIDEOROOM_ERROR_PUBLISHERS_FULL?e.callSession.status===l.a.STATUS_CONNECTED?(e.unPublishMedia(),e.callSession.audience=!0,e.callSession.sessionCallback&&e.callSession.sessionCallback.didChangeType(e.callSession.selfUserInfo.uid,!0)):e.callSession.status!==l.a.STATUS_IDLE&&e.callSession.endCall(A.a.RoomParticipantsFull):e.callSession.endCall(A.a.REASON_SignalError)}}}}))}catch(s){e.callSession.endCall(A.a.REASON_MediaError)}}))()}unPublishMedia(){this.peerConnection&&(this.peerConnection.close(),this.peerConnection=null,this.audioSender=null,this.videoSender=null,this.smallVideoSender=null),this.stopVideoStream(this.cameraVideoStream);let e={};e.handle_id=this.handleId,e.pin=this.callSession.pin,c.default.sendConferenceRequest(this.callSession.sessionId,this.callSession.callId,"unpublish",r()(e),(e,s)=>{e>0&&this.callSession.endCall(A.a.REASON_SignalError)})}rotate(e){var s=this;return i()((function*(){if(s.callSession.rotateAng!==e&&(s.callSession.rotateAng=e,!s.callSession.videoMuted&&s.cameraVideoStream&&s.cameraVideoStream.getVideoTracks().length>0&&s.cameraVideoStream.getVideoTracks()[0]&&s.callSession.sessionCallback.onRotateStream)){let o=new MediaStream([s.cameraVideoStream.getVideoTracks()[0]]),t=s.callSession.sessionCallback.onRotateStream(o,e);if(s.callSession.sessionCallback.didRotateLocalVideoTrack&&s.callSession.sessionCallback.didRotateLocalVideoTrack(new MediaStream([t.getVideoTracks()[0],s.cameraVideoStream.getAudioTracks()[0]])),s.videoSender&&s.videoSender.replaceTrack(t.getVideoTracks()[0]),s.smallVideoSender){let t=s.callSession.sessionCallback.onRotateStream(o,e,{width:200,height:200});s.smallVideoSender.replaceTrack(t.getVideoTracks()[0])}}}))()}endMedia(){this.peerConnection&&(this.peerConnection.close(),this.peerConnection=null),this.stopVideoStream(this.cameraVideoStream),this.soundMeter&&(this.soundMeter.stop(),this.soundMeter=null),this.cameraVideoStream=null,this.audioSender=null,this.videoSender=null,this.smallVideoSender=null}createDummyVideoStream(){return i()((function*(){const e=document.createElement("video");e.autoplay=!0,e.loop=!0,e.volume=.5,e.src="data:video/mp4;base64,AAAAIGZ0eXBpc29tAAACAGlzb21pc28yYXZjMW1wNDEAAAAIZnJlZQAABZJtZGF0AAACrgYF//+q3EXpvebZSLeWLNgg2SPu73gyNjQgLSBjb3JlIDE2MSByMzAyNyA0MTIxMjc3IC0gSC4yNjQvTVBFRy00IEFWQyBjb2RlYyAtIENvcHlsZWZ0IDIwMDMtMjAyMCAtIGh0dHA6Ly93d3cudmlkZW9sYW4ub3JnL3gyNjQuaHRtbCAtIG9wdGlvbnM6IGNhYmFjPTEgcmVmPTMgZGVibG9jaz0xOjA6MCBhbmFseXNlPTB4MzoweDExMyBtZT1oZXggc3VibWU9NyBwc3k9MSBwc3lfcmQ9MS4wMDowLjAwIG1peGVkX3JlZj0xIG1lX3JhbmdlPTE2IGNocm9tYV9tZT0xIHRyZWxsaXM9MSA4eDhkY3Q9MSBjcW09MCBkZWFkem9uZT0yMSwxMSBmYXN0X3Bza2lwPTEgY2hyb21hX3FwX29mZnNldD0tMiB0aHJlYWRzPTYgbG9va2FoZWFkX3RocmVhZHM9MSBzbGljZWRfdGhyZWFkcz0wIG5yPTAgZGVjaW1hdGU9MSBpbnRlcmxhY2VkPTAgYmx1cmF5X2NvbXBhdD0wIGNvbnN0cmFpbmVkX2ludHJhPTAgYmZyYW1lcz0zIGJfcHlyYW1pZD0yIGJfYWRhcHQ9MSBiX2JpYXM9MCBkaXJlY3Q9MSB3ZWlnaHRiPTEgb3Blbl9nb3A9MCB3ZWlnaHRwPTIga2V5aW50PTI1MCBrZXlpbnRfbWluPTI1IHNjZW5lY3V0PTQwIGludHJhX3JlZnJlc2g9MCByY19sb29rYWhlYWQ9NDAgcmM9Y3JmIG1idHJlZT0xIGNyZj0yMy4wIHFjb21wPTAuNjAgcXBtaW49MCBxcG1heD02OSBxcHN0ZXA9NCBpcF9yYXRpbz0xLjQwIGFxPTE6MS4wMACAAAAANGWIhAA7//73Tr8Cm1TCKgOSVwr2yqQmWblSawJGXYUqrq2Pk7OdTgAAE+AFwMk12oNQ+eEAAAAMQZokbEO//qmWAAy43gIATGF2YzU4LjkxLjEwMABCIAjBGDgAAAAJQZ5CeIX/AA7pIRAEYIwcIRAEYIwcAAAACQGeYXRCvwAUkCEQBGCMHCEQBGCMHAAAAAkBnmNqQr8AFJEhEARgjBwhEARgjBwAAAASQZpoSahBaJlMCHf//qmWAAy5IRAEYIwcAAAAC0GehkURLC//AA7pIRAEYIwcIRAEYIwcAAAACQGepXRCvwAUkSEQBGCMHCEQBGCMHAAAAAkBnqdqQr8AFJAhEARgjBwhEARgjBwAAAASQZqsSahBbJlMCHf//qmWAAy4IRAEYIwcAAAAC0GeykUVLC//AA7pIRAEYIwcIRAEYIwcAAAACQGe6XRCvwAUkCEQBGCMHCEQBGCMHAAAAAkBnutqQr8AFJAhEARgjBwAAAASQZrwSahBbJlMCG///qeEABlRIRAEYIwcIRAEYIwcAAAAC0GfDkUVLC//AA7pIRAEYIwcIRAEYIwcAAAACQGfLXRCvwAUkSEQBGCMHCEQBGCMHAAAAAkBny9qQr8AFJAhEARgjBwAAAASQZs0SahBbJlMCG///qeEABlQIRAEYIwcIRAEYIwcAAAAC0GfUkUVLC//AA7pIRAEYIwcIRAEYIwcAAAACQGfcXRCvwAUkCEQBGCMHCEQBGCMHAAAAAkBn3NqQr8AFJAhEARgjBwAAAASQZt4SahBbJlMCF///oywAGNBIRAEYIwcIRAEYIwcAAAAC0GflkUVLC//AA7oIRAEYIwcIRAEYIwcAAAACQGftXRCvwAUkSEQBGCMHAAAAAkBn7dqQr8AFJEhEARgjBwhEARgjBwAAAARQZu5SahBbJlMCFf//jhAAYEhEARgjBwhEARgjBwhEARgjBwAAAihbW9vdgAAAGxtdmhkAAAAAAAAAAAAAAAAAAAD6AAABBAAAQAAAQAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAA/Z0cmFrAAAAXHRraGQAAAADAAAAAAAAAAAAAAABAAAAAAAABBAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAABAAAAAAMgAAADIAAAAAAAkZWR0cwAAABxlbHN0AAAAAAAAAAEAAAQQAAAEAAABAAAAAANubWRpYQAAACBtZGhkAAAAAAAAAAAAAAAAAAAyAAAANABVxAAAAAAALWhkbHIAAAAAAAAAAHZpZGUAAAAAAAAAAAAAAABWaWRlb0hhbmRsZXIAAAADGW1pbmYAAAAUdm1oZAAAAAEAAAAAAAAAAAAAACRkaW5mAAAAHGRyZWYAAAAAAAAAAQAAAAx1cmwgAAAAAQAAAtlzdGJsAAAArXN0c2QAAAAAAAAAAQAAAJ1hdmMxAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAMgAyABIAAAASAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAGP//AAAAN2F2Y0MBZAAM/+EAGmdkAAys2UNG+WXARAAAAwAEAAADAMg8UKZYAQAGaOvjyyLA/fj4AAAAABBwYXNwAAAAAQAAAAEAAAAYc3R0cwAAAAAAAAABAAAAGgAAAgAAAAAUc3RzcwAAAAAAAAABAAAAAQAAAOBjdHRzAAAAAAAAABoAAAABAAAEAAAAAAEAAAoAAAAAAQAABAAAAAABAAAAAAAAAAEAAAIAAAAAAQAACgAAAAABAAAEAAAAAAEAAAAAAAAAAQAAAgAAAAABAAAKAAAAAAEAAAQAAAAAAQAAAAAAAAABAAACAAAAAAEAAAoAAAAAAQAABAAAAAABAAAAAAAAAAEAAAIAAAAAAQAACgAAAAABAAAEAAAAAAEAAAAAAAAAAQAAAgAAAAABAAAKAAAAAAEAAAQAAAAAAQAAAAAAAAABAAACAAAAAAEAAAQAAAAAKHN0c2MAAAAAAAAAAgAAAAEAAAACAAAAAQAAAAIAAAABAAAAAQAAAHxzdHN6AAAAAAAAAAAAAAAaAAAC6gAAABAAAAANAAAADQAAAA0AAAAWAAAADwAAAA0AAAANAAAAFgAAAA8AAAANAAAADQAAABYAAAAPAAAADQAAAA0AAAAWAAAADwAAAA0AAAANAAAAFgAAAA8AAAANAAAADQAAABUAAAB0c3RjbwAAAAAAAAAZAAAAMAAAA0EAAANaAAADcwAAA4wAAAOoAAADwwAAA9wAAAP1AAAEEQAABCwAAARFAAAEWAAABHoAAASVAAAErgAABMEAAATjAAAE/gAABRcAAAUqAAAFTAAABWcAAAV6AAAFkwAAA9V0cmFrAAAAXHRraGQAAAADAAAAAAAAAAAAAAACAAAAAAAAA/4AAAAAAAAAAAAAAAEBAAAAAAEAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAkZWR0cwAAABxlbHN0AAAAAAAAAAEAAAPmAAAEAAABAAAAAANNbWRpYQAAACBtZGhkAAAAAAAAAAAAAAAAAACsRAAAsABVxAAAAAAALWhkbHIAAAAAAAAAAHNvdW4AAAAAAAAAAAAAAABTb3VuZEhhbmRsZXIAAAAC+G1pbmYAAAAQc21oZAAAAAAAAAAAAAAAJGRpbmYAAAAcZHJlZgAAAAAAAAABAAAADHVybCAAAAABAAACvHN0YmwAAABqc3RzZAAAAAAAAAABAAAAWm1wNGEAAAAAAAAAAQAAAAAAAAAAAAIAEAAAAACsRAAAAAAANmVzZHMAAAAAA4CAgCUAAgAEgICAF0AVAAAAAAH0AAAACJgFgICABRIQVuUABoCAgAECAAAAGHN0dHMAAAAAAAAAAQAAACwAAAQAAAAAxHN0c2MAAAAAAAAADwAAAAEAAAABAAAAAQAAAAIAAAACAAAAAQAAAAUAAAABAAAAAQAAAAYAAAACAAAAAQAAAAkAAAABAAAAAQAAAAoAAAACAAAAAQAAAAwAAAABAAAAAQAAAA0AAAACAAAAAQAAABAAAAABAAAAAQAAABEAAAACAAAAAQAAABQAAAABAAAAAQAAABUAAAACAAAAAQAAABcAAAABAAAAAQAAABgAAAACAAAAAQAAABkAAAADAAAAAQAAAMRzdHN6AAAAAAAAAAAAAAAsAAAAFwAAAAYAAAAGAAAABgAAAAYAAAAGAAAABgAAAAYAAAAGAAAABgAAAAYAAAAGAAAABgAAAAYAAAAGAAAABgAAAAYAAAAGAAAABgAAAAYAAAAGAAAABgAAAAYAAAAGAAAABgAAAAYAAAAGAAAABgAAAAYAAAAGAAAABgAAAAYAAAAGAAAABgAAAAYAAAAGAAAABgAAAAYAAAAGAAAABgAAAAYAAAAGAAAABgAAAAYAAAB0c3RjbwAAAAAAAAAZAAADKgAAA04AAANnAAADgAAAA6IAAAO3AAAD0AAAA+kAAAQLAAAEIAAABDkAAARSAAAEbgAABIkAAASiAAAEuwAABNcAAATyAAAFCwAABSQAAAVAAAAFWwAABXQAAAWHAAAFqAAAABpzZ3BkAQAAAHJvbGwAAAACAAAAAf//AAAAHHNiZ3AAAAAAcm9sbAAAAAEAAAAsAAAAAQAAAGJ1ZHRhAAAAWm1ldGEAAAAAAAAAIWhkbHIAAAAAAAAAAG1kaXJhcHBsAAAAAAAAAAAAAAAALWlsc3QAAAAlqXRvbwAAAB1kYXRhAAAAAQAAAABMYXZmNTguNDUuMTAw",e.load();try{yield e.play()}catch(e){console.log("video auto play error",e)}let s=null;return e.captureStream?s=e.captureStream():e.mozCaptureStream?s=e.mozCaptureStream():(console.log("video captureStream() not supported, fallback to canvas"),s=document.createElement("canvas").captureStream(60)),s}))()}tinyVideoTrackConstraints(){let e=h.a.SMALL_STREAM_WIDTH?h.a.SMALL_STREAM_WIDTH:200,s=h.a.SMALL_STREAM_HEIGHT?h.a.SMALL_STREAM_HEIGHT:200,o={width:{ideal:e,max:e},height:{ideal:s,max:s}};return h.a.DISABLE_SMALL_STREAM_LOW_FPS?h.a.SMALL_STREAM_FPS&&(o.frameRate={ideal:h.a.SMALL_STREAM_FPS,max:h.a.SMALL_STREAM_FPS}):o.frameRate={max:8,ideal:8},o}setVideoMaxBitrate(e){let s=e;this.videoSender&&this.setVideoSenderMaxBitrate(this.videoSender,s),this.smallVideoSender&&this.setVideoSenderMaxBitrate(this.smallVideoSender,s)}setVideoSenderMaxBitrate(e,s){const o=e.getParameters();o.encodings||(o.encodings=[{}]),o.encodings.length<1?console.log("setVideoSenderMaxBitrate error: no encodings"):(o.encodings[0].maxBitrate=1e3*s,e.setParameters(o).catch(e=>{console.log("set maxBitrate error",e)}))}scaleVideoResolutionDownBy(e){console.log("scaleVideoResolutionDownBy",e),this.videoSender&&this.scaleVideoSenderVideoResolutionDownBy(this.videoSender,e),this.smallVideoSender&&this.scaleVideoSenderVideoResolutionDownBy(this.smallVideoSender,e)}scaleVideoSenderVideoResolutionDownBy(e,s){const o=e.getParameters();o.encodings||(o.encodings=[{}]),o.encodings.length<1?console.log("scaleVideoResolutionDownBy error: no encodings"):(o.encodings[0].scaleResolutionDownBy=s,e.setParameters(o).catch(e=>{console.log("set scaleVideoResolutionDownBy error",e)}))}stopVideoTrack(e){e&&e.getTracks().forEach(e=>{"video"===e.kind&&e.stop()}),this.smallVideoSender&&this.smallVideoSender.track&&this.smallVideoSender.track.stop()}stopVideoStream(e){e&&(void 0===e.getTracks?e.stop():e.getTracks().forEach(e=>{console.log("stop track",e.kind,e.id),e.stop()}),this.smallVideoSender&&this.smallVideoSender.track&&this.smallVideoSender.track.stop())}}},"./av/internal/roomErrorCode.js":function(e,s,o){"use strict";o.r(s),o.d(s,"default",(function(){return t}));class t{}t.JANUS_VIDEOROOM_ERROR_UNKNOWN_ERROR=499,t.JANUS_VIDEOROOM_ERROR_NO_MESSAGE=421,t.JANUS_VIDEOROOM_ERROR_INVALID_JSON=422,t.JANUS_VIDEOROOM_ERROR_INVALID_REQUEST=423,t.JANUS_VIDEOROOM_ERROR_JOIN_FIRST=424,t.JANUS_VIDEOROOM_ERROR_ALREADY_JOINED=425,t.JANUS_VIDEOROOM_ERROR_NO_SUCH_ROOM=426,t.JANUS_VIDEOROOM_ERROR_ROOM_EXISTS=427,t.JANUS_VIDEOROOM_ERROR_NO_SUCH_FEED=428,t.JANUS_VIDEOROOM_ERROR_MISSING_ELEMENT=429,t.JANUS_VIDEOROOM_ERROR_INVALID_ELEMENT=430,t.JANUS_VIDEOROOM_ERROR_INVALID_SDP_TYPE=431,t.JANUS_VIDEOROOM_ERROR_PUBLISHERS_FULL=432,t.JANUS_VIDEOROOM_ERROR_UNAUTHORIZED=433,t.JANUS_VIDEOROOM_ERROR_ALREADY_PUBLISHED=434,t.JANUS_VIDEOROOM_ERROR_NOT_PUBLISHED=435,t.JANUS_VIDEOROOM_ERROR_ID_EXISTS=436,t.JANUS_VIDEOROOM_ERROR_INVALID_SDP=437},"./av/internal/screenSharingPublisherImpl.js":function(e,s,o){"use strict";o.r(s),o.d(s,"default",(function(){return b}));var t=o("./node_modules/babel-runtime/core-js/json/stringify.js"),r=o.n(t),n=o("./node_modules/babel-runtime/helpers/asyncToGenerator.js"),i=o.n(n),a=o("../engine/videoProfile"),l=o.n(a),c=o("../engine/avenginekit"),d=o.n(c),u=o("./av/internal/publisherImpl.js"),A=o("./av/internal/avenginekitImpl.js"),m=o("./av/internal/roomErrorCode.js"),h=o("../engine/callEndReason"),f=o.n(h),_=o("../engine/callState"),p=o.n(_);class b extends u.default{constructor(e){super(e)}createMediaSenders(){var e=this;return i()((function*(){let s=e.peerConnection,o=e.callSession.screenShareStream;e.cameraVideoStream=o;let t=o;if(e.callSession.rotateAng&&e.callSession.sessionCallback.onRotateStream&&(t=e.callSession.sessionCallback.onRotateStream(e.cameraVideoStream,e.callSession.rotateAng),e.callSession.sessionCallback.didRotateLocalVideoTrack&&e.callSession.sessionCallback.didRotateLocalVideoTrack(new MediaStream([t.getVideoTracks()[0]]))),e.videoSender=s.addTrack(t.getVideoTracks()[0],o),!d.a.DISABLE_DUAL_STREAM){let t;if(e.callSession.rotateAng&&e.callSession.sessionCallback.onRotateStream){t=e.callSession.sessionCallback.onRotateStream(e.cameraVideoStream,e.callSession.rotateAng,{width:200,height:200}).getVideoTracks()[0]}else t=o.getVideoTracks()[0].clone(),yield t.applyConstraints(e.tinyVideoTrackConstraints());yield t.applyConstraints(e.tinyVideoTrackConstraints()),e.smallVideoSender=s.addTrack(t)}let r=l.a.getVideoProfile(d.a.VIDEO_PROFILE);e.setVideoMaxBitrate(r.bitrate)}))()}attachAndPublishScreenSharing(){let e={};e.session_id=this.callSession.sessionId,e.handle_id=this.handleId,e.user_id=this.callSession.screenSharingId(),e.pin=this.callSession.pin,this.callSession.callExtra&&(e.extra=this.callSession.callExtra),A.default.sendConferenceRequest(this.callSession.sessionId,this.callSession.callId,"join_pub_ss",r()(e),(e,s)=>{if(0!==e)return void console.log("conference request, join_pub_ss, error",e);let o=JSON.parse(s);this.handleId=o.handle_id;let t=o.data.error_code;t>0?t===m.default.JANUS_VIDEOROOM_ERROR_NO_SUCH_ROOM?this.callSession.endCall(f.a.RoomNotExist):e===m.default.JANUS_VIDEOROOM_ERROR_ID_EXISTS?this.reattachAndPublish():this.callSession.endCall(f.a.REASON_SignalError):this.publishMedia()})}reattachAndPublish(){setTimeout(()=>{this.callSession.static!==p.a.STATUS_IDLE&&this.attachAndPublishScreenSharing()},5e3)}deattach(){let e={};e.session_id=this.callSession.sessionId,e.handle_id=this.handleId,e.pin=this.callSession.pin,A.default.sendConferenceRequest(this.callSession.sessionId,this.callSession.callId,"deattach",r()(e),(e,s)=>{0!==e&&(console.log("conference request, ss-deattach, error",e),this.callSession.endCall(f.a.REASON_SignalError))})}}},"./av/internal/soundMeter.js":function(e,s,o){"use strict";function t(e){this.context=e,this.instant=0,this.slow=0,this.clip=0,this.script=e.createScriptProcessor(2048,1,1);const s=this;this.script.onaudioprocess=function(e){const o=e.inputBuffer.getChannelData(0);let t,r=0,n=0;for(t=0;t<o.length;++t)r+=o[t]*o[t],Math.abs(o[t])>.99&&(n+=1);s.instant=Math.sqrt(r/o.length),s.slow=.95*s.slow+.05*s.instant,s.clip=n/o.length}}o.r(s),o.d(s,"SoundMeter",(function(){return t})),t.prototype.connectToSource=function(e,s){console.log("SoundMeter connecting");try{this.mic=this.context.createMediaStreamSource(e),this.mic.connect(this.script),this.script.connect(this.context.destination),void 0!==s&&s(null)}catch(e){console.error(e),void 0!==s&&s(e)}},t.prototype.stop=function(){console.log("SoundMeter stopping"),this.mic.disconnect(),this.script.disconnect()}},"./av/internal/subscriberImpl.js":function(e,s,o){"use strict";o.r(s),o.d(s,"default",(function(){return A}));var t=o("./node_modules/babel-runtime/helpers/asyncToGenerator.js"),r=o.n(t),n=o("./node_modules/babel-runtime/core-js/json/stringify.js"),i=o.n(n),a=o("../engine/subscriber"),l=o.n(a),c=o("./av/internal/avenginekitImpl.js"),d=(o("../engine/avenginekit"),o("../engine/videoType")),u=o.n(d);class A extends l.a{constructor(e,s){super(),this.tickSinceLastFramesDecoded=0,this.availableVideoMids=[],this.ready=!1,this.userId=e,this.callSession=s,this.availableVideoMids=[],this.videoType=s.defaultVideoType,this.currentVideoType=this.videoType}subscribe(){if(this.handleId)return;this.ready=!1;let e={};e.feed=this.userId,e.pin=this.callSession.pin;let s=[];s.push({feed:this.userId,mid:"0"}),this.callSession.audioOnly||(this.availableVideoMids.length>1?this.videoType===u.a.BIG_STREAM?s.push({feed:this.userId,mid:this.availableVideoMids[0]}):this.videoType===u.a.SMALL_STREAM&&s.push({feed:this.userId,mid:this.availableVideoMids[1]}):1===this.availableVideoMids.length&&s.push({feed:this.userId,mid:this.availableVideoMids[0]})),e.streams=s,c.default.sendConferenceRequestEx(this.callSession.sessionId,this.callSession.callId,"join_sub",i()(e),this.callSession.advance,(e,s)=>{if(0!==e)return void console.log("join_sub error",e);let o=JSON.parse(s),t=o.session_id;if(t!==this.callSession.sessionId)return void console.log("join response, unknown sessionId",this.callSession.sessionId,t);this.handleId=o.handle_id;let r=o.jsep;console.log("call subscribeMedia",r),this.subscribeMedia(r)})}subscribeMedia(e){var s=this;return r()((function*(){if(console.log("subscribeMedia",e),e){s.peerConnection||(yield s.callSession.createPeerConnection(s.userId));try{yield s.peerConnection.setRemoteDescription(e);let o=yield s.peerConnection.createAnswer(s.callSession.defaultSubscribeMediaConstraints());yield s.peerConnection.setLocalDescription(o);let t={};t.session_id=s.callSession.sessionId,t.handle_id=s.handleId;let r={request:"start"};r.room=s.callSession.callId,t.body=r;let n={};n.sdp=o.sdp,n.type="answer",t.jsep=n,c.default.sendConferenceRequestEx(s.callSession.sessionId,s.callSession.callId,"message",i()(t),s.callSession.advance,(function(e,o){0===e?s.setReady(!0):console.log("conference request, message error",e)}))}catch(e){console.log("subscribeMedia error",s.userId,e)}}}))()}streams(e){e&&(this.availableVideoMids.length=0,e.forEach(e=>{if("video"===e.type){let s=e.mid;this.availableVideoMids.push(s)}}))}subscribeStream(e,s){let o={handle_id:this.handleId,feed:this.userId};e&&(o.subscribe=[{feed:this.userId,mid:e}]),s&&(o.unsubscribe=[{feed:this.userId,mid:s}]),console.log("wfc update request",o),c.default.sendConferenceRequestEx(this.callSession.sessionId,this.callSession.callId,"update",i()(o),this.callSession.advance,(e,s)=>{if(0!==e)return void console.log("wfc conference request, message error",e);console.log("wfc subscribe stream response",o);let t=JSON.parse(s).jsep;t&&this.subscribeMedia(t)})}switchTo(e){let s={handle_id:this.handleId,feed:this.userId};s.streams=[{feed:this.userId,mid:e,sub_mid:"1"}],console.log("wfc switch request",s),c.default.sendConferenceRequestEx(this.callSession.sessionId,this.callSession.callId,"switch",i()(s),this.callSession.advance,(e,s)=>{0!==e?console.log("wfc conference switch request, message error",e):this.setReady(!0)})}setReady(e){this.ready=e,e&&this.setVideoType(this.videoType)}setVideoType(e){if(console.log("av setVideoType",this.videoType,this.currentVideoType,e),(this.videoType!==e||this.currentVideoType!==e)&&!this.callSession.audioOnly&&0!==this.availableVideoMids.length&&(1!==this.availableVideoMids.length||e!==u.a.SMALL_STREAM)&&this.handleId&&(this.videoType=e,this.ready))if(this.setReady(!1),this.currentVideoType!==e)if(console.log("av setVideoType to",e),this.currentVideoType===u.a.NONE){let s=e===u.a.BIG_STREAM?this.availableVideoMids[0]:this.availableVideoMids[1];this.subscribeStream(s,null),this.currentVideoType=e}else if(e===u.a.NONE){let s=this.currentVideoType===u.a.BIG_STREAM?this.availableVideoMids[0]:this.availableVideoMids[1];this.subscribeStream(null,s),this.currentVideoType=e}else{let s=e===u.a.BIG_STREAM?this.availableVideoMids[0]:this.availableVideoMids[1];this.currentVideoType=e,this.switchTo(s)}else this.setVideoType(!0)}}},"./node_modules/babel-runtime/core-js/json/stringify.js":function(e,s,o){e.exports={default:o("./node_modules/core-js/library/fn/json/stringify.js"),__esModule:!0}},"./node_modules/babel-runtime/core-js/map.js":function(e,s,o){e.exports={default:o("./node_modules/core-js/library/fn/map.js"),__esModule:!0}},"./node_modules/babel-runtime/core-js/object/assign.js":function(e,s,o){e.exports={default:o("./node_modules/core-js/library/fn/object/assign.js"),__esModule:!0}},"./node_modules/babel-runtime/core-js/object/keys.js":function(e,s,o){e.exports={default:o("./node_modules/core-js/library/fn/object/keys.js"),__esModule:!0}},"./node_modules/babel-runtime/core-js/promise.js":function(e,s,o){e.exports={default:o("./node_modules/core-js/library/fn/promise.js"),__esModule:!0}},"./node_modules/babel-runtime/helpers/asyncToGenerator.js":function(e,s,o){"use strict";s.__esModule=!0;var t,r=o("./node_modules/babel-runtime/core-js/promise.js"),n=(t=r)&&t.__esModule?t:{default:t};s.default=function(e){return function(){var s=e.apply(this,arguments);return new n.default((function(e,o){return function t(r,i){try{var a=s[r](i),l=a.value}catch(e){return void o(e)}if(!a.done)return n.default.resolve(l).then((function(e){t("next",e)}),(function(e){t("throw",e)}));e(l)}("next")}))}}},"./node_modules/babel-runtime/helpers/extends.js":function(e,s,o){"use strict";s.__esModule=!0;var t,r=o("./node_modules/babel-runtime/core-js/object/assign.js"),n=(t=r)&&t.__esModule?t:{default:t};s.default=n.default||function(e){for(var s=1;s<arguments.length;s++){var o=arguments[s];for(var t in o)Object.prototype.hasOwnProperty.call(o,t)&&(e[t]=o[t])}return e}},"./node_modules/core-js/library/fn/json/stringify.js":function(e,s,o){var t=o("./node_modules/core-js/library/modules/_core.js"),r=t.JSON||(t.JSON={stringify:JSON.stringify});e.exports=function(e){return r.stringify.apply(r,arguments)}},"./node_modules/core-js/library/fn/map.js":function(e,s,o){o("./node_modules/core-js/library/modules/es6.object.to-string.js"),o("./node_modules/core-js/library/modules/es6.string.iterator.js"),o("./node_modules/core-js/library/modules/web.dom.iterable.js"),o("./node_modules/core-js/library/modules/es6.map.js"),o("./node_modules/core-js/library/modules/es7.map.to-json.js"),o("./node_modules/core-js/library/modules/es7.map.of.js"),o("./node_modules/core-js/library/modules/es7.map.from.js"),e.exports=o("./node_modules/core-js/library/modules/_core.js").Map},"./node_modules/core-js/library/fn/object/assign.js":function(e,s,o){o("./node_modules/core-js/library/modules/es6.object.assign.js"),e.exports=o("./node_modules/core-js/library/modules/_core.js").Object.assign},"./node_modules/core-js/library/fn/object/keys.js":function(e,s,o){o("./node_modules/core-js/library/modules/es6.object.keys.js"),e.exports=o("./node_modules/core-js/library/modules/_core.js").Object.keys},"./node_modules/core-js/library/fn/promise.js":function(e,s,o){o("./node_modules/core-js/library/modules/es6.object.to-string.js"),o("./node_modules/core-js/library/modules/es6.string.iterator.js"),o("./node_modules/core-js/library/modules/web.dom.iterable.js"),o("./node_modules/core-js/library/modules/es6.promise.js"),o("./node_modules/core-js/library/modules/es7.promise.finally.js"),o("./node_modules/core-js/library/modules/es7.promise.try.js"),e.exports=o("./node_modules/core-js/library/modules/_core.js").Promise},"./node_modules/core-js/library/modules/_a-function.js":function(e,s){e.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},"./node_modules/core-js/library/modules/_add-to-unscopables.js":function(e,s){e.exports=function(){}},"./node_modules/core-js/library/modules/_an-instance.js":function(e,s){e.exports=function(e,s,o,t){if(!(e instanceof s)||void 0!==t&&t in e)throw TypeError(o+": incorrect invocation!");return e}},"./node_modules/core-js/library/modules/_an-object.js":function(e,s,o){var t=o("./node_modules/core-js/library/modules/_is-object.js");e.exports=function(e){if(!t(e))throw TypeError(e+" is not an object!");return e}},"./node_modules/core-js/library/modules/_array-from-iterable.js":function(e,s,o){var t=o("./node_modules/core-js/library/modules/_for-of.js");e.exports=function(e,s){var o=[];return t(e,!1,o.push,o,s),o}},"./node_modules/core-js/library/modules/_array-includes.js":function(e,s,o){var t=o("./node_modules/core-js/library/modules/_to-iobject.js"),r=o("./node_modules/core-js/library/modules/_to-length.js"),n=o("./node_modules/core-js/library/modules/_to-absolute-index.js");e.exports=function(e){return function(s,o,i){var a,l=t(s),c=r(l.length),d=n(i,c);if(e&&o!=o){for(;c>d;)if((a=l[d++])!=a)return!0}else for(;c>d;d++)if((e||d in l)&&l[d]===o)return e||d||0;return!e&&-1}}},"./node_modules/core-js/library/modules/_array-methods.js":function(e,s,o){var t=o("./node_modules/core-js/library/modules/_ctx.js"),r=o("./node_modules/core-js/library/modules/_iobject.js"),n=o("./node_modules/core-js/library/modules/_to-object.js"),i=o("./node_modules/core-js/library/modules/_to-length.js"),a=o("./node_modules/core-js/library/modules/_array-species-create.js");e.exports=function(e,s){var o=1==e,l=2==e,c=3==e,d=4==e,u=6==e,A=5==e||u,m=s||a;return function(s,a,h){for(var f,_,p=n(s),b=r(p),j=t(a,h,3),S=i(b.length),g=0,y=o?m(s,S):l?m(s,0):void 0;S>g;g++)if((A||g in b)&&(_=j(f=b[g],g,p),e))if(o)y[g]=_;else if(_)switch(e){case 3:return!0;case 5:return f;case 6:return g;case 2:y.push(f)}else if(d)return!1;return u?-1:c||d?d:y}}},"./node_modules/core-js/library/modules/_array-species-constructor.js":function(e,s,o){var t=o("./node_modules/core-js/library/modules/_is-object.js"),r=o("./node_modules/core-js/library/modules/_is-array.js"),n=o("./node_modules/core-js/library/modules/_wks.js")("species");e.exports=function(e){var s;return r(e)&&("function"!=typeof(s=e.constructor)||s!==Array&&!r(s.prototype)||(s=void 0),t(s)&&null===(s=s[n])&&(s=void 0)),void 0===s?Array:s}},"./node_modules/core-js/library/modules/_array-species-create.js":function(e,s,o){var t=o("./node_modules/core-js/library/modules/_array-species-constructor.js");e.exports=function(e,s){return new(t(e))(s)}},"./node_modules/core-js/library/modules/_classof.js":function(e,s,o){var t=o("./node_modules/core-js/library/modules/_cof.js"),r=o("./node_modules/core-js/library/modules/_wks.js")("toStringTag"),n="Arguments"==t(function(){return arguments}());e.exports=function(e){var s,o,i;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(o=function(e,s){try{return e[s]}catch(e){}}(s=Object(e),r))?o:n?t(s):"Object"==(i=t(s))&&"function"==typeof s.callee?"Arguments":i}},"./node_modules/core-js/library/modules/_cof.js":function(e,s){var o={}.toString;e.exports=function(e){return o.call(e).slice(8,-1)}},"./node_modules/core-js/library/modules/_collection-strong.js":function(e,s,o){"use strict";var t=o("./node_modules/core-js/library/modules/_object-dp.js").f,r=o("./node_modules/core-js/library/modules/_object-create.js"),n=o("./node_modules/core-js/library/modules/_redefine-all.js"),i=o("./node_modules/core-js/library/modules/_ctx.js"),a=o("./node_modules/core-js/library/modules/_an-instance.js"),l=o("./node_modules/core-js/library/modules/_for-of.js"),c=o("./node_modules/core-js/library/modules/_iter-define.js"),d=o("./node_modules/core-js/library/modules/_iter-step.js"),u=o("./node_modules/core-js/library/modules/_set-species.js"),A=o("./node_modules/core-js/library/modules/_descriptors.js"),m=o("./node_modules/core-js/library/modules/_meta.js").fastKey,h=o("./node_modules/core-js/library/modules/_validate-collection.js"),f=A?"_s":"size",_=function(e,s){var o,t=m(s);if("F"!==t)return e._i[t];for(o=e._f;o;o=o.n)if(o.k==s)return o};e.exports={getConstructor:function(e,s,o,c){var d=e((function(e,t){a(e,d,s,"_i"),e._t=s,e._i=r(null),e._f=void 0,e._l=void 0,e[f]=0,null!=t&&l(t,o,e[c],e)}));return n(d.prototype,{clear:function(){for(var e=h(this,s),o=e._i,t=e._f;t;t=t.n)t.r=!0,t.p&&(t.p=t.p.n=void 0),delete o[t.i];e._f=e._l=void 0,e[f]=0},delete:function(e){var o=h(this,s),t=_(o,e);if(t){var r=t.n,n=t.p;delete o._i[t.i],t.r=!0,n&&(n.n=r),r&&(r.p=n),o._f==t&&(o._f=r),o._l==t&&(o._l=n),o[f]--}return!!t},forEach:function(e){h(this,s);for(var o,t=i(e,arguments.length>1?arguments[1]:void 0,3);o=o?o.n:this._f;)for(t(o.v,o.k,this);o&&o.r;)o=o.p},has:function(e){return!!_(h(this,s),e)}}),A&&t(d.prototype,"size",{get:function(){return h(this,s)[f]}}),d},def:function(e,s,o){var t,r,n=_(e,s);return n?n.v=o:(e._l=n={i:r=m(s,!0),k:s,v:o,p:t=e._l,n:void 0,r:!1},e._f||(e._f=n),t&&(t.n=n),e[f]++,"F"!==r&&(e._i[r]=n)),e},getEntry:_,setStrong:function(e,s,o){c(e,s,(function(e,o){this._t=h(e,s),this._k=o,this._l=void 0}),(function(){for(var e=this._k,s=this._l;s&&s.r;)s=s.p;return this._t&&(this._l=s=s?s.n:this._t._f)?d(0,"keys"==e?s.k:"values"==e?s.v:[s.k,s.v]):(this._t=void 0,d(1))}),o?"entries":"values",!o,!0),u(s)}}},"./node_modules/core-js/library/modules/_collection-to-json.js":function(e,s,o){var t=o("./node_modules/core-js/library/modules/_classof.js"),r=o("./node_modules/core-js/library/modules/_array-from-iterable.js");e.exports=function(e){return function(){if(t(this)!=e)throw TypeError(e+"#toJSON isn't generic");return r(this)}}},"./node_modules/core-js/library/modules/_collection.js":function(e,s,o){"use strict";var t=o("./node_modules/core-js/library/modules/_global.js"),r=o("./node_modules/core-js/library/modules/_export.js"),n=o("./node_modules/core-js/library/modules/_meta.js"),i=o("./node_modules/core-js/library/modules/_fails.js"),a=o("./node_modules/core-js/library/modules/_hide.js"),l=o("./node_modules/core-js/library/modules/_redefine-all.js"),c=o("./node_modules/core-js/library/modules/_for-of.js"),d=o("./node_modules/core-js/library/modules/_an-instance.js"),u=o("./node_modules/core-js/library/modules/_is-object.js"),A=o("./node_modules/core-js/library/modules/_set-to-string-tag.js"),m=o("./node_modules/core-js/library/modules/_object-dp.js").f,h=o("./node_modules/core-js/library/modules/_array-methods.js")(0),f=o("./node_modules/core-js/library/modules/_descriptors.js");e.exports=function(e,s,o,_,p,b){var j=t[e],S=j,g=p?"set":"add",y=S&&S.prototype,v={};return f&&"function"==typeof S&&(b||y.forEach&&!i((function(){(new S).entries().next()})))?(S=s((function(s,o){d(s,S,e,"_c"),s._c=new j,null!=o&&c(o,p,s[g],s)})),h("add,clear,delete,forEach,get,has,set,keys,values,entries,toJSON".split(","),(function(e){var s="add"==e||"set"==e;e in y&&(!b||"clear"!=e)&&a(S.prototype,e,(function(o,t){if(d(this,S,e),!s&&b&&!u(o))return"get"==e&&void 0;var r=this._c[e](0===o?0:o,t);return s?this:r}))})),b||m(S.prototype,"size",{get:function(){return this._c.size}})):(S=_.getConstructor(s,e,p,g),l(S.prototype,o),n.NEED=!0),A(S,e),v[e]=S,r(r.G+r.W+r.F,v),b||_.setStrong(S,e,p),S}},"./node_modules/core-js/library/modules/_core.js":function(e,s){var o=e.exports={version:"2.6.10"};"number"==typeof __e&&(__e=o)},"./node_modules/core-js/library/modules/_ctx.js":function(e,s,o){var t=o("./node_modules/core-js/library/modules/_a-function.js");e.exports=function(e,s,o){if(t(e),void 0===s)return e;switch(o){case 1:return function(o){return e.call(s,o)};case 2:return function(o,t){return e.call(s,o,t)};case 3:return function(o,t,r){return e.call(s,o,t,r)}}return function(){return e.apply(s,arguments)}}},"./node_modules/core-js/library/modules/_defined.js":function(e,s){e.exports=function(e){if(null==e)throw TypeError("Can't call method on  "+e);return e}},"./node_modules/core-js/library/modules/_descriptors.js":function(e,s,o){e.exports=!o("./node_modules/core-js/library/modules/_fails.js")((function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}))},"./node_modules/core-js/library/modules/_dom-create.js":function(e,s,o){var t=o("./node_modules/core-js/library/modules/_is-object.js"),r=o("./node_modules/core-js/library/modules/_global.js").document,n=t(r)&&t(r.createElement);e.exports=function(e){return n?r.createElement(e):{}}},"./node_modules/core-js/library/modules/_enum-bug-keys.js":function(e,s){e.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},"./node_modules/core-js/library/modules/_export.js":function(e,s,o){var t=o("./node_modules/core-js/library/modules/_global.js"),r=o("./node_modules/core-js/library/modules/_core.js"),n=o("./node_modules/core-js/library/modules/_ctx.js"),i=o("./node_modules/core-js/library/modules/_hide.js"),a=o("./node_modules/core-js/library/modules/_has.js"),l=function(e,s,o){var c,d,u,A=e&l.F,m=e&l.G,h=e&l.S,f=e&l.P,_=e&l.B,p=e&l.W,b=m?r:r[s]||(r[s]={}),j=b.prototype,S=m?t:h?t[s]:(t[s]||{}).prototype;for(c in m&&(o=s),o)(d=!A&&S&&void 0!==S[c])&&a(b,c)||(u=d?S[c]:o[c],b[c]=m&&"function"!=typeof S[c]?o[c]:_&&d?n(u,t):p&&S[c]==u?function(e){var s=function(s,o,t){if(this instanceof e){switch(arguments.length){case 0:return new e;case 1:return new e(s);case 2:return new e(s,o)}return new e(s,o,t)}return e.apply(this,arguments)};return s.prototype=e.prototype,s}(u):f&&"function"==typeof u?n(Function.call,u):u,f&&((b.virtual||(b.virtual={}))[c]=u,e&l.R&&j&&!j[c]&&i(j,c,u)))};l.F=1,l.G=2,l.S=4,l.P=8,l.B=16,l.W=32,l.U=64,l.R=128,e.exports=l},"./node_modules/core-js/library/modules/_fails.js":function(e,s){e.exports=function(e){try{return!!e()}catch(e){return!0}}},"./node_modules/core-js/library/modules/_for-of.js":function(e,s,o){var t=o("./node_modules/core-js/library/modules/_ctx.js"),r=o("./node_modules/core-js/library/modules/_iter-call.js"),n=o("./node_modules/core-js/library/modules/_is-array-iter.js"),i=o("./node_modules/core-js/library/modules/_an-object.js"),a=o("./node_modules/core-js/library/modules/_to-length.js"),l=o("./node_modules/core-js/library/modules/core.get-iterator-method.js"),c={},d={};(s=e.exports=function(e,s,o,u,A){var m,h,f,_,p=A?function(){return e}:l(e),b=t(o,u,s?2:1),j=0;if("function"!=typeof p)throw TypeError(e+" is not iterable!");if(n(p)){for(m=a(e.length);m>j;j++)if((_=s?b(i(h=e[j])[0],h[1]):b(e[j]))===c||_===d)return _}else for(f=p.call(e);!(h=f.next()).done;)if((_=r(f,b,h.value,s))===c||_===d)return _}).BREAK=c,s.RETURN=d},"./node_modules/core-js/library/modules/_global.js":function(e,s){var o=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=o)},"./node_modules/core-js/library/modules/_has.js":function(e,s){var o={}.hasOwnProperty;e.exports=function(e,s){return o.call(e,s)}},"./node_modules/core-js/library/modules/_hide.js":function(e,s,o){var t=o("./node_modules/core-js/library/modules/_object-dp.js"),r=o("./node_modules/core-js/library/modules/_property-desc.js");e.exports=o("./node_modules/core-js/library/modules/_descriptors.js")?function(e,s,o){return t.f(e,s,r(1,o))}:function(e,s,o){return e[s]=o,e}},"./node_modules/core-js/library/modules/_html.js":function(e,s,o){var t=o("./node_modules/core-js/library/modules/_global.js").document;e.exports=t&&t.documentElement},"./node_modules/core-js/library/modules/_ie8-dom-define.js":function(e,s,o){e.exports=!o("./node_modules/core-js/library/modules/_descriptors.js")&&!o("./node_modules/core-js/library/modules/_fails.js")((function(){return 7!=Object.defineProperty(o("./node_modules/core-js/library/modules/_dom-create.js")("div"),"a",{get:function(){return 7}}).a}))},"./node_modules/core-js/library/modules/_invoke.js":function(e,s){e.exports=function(e,s,o){var t=void 0===o;switch(s.length){case 0:return t?e():e.call(o);case 1:return t?e(s[0]):e.call(o,s[0]);case 2:return t?e(s[0],s[1]):e.call(o,s[0],s[1]);case 3:return t?e(s[0],s[1],s[2]):e.call(o,s[0],s[1],s[2]);case 4:return t?e(s[0],s[1],s[2],s[3]):e.call(o,s[0],s[1],s[2],s[3])}return e.apply(o,s)}},"./node_modules/core-js/library/modules/_iobject.js":function(e,s,o){var t=o("./node_modules/core-js/library/modules/_cof.js");e.exports=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==t(e)?e.split(""):Object(e)}},"./node_modules/core-js/library/modules/_is-array-iter.js":function(e,s,o){var t=o("./node_modules/core-js/library/modules/_iterators.js"),r=o("./node_modules/core-js/library/modules/_wks.js")("iterator"),n=Array.prototype;e.exports=function(e){return void 0!==e&&(t.Array===e||n[r]===e)}},"./node_modules/core-js/library/modules/_is-array.js":function(e,s,o){var t=o("./node_modules/core-js/library/modules/_cof.js");e.exports=Array.isArray||function(e){return"Array"==t(e)}},"./node_modules/core-js/library/modules/_is-object.js":function(e,s){e.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}},"./node_modules/core-js/library/modules/_iter-call.js":function(e,s,o){var t=o("./node_modules/core-js/library/modules/_an-object.js");e.exports=function(e,s,o,r){try{return r?s(t(o)[0],o[1]):s(o)}catch(s){var n=e.return;throw void 0!==n&&t(n.call(e)),s}}},"./node_modules/core-js/library/modules/_iter-create.js":function(e,s,o){"use strict";var t=o("./node_modules/core-js/library/modules/_object-create.js"),r=o("./node_modules/core-js/library/modules/_property-desc.js"),n=o("./node_modules/core-js/library/modules/_set-to-string-tag.js"),i={};o("./node_modules/core-js/library/modules/_hide.js")(i,o("./node_modules/core-js/library/modules/_wks.js")("iterator"),(function(){return this})),e.exports=function(e,s,o){e.prototype=t(i,{next:r(1,o)}),n(e,s+" Iterator")}},"./node_modules/core-js/library/modules/_iter-define.js":function(e,s,o){"use strict";var t=o("./node_modules/core-js/library/modules/_library.js"),r=o("./node_modules/core-js/library/modules/_export.js"),n=o("./node_modules/core-js/library/modules/_redefine.js"),i=o("./node_modules/core-js/library/modules/_hide.js"),a=o("./node_modules/core-js/library/modules/_iterators.js"),l=o("./node_modules/core-js/library/modules/_iter-create.js"),c=o("./node_modules/core-js/library/modules/_set-to-string-tag.js"),d=o("./node_modules/core-js/library/modules/_object-gpo.js"),u=o("./node_modules/core-js/library/modules/_wks.js")("iterator"),A=!([].keys&&"next"in[].keys()),m=function(){return this};e.exports=function(e,s,o,h,f,_,p){l(o,s,h);var b,j,S,g=function(e){if(!A&&e in I)return I[e];switch(e){case"keys":case"values":return function(){return new o(this,e)}}return function(){return new o(this,e)}},y=s+" Iterator",v="values"==f,C=!1,I=e.prototype,E=I[u]||I["@@iterator"]||f&&I[f],T=E||g(f),M=f?v?g("entries"):T:void 0,R="Array"==s&&I.entries||E;if(R&&(S=d(R.call(new e)))!==Object.prototype&&S.next&&(c(S,y,!0),t||"function"==typeof S[u]||i(S,u,m)),v&&E&&"values"!==E.name&&(C=!0,T=function(){return E.call(this)}),t&&!p||!A&&!C&&I[u]||i(I,u,T),a[s]=T,a[y]=m,f)if(b={values:v?T:g("values"),keys:_?T:g("keys"),entries:M},p)for(j in b)j in I||n(I,j,b[j]);else r(r.P+r.F*(A||C),s,b);return b}},"./node_modules/core-js/library/modules/_iter-detect.js":function(e,s,o){var t=o("./node_modules/core-js/library/modules/_wks.js")("iterator"),r=!1;try{var n=[7][t]();n.return=function(){r=!0},Array.from(n,(function(){throw 2}))}catch(e){}e.exports=function(e,s){if(!s&&!r)return!1;var o=!1;try{var n=[7],i=n[t]();i.next=function(){return{done:o=!0}},n[t]=function(){return i},e(n)}catch(e){}return o}},"./node_modules/core-js/library/modules/_iter-step.js":function(e,s){e.exports=function(e,s){return{value:s,done:!!e}}},"./node_modules/core-js/library/modules/_iterators.js":function(e,s){e.exports={}},"./node_modules/core-js/library/modules/_library.js":function(e,s){e.exports=!0},"./node_modules/core-js/library/modules/_meta.js":function(e,s,o){var t=o("./node_modules/core-js/library/modules/_uid.js")("meta"),r=o("./node_modules/core-js/library/modules/_is-object.js"),n=o("./node_modules/core-js/library/modules/_has.js"),i=o("./node_modules/core-js/library/modules/_object-dp.js").f,a=0,l=Object.isExtensible||function(){return!0},c=!o("./node_modules/core-js/library/modules/_fails.js")((function(){return l(Object.preventExtensions({}))})),d=function(e){i(e,t,{value:{i:"O"+ ++a,w:{}}})},u=e.exports={KEY:t,NEED:!1,fastKey:function(e,s){if(!r(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!n(e,t)){if(!l(e))return"F";if(!s)return"E";d(e)}return e[t].i},getWeak:function(e,s){if(!n(e,t)){if(!l(e))return!0;if(!s)return!1;d(e)}return e[t].w},onFreeze:function(e){return c&&u.NEED&&l(e)&&!n(e,t)&&d(e),e}}},"./node_modules/core-js/library/modules/_microtask.js":function(e,s,o){var t=o("./node_modules/core-js/library/modules/_global.js"),r=o("./node_modules/core-js/library/modules/_task.js").set,n=t.MutationObserver||t.WebKitMutationObserver,i=t.process,a=t.Promise,l="process"==o("./node_modules/core-js/library/modules/_cof.js")(i);e.exports=function(){var e,s,o,c=function(){var t,r;for(l&&(t=i.domain)&&t.exit();e;){r=e.fn,e=e.next;try{r()}catch(t){throw e?o():s=void 0,t}}s=void 0,t&&t.enter()};if(l)o=function(){i.nextTick(c)};else if(!n||t.navigator&&t.navigator.standalone)if(a&&a.resolve){var d=a.resolve(void 0);o=function(){d.then(c)}}else o=function(){r.call(t,c)};else{var u=!0,A=document.createTextNode("");new n(c).observe(A,{characterData:!0}),o=function(){A.data=u=!u}}return function(t){var r={fn:t,next:void 0};s&&(s.next=r),e||(e=r,o()),s=r}}},"./node_modules/core-js/library/modules/_new-promise-capability.js":function(e,s,o){"use strict";var t=o("./node_modules/core-js/library/modules/_a-function.js");function r(e){var s,o;this.promise=new e((function(e,t){if(void 0!==s||void 0!==o)throw TypeError("Bad Promise constructor");s=e,o=t})),this.resolve=t(s),this.reject=t(o)}e.exports.f=function(e){return new r(e)}},"./node_modules/core-js/library/modules/_object-assign.js":function(e,s,o){"use strict";var t=o("./node_modules/core-js/library/modules/_descriptors.js"),r=o("./node_modules/core-js/library/modules/_object-keys.js"),n=o("./node_modules/core-js/library/modules/_object-gops.js"),i=o("./node_modules/core-js/library/modules/_object-pie.js"),a=o("./node_modules/core-js/library/modules/_to-object.js"),l=o("./node_modules/core-js/library/modules/_iobject.js"),c=Object.assign;e.exports=!c||o("./node_modules/core-js/library/modules/_fails.js")((function(){var e={},s={},o=Symbol(),t="abcdefghijklmnopqrst";return e[o]=7,t.split("").forEach((function(e){s[e]=e})),7!=c({},e)[o]||Object.keys(c({},s)).join("")!=t}))?function(e,s){for(var o=a(e),c=arguments.length,d=1,u=n.f,A=i.f;c>d;)for(var m,h=l(arguments[d++]),f=u?r(h).concat(u(h)):r(h),_=f.length,p=0;_>p;)m=f[p++],t&&!A.call(h,m)||(o[m]=h[m]);return o}:c},"./node_modules/core-js/library/modules/_object-create.js":function(e,s,o){var t=o("./node_modules/core-js/library/modules/_an-object.js"),r=o("./node_modules/core-js/library/modules/_object-dps.js"),n=o("./node_modules/core-js/library/modules/_enum-bug-keys.js"),i=o("./node_modules/core-js/library/modules/_shared-key.js")("IE_PROTO"),a=function(){},l=function(){var e,s=o("./node_modules/core-js/library/modules/_dom-create.js")("iframe"),t=n.length;for(s.style.display="none",o("./node_modules/core-js/library/modules/_html.js").appendChild(s),s.src="javascript:",(e=s.contentWindow.document).open(),e.write("<script>document.F=Object<\/script>"),e.close(),l=e.F;t--;)delete l.prototype[n[t]];return l()};e.exports=Object.create||function(e,s){var o;return null!==e?(a.prototype=t(e),o=new a,a.prototype=null,o[i]=e):o=l(),void 0===s?o:r(o,s)}},"./node_modules/core-js/library/modules/_object-dp.js":function(e,s,o){var t=o("./node_modules/core-js/library/modules/_an-object.js"),r=o("./node_modules/core-js/library/modules/_ie8-dom-define.js"),n=o("./node_modules/core-js/library/modules/_to-primitive.js"),i=Object.defineProperty;s.f=o("./node_modules/core-js/library/modules/_descriptors.js")?Object.defineProperty:function(e,s,o){if(t(e),s=n(s,!0),t(o),r)try{return i(e,s,o)}catch(e){}if("get"in o||"set"in o)throw TypeError("Accessors not supported!");return"value"in o&&(e[s]=o.value),e}},"./node_modules/core-js/library/modules/_object-dps.js":function(e,s,o){var t=o("./node_modules/core-js/library/modules/_object-dp.js"),r=o("./node_modules/core-js/library/modules/_an-object.js"),n=o("./node_modules/core-js/library/modules/_object-keys.js");e.exports=o("./node_modules/core-js/library/modules/_descriptors.js")?Object.defineProperties:function(e,s){r(e);for(var o,i=n(s),a=i.length,l=0;a>l;)t.f(e,o=i[l++],s[o]);return e}},"./node_modules/core-js/library/modules/_object-gops.js":function(e,s){s.f=Object.getOwnPropertySymbols},"./node_modules/core-js/library/modules/_object-gpo.js":function(e,s,o){var t=o("./node_modules/core-js/library/modules/_has.js"),r=o("./node_modules/core-js/library/modules/_to-object.js"),n=o("./node_modules/core-js/library/modules/_shared-key.js")("IE_PROTO"),i=Object.prototype;e.exports=Object.getPrototypeOf||function(e){return e=r(e),t(e,n)?e[n]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?i:null}},"./node_modules/core-js/library/modules/_object-keys-internal.js":function(e,s,o){var t=o("./node_modules/core-js/library/modules/_has.js"),r=o("./node_modules/core-js/library/modules/_to-iobject.js"),n=o("./node_modules/core-js/library/modules/_array-includes.js")(!1),i=o("./node_modules/core-js/library/modules/_shared-key.js")("IE_PROTO");e.exports=function(e,s){var o,a=r(e),l=0,c=[];for(o in a)o!=i&&t(a,o)&&c.push(o);for(;s.length>l;)t(a,o=s[l++])&&(~n(c,o)||c.push(o));return c}},"./node_modules/core-js/library/modules/_object-keys.js":function(e,s,o){var t=o("./node_modules/core-js/library/modules/_object-keys-internal.js"),r=o("./node_modules/core-js/library/modules/_enum-bug-keys.js");e.exports=Object.keys||function(e){return t(e,r)}},"./node_modules/core-js/library/modules/_object-pie.js":function(e,s){s.f={}.propertyIsEnumerable},"./node_modules/core-js/library/modules/_object-sap.js":function(e,s,o){var t=o("./node_modules/core-js/library/modules/_export.js"),r=o("./node_modules/core-js/library/modules/_core.js"),n=o("./node_modules/core-js/library/modules/_fails.js");e.exports=function(e,s){var o=(r.Object||{})[e]||Object[e],i={};i[e]=s(o),t(t.S+t.F*n((function(){o(1)})),"Object",i)}},"./node_modules/core-js/library/modules/_perform.js":function(e,s){e.exports=function(e){try{return{e:!1,v:e()}}catch(e){return{e:!0,v:e}}}},"./node_modules/core-js/library/modules/_promise-resolve.js":function(e,s,o){var t=o("./node_modules/core-js/library/modules/_an-object.js"),r=o("./node_modules/core-js/library/modules/_is-object.js"),n=o("./node_modules/core-js/library/modules/_new-promise-capability.js");e.exports=function(e,s){if(t(e),r(s)&&s.constructor===e)return s;var o=n.f(e);return(0,o.resolve)(s),o.promise}},"./node_modules/core-js/library/modules/_property-desc.js":function(e,s){e.exports=function(e,s){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:s}}},"./node_modules/core-js/library/modules/_redefine-all.js":function(e,s,o){var t=o("./node_modules/core-js/library/modules/_hide.js");e.exports=function(e,s,o){for(var r in s)o&&e[r]?e[r]=s[r]:t(e,r,s[r]);return e}},"./node_modules/core-js/library/modules/_redefine.js":function(e,s,o){e.exports=o("./node_modules/core-js/library/modules/_hide.js")},"./node_modules/core-js/library/modules/_set-collection-from.js":function(e,s,o){"use strict";var t=o("./node_modules/core-js/library/modules/_export.js"),r=o("./node_modules/core-js/library/modules/_a-function.js"),n=o("./node_modules/core-js/library/modules/_ctx.js"),i=o("./node_modules/core-js/library/modules/_for-of.js");e.exports=function(e){t(t.S,e,{from:function(e){var s,o,t,a,l=arguments[1];return r(this),(s=void 0!==l)&&r(l),null==e?new this:(o=[],s?(t=0,a=n(l,arguments[2],2),i(e,!1,(function(e){o.push(a(e,t++))}))):i(e,!1,o.push,o),new this(o))}})}},"./node_modules/core-js/library/modules/_set-collection-of.js":function(e,s,o){"use strict";var t=o("./node_modules/core-js/library/modules/_export.js");e.exports=function(e){t(t.S,e,{of:function(){for(var e=arguments.length,s=new Array(e);e--;)s[e]=arguments[e];return new this(s)}})}},"./node_modules/core-js/library/modules/_set-species.js":function(e,s,o){"use strict";var t=o("./node_modules/core-js/library/modules/_global.js"),r=o("./node_modules/core-js/library/modules/_core.js"),n=o("./node_modules/core-js/library/modules/_object-dp.js"),i=o("./node_modules/core-js/library/modules/_descriptors.js"),a=o("./node_modules/core-js/library/modules/_wks.js")("species");e.exports=function(e){var s="function"==typeof r[e]?r[e]:t[e];i&&s&&!s[a]&&n.f(s,a,{configurable:!0,get:function(){return this}})}},"./node_modules/core-js/library/modules/_set-to-string-tag.js":function(e,s,o){var t=o("./node_modules/core-js/library/modules/_object-dp.js").f,r=o("./node_modules/core-js/library/modules/_has.js"),n=o("./node_modules/core-js/library/modules/_wks.js")("toStringTag");e.exports=function(e,s,o){e&&!r(e=o?e:e.prototype,n)&&t(e,n,{configurable:!0,value:s})}},"./node_modules/core-js/library/modules/_shared-key.js":function(e,s,o){var t=o("./node_modules/core-js/library/modules/_shared.js")("keys"),r=o("./node_modules/core-js/library/modules/_uid.js");e.exports=function(e){return t[e]||(t[e]=r(e))}},"./node_modules/core-js/library/modules/_shared.js":function(e,s,o){var t=o("./node_modules/core-js/library/modules/_core.js"),r=o("./node_modules/core-js/library/modules/_global.js"),n=r["__core-js_shared__"]||(r["__core-js_shared__"]={});(e.exports=function(e,s){return n[e]||(n[e]=void 0!==s?s:{})})("versions",[]).push({version:t.version,mode:o("./node_modules/core-js/library/modules/_library.js")?"pure":"global",copyright:" 2019 Denis Pushkarev (zloirock.ru)"})},"./node_modules/core-js/library/modules/_species-constructor.js":function(e,s,o){var t=o("./node_modules/core-js/library/modules/_an-object.js"),r=o("./node_modules/core-js/library/modules/_a-function.js"),n=o("./node_modules/core-js/library/modules/_wks.js")("species");e.exports=function(e,s){var o,i=t(e).constructor;return void 0===i||null==(o=t(i)[n])?s:r(o)}},"./node_modules/core-js/library/modules/_string-at.js":function(e,s,o){var t=o("./node_modules/core-js/library/modules/_to-integer.js"),r=o("./node_modules/core-js/library/modules/_defined.js");e.exports=function(e){return function(s,o){var n,i,a=String(r(s)),l=t(o),c=a.length;return l<0||l>=c?e?"":void 0:(n=a.charCodeAt(l))<55296||n>56319||l+1===c||(i=a.charCodeAt(l+1))<56320||i>57343?e?a.charAt(l):n:e?a.slice(l,l+2):i-56320+(n-55296<<10)+65536}}},"./node_modules/core-js/library/modules/_task.js":function(e,s,o){var t,r,n,i=o("./node_modules/core-js/library/modules/_ctx.js"),a=o("./node_modules/core-js/library/modules/_invoke.js"),l=o("./node_modules/core-js/library/modules/_html.js"),c=o("./node_modules/core-js/library/modules/_dom-create.js"),d=o("./node_modules/core-js/library/modules/_global.js"),u=d.process,A=d.setImmediate,m=d.clearImmediate,h=d.MessageChannel,f=d.Dispatch,_=0,p={},b=function(){var e=+this;if(p.hasOwnProperty(e)){var s=p[e];delete p[e],s()}},j=function(e){b.call(e.data)};A&&m||(A=function(e){for(var s=[],o=1;arguments.length>o;)s.push(arguments[o++]);return p[++_]=function(){a("function"==typeof e?e:Function(e),s)},t(_),_},m=function(e){delete p[e]},"process"==o("./node_modules/core-js/library/modules/_cof.js")(u)?t=function(e){u.nextTick(i(b,e,1))}:f&&f.now?t=function(e){f.now(i(b,e,1))}:h?(n=(r=new h).port2,r.port1.onmessage=j,t=i(n.postMessage,n,1)):d.addEventListener&&"function"==typeof postMessage&&!d.importScripts?(t=function(e){d.postMessage(e+"","*")},d.addEventListener("message",j,!1)):t="onreadystatechange"in c("script")?function(e){l.appendChild(c("script")).onreadystatechange=function(){l.removeChild(this),b.call(e)}}:function(e){setTimeout(i(b,e,1),0)}),e.exports={set:A,clear:m}},"./node_modules/core-js/library/modules/_to-absolute-index.js":function(e,s,o){var t=o("./node_modules/core-js/library/modules/_to-integer.js"),r=Math.max,n=Math.min;e.exports=function(e,s){return(e=t(e))<0?r(e+s,0):n(e,s)}},"./node_modules/core-js/library/modules/_to-integer.js":function(e,s){var o=Math.ceil,t=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(e>0?t:o)(e)}},"./node_modules/core-js/library/modules/_to-iobject.js":function(e,s,o){var t=o("./node_modules/core-js/library/modules/_iobject.js"),r=o("./node_modules/core-js/library/modules/_defined.js");e.exports=function(e){return t(r(e))}},"./node_modules/core-js/library/modules/_to-length.js":function(e,s,o){var t=o("./node_modules/core-js/library/modules/_to-integer.js"),r=Math.min;e.exports=function(e){return e>0?r(t(e),9007199254740991):0}},"./node_modules/core-js/library/modules/_to-object.js":function(e,s,o){var t=o("./node_modules/core-js/library/modules/_defined.js");e.exports=function(e){return Object(t(e))}},"./node_modules/core-js/library/modules/_to-primitive.js":function(e,s,o){var t=o("./node_modules/core-js/library/modules/_is-object.js");e.exports=function(e,s){if(!t(e))return e;var o,r;if(s&&"function"==typeof(o=e.toString)&&!t(r=o.call(e)))return r;if("function"==typeof(o=e.valueOf)&&!t(r=o.call(e)))return r;if(!s&&"function"==typeof(o=e.toString)&&!t(r=o.call(e)))return r;throw TypeError("Can't convert object to primitive value")}},"./node_modules/core-js/library/modules/_uid.js":function(e,s){var o=0,t=Math.random();e.exports=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++o+t).toString(36))}},"./node_modules/core-js/library/modules/_user-agent.js":function(e,s,o){var t=o("./node_modules/core-js/library/modules/_global.js").navigator;e.exports=t&&t.userAgent||""},"./node_modules/core-js/library/modules/_validate-collection.js":function(e,s,o){var t=o("./node_modules/core-js/library/modules/_is-object.js");e.exports=function(e,s){if(!t(e)||e._t!==s)throw TypeError("Incompatible receiver, "+s+" required!");return e}},"./node_modules/core-js/library/modules/_wks.js":function(e,s,o){var t=o("./node_modules/core-js/library/modules/_shared.js")("wks"),r=o("./node_modules/core-js/library/modules/_uid.js"),n=o("./node_modules/core-js/library/modules/_global.js").Symbol,i="function"==typeof n;(e.exports=function(e){return t[e]||(t[e]=i&&n[e]||(i?n:r)("Symbol."+e))}).store=t},"./node_modules/core-js/library/modules/core.get-iterator-method.js":function(e,s,o){var t=o("./node_modules/core-js/library/modules/_classof.js"),r=o("./node_modules/core-js/library/modules/_wks.js")("iterator"),n=o("./node_modules/core-js/library/modules/_iterators.js");e.exports=o("./node_modules/core-js/library/modules/_core.js").getIteratorMethod=function(e){if(null!=e)return e[r]||e["@@iterator"]||n[t(e)]}},"./node_modules/core-js/library/modules/es6.array.iterator.js":function(e,s,o){"use strict";var t=o("./node_modules/core-js/library/modules/_add-to-unscopables.js"),r=o("./node_modules/core-js/library/modules/_iter-step.js"),n=o("./node_modules/core-js/library/modules/_iterators.js"),i=o("./node_modules/core-js/library/modules/_to-iobject.js");e.exports=o("./node_modules/core-js/library/modules/_iter-define.js")(Array,"Array",(function(e,s){this._t=i(e),this._i=0,this._k=s}),(function(){var e=this._t,s=this._k,o=this._i++;return!e||o>=e.length?(this._t=void 0,r(1)):r(0,"keys"==s?o:"values"==s?e[o]:[o,e[o]])}),"values"),n.Arguments=n.Array,t("keys"),t("values"),t("entries")},"./node_modules/core-js/library/modules/es6.map.js":function(e,s,o){"use strict";var t=o("./node_modules/core-js/library/modules/_collection-strong.js"),r=o("./node_modules/core-js/library/modules/_validate-collection.js");e.exports=o("./node_modules/core-js/library/modules/_collection.js")("Map",(function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}}),{get:function(e){var s=t.getEntry(r(this,"Map"),e);return s&&s.v},set:function(e,s){return t.def(r(this,"Map"),0===e?0:e,s)}},t,!0)},"./node_modules/core-js/library/modules/es6.object.assign.js":function(e,s,o){var t=o("./node_modules/core-js/library/modules/_export.js");t(t.S+t.F,"Object",{assign:o("./node_modules/core-js/library/modules/_object-assign.js")})},"./node_modules/core-js/library/modules/es6.object.keys.js":function(e,s,o){var t=o("./node_modules/core-js/library/modules/_to-object.js"),r=o("./node_modules/core-js/library/modules/_object-keys.js");o("./node_modules/core-js/library/modules/_object-sap.js")("keys",(function(){return function(e){return r(t(e))}}))},"./node_modules/core-js/library/modules/es6.object.to-string.js":function(e,s){},"./node_modules/core-js/library/modules/es6.promise.js":function(e,s,o){"use strict";var t,r,n,i,a=o("./node_modules/core-js/library/modules/_library.js"),l=o("./node_modules/core-js/library/modules/_global.js"),c=o("./node_modules/core-js/library/modules/_ctx.js"),d=o("./node_modules/core-js/library/modules/_classof.js"),u=o("./node_modules/core-js/library/modules/_export.js"),A=o("./node_modules/core-js/library/modules/_is-object.js"),m=o("./node_modules/core-js/library/modules/_a-function.js"),h=o("./node_modules/core-js/library/modules/_an-instance.js"),f=o("./node_modules/core-js/library/modules/_for-of.js"),_=o("./node_modules/core-js/library/modules/_species-constructor.js"),p=o("./node_modules/core-js/library/modules/_task.js").set,b=o("./node_modules/core-js/library/modules/_microtask.js")(),j=o("./node_modules/core-js/library/modules/_new-promise-capability.js"),S=o("./node_modules/core-js/library/modules/_perform.js"),g=o("./node_modules/core-js/library/modules/_user-agent.js"),y=o("./node_modules/core-js/library/modules/_promise-resolve.js"),v=l.TypeError,C=l.process,I=C&&C.versions,E=I&&I.v8||"",T=l.Promise,M="process"==d(C),R=function(){},O=r=j.f,k=!!function(){try{var e=T.resolve(1),s=(e.constructor={})[o("./node_modules/core-js/library/modules/_wks.js")("species")]=function(e){e(R,R)};return(M||"function"==typeof PromiseRejectionEvent)&&e.then(R)instanceof s&&0!==E.indexOf("6.6")&&-1===g.indexOf("Chrome/66")}catch(e){}}(),w=function(e){var s;return!(!A(e)||"function"!=typeof(s=e.then))&&s},N=function(e,s){if(!e._n){e._n=!0;var o=e._c;b((function(){for(var t=e._v,r=1==e._s,n=0,i=function(s){var o,n,i,a=r?s.ok:s.fail,l=s.resolve,c=s.reject,d=s.domain;try{a?(r||(2==e._h&&P(e),e._h=1),!0===a?o=t:(d&&d.enter(),o=a(t),d&&(d.exit(),i=!0)),o===s.promise?c(v("Promise-chain cycle")):(n=w(o))?n.call(o,l,c):l(o)):c(t)}catch(e){d&&!i&&d.exit(),c(e)}};o.length>n;)i(o[n++]);e._c=[],e._n=!1,s&&!e._h&&V(e)}))}},V=function(e){p.call(l,(function(){var s,o,t,r=e._v,n=x(e);if(n&&(s=S((function(){M?C.emit("unhandledRejection",r,e):(o=l.onunhandledrejection)?o({promise:e,reason:r}):(t=l.console)&&t.error&&t.error("Unhandled promise rejection",r)})),e._h=M||x(e)?2:1),e._a=void 0,n&&s.e)throw s.v}))},x=function(e){return 1!==e._h&&0===(e._a||e._c).length},P=function(e){p.call(l,(function(){var s;M?C.emit("rejectionHandled",e):(s=l.onrejectionhandled)&&s({promise:e,reason:e._v})}))},U=function(e){var s=this;s._d||(s._d=!0,(s=s._w||s)._v=e,s._s=2,s._a||(s._a=s._c.slice()),N(s,!0))},B=function(e){var s,o=this;if(!o._d){o._d=!0,o=o._w||o;try{if(o===e)throw v("Promise can't be resolved itself");(s=w(e))?b((function(){var t={_w:o,_d:!1};try{s.call(e,c(B,t,1),c(U,t,1))}catch(e){U.call(t,e)}})):(o._v=e,o._s=1,N(o,!1))}catch(e){U.call({_w:o,_d:!1},e)}}};k||(T=function(e){h(this,T,"Promise","_h"),m(e),t.call(this);try{e(c(B,this,1),c(U,this,1))}catch(e){U.call(this,e)}},(t=function(e){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1}).prototype=o("./node_modules/core-js/library/modules/_redefine-all.js")(T.prototype,{then:function(e,s){var o=O(_(this,T));return o.ok="function"!=typeof e||e,o.fail="function"==typeof s&&s,o.domain=M?C.domain:void 0,this._c.push(o),this._a&&this._a.push(o),this._s&&N(this,!1),o.promise},catch:function(e){return this.then(void 0,e)}}),n=function(){var e=new t;this.promise=e,this.resolve=c(B,e,1),this.reject=c(U,e,1)},j.f=O=function(e){return e===T||e===i?new n(e):r(e)}),u(u.G+u.W+u.F*!k,{Promise:T}),o("./node_modules/core-js/library/modules/_set-to-string-tag.js")(T,"Promise"),o("./node_modules/core-js/library/modules/_set-species.js")("Promise"),i=o("./node_modules/core-js/library/modules/_core.js").Promise,u(u.S+u.F*!k,"Promise",{reject:function(e){var s=O(this);return(0,s.reject)(e),s.promise}}),u(u.S+u.F*(a||!k),"Promise",{resolve:function(e){return y(a&&this===i?T:this,e)}}),u(u.S+u.F*!(k&&o("./node_modules/core-js/library/modules/_iter-detect.js")((function(e){T.all(e).catch(R)}))),"Promise",{all:function(e){var s=this,o=O(s),t=o.resolve,r=o.reject,n=S((function(){var o=[],n=0,i=1;f(e,!1,(function(e){var a=n++,l=!1;o.push(void 0),i++,s.resolve(e).then((function(e){l||(l=!0,o[a]=e,--i||t(o))}),r)})),--i||t(o)}));return n.e&&r(n.v),o.promise},race:function(e){var s=this,o=O(s),t=o.reject,r=S((function(){f(e,!1,(function(e){s.resolve(e).then(o.resolve,t)}))}));return r.e&&t(r.v),o.promise}})},"./node_modules/core-js/library/modules/es6.string.iterator.js":function(e,s,o){"use strict";var t=o("./node_modules/core-js/library/modules/_string-at.js")(!0);o("./node_modules/core-js/library/modules/_iter-define.js")(String,"String",(function(e){this._t=String(e),this._i=0}),(function(){var e,s=this._t,o=this._i;return o>=s.length?{value:void 0,done:!0}:(e=t(s,o),this._i+=e.length,{value:e,done:!1})}))},"./node_modules/core-js/library/modules/es7.map.from.js":function(e,s,o){o("./node_modules/core-js/library/modules/_set-collection-from.js")("Map")},"./node_modules/core-js/library/modules/es7.map.of.js":function(e,s,o){o("./node_modules/core-js/library/modules/_set-collection-of.js")("Map")},"./node_modules/core-js/library/modules/es7.map.to-json.js":function(e,s,o){var t=o("./node_modules/core-js/library/modules/_export.js");t(t.P+t.R,"Map",{toJSON:o("./node_modules/core-js/library/modules/_collection-to-json.js")("Map")})},"./node_modules/core-js/library/modules/es7.promise.finally.js":function(e,s,o){"use strict";var t=o("./node_modules/core-js/library/modules/_export.js"),r=o("./node_modules/core-js/library/modules/_core.js"),n=o("./node_modules/core-js/library/modules/_global.js"),i=o("./node_modules/core-js/library/modules/_species-constructor.js"),a=o("./node_modules/core-js/library/modules/_promise-resolve.js");t(t.P+t.R,"Promise",{finally:function(e){var s=i(this,r.Promise||n.Promise),o="function"==typeof e;return this.then(o?function(o){return a(s,e()).then((function(){return o}))}:e,o?function(o){return a(s,e()).then((function(){throw o}))}:e)}})},"./node_modules/core-js/library/modules/es7.promise.try.js":function(e,s,o){"use strict";var t=o("./node_modules/core-js/library/modules/_export.js"),r=o("./node_modules/core-js/library/modules/_new-promise-capability.js"),n=o("./node_modules/core-js/library/modules/_perform.js");t(t.S,"Promise",{try:function(e){var s=r.f(this),o=n(e);return(o.e?s.reject:s.resolve)(o.v),s.promise}})},"./node_modules/core-js/library/modules/web.dom.iterable.js":function(e,s,o){o("./node_modules/core-js/library/modules/es6.array.iterator.js");for(var t=o("./node_modules/core-js/library/modules/_global.js"),r=o("./node_modules/core-js/library/modules/_hide.js"),n=o("./node_modules/core-js/library/modules/_iterators.js"),i=o("./node_modules/core-js/library/modules/_wks.js")("toStringTag"),a="CSSRuleList,CSSStyleDeclaration,CSSValueList,ClientRectList,DOMRectList,DOMStringList,DOMTokenList,DataTransferItemList,FileList,HTMLAllCollection,HTMLCollection,HTMLFormElement,HTMLSelectElement,MediaList,MimeTypeArray,NamedNodeMap,NodeList,PaintRequestList,Plugin,PluginArray,SVGLengthList,SVGNumberList,SVGPathSegList,SVGPointList,SVGStringList,SVGTransformList,SourceBufferList,StyleSheetList,TextTrackCueList,TextTrackList,TouchList".split(","),l=0;l<a.length;l++){var c=a[l],d=t[c],u=d&&d.prototype;u&&!u[i]&&r(u,i,c),n[c]=n.Array}}})}));
//# sourceMappingURL=engine-conference.min.js.map